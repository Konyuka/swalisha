import{b as Y,j as e,c as I,aQ as Wi,T as r,O as ne,v as w,aj as $s,am as jn,ap as Yt,aR as Gi,m,s as F,t as B,f as H,d as U,ac as Q,e as W,ad as ae,B as f,r as g,I as _,D as z,a8 as R,a6 as P,a5 as k,w as Rs,C as ye,a4 as Xt,z as D,al as ce,a7 as de,ae as xe,aS as Qi,aT as Ji,aU as Yi,aV as N,aG as M,n as x,aW as Ls,aF as j,ax as lt,aX as ot,aJ as pe,aY as Xi,aZ as Zi,a_ as el,x as Os,a$ as Zt,b0 as sl,b1 as tl,aO as _s,b2 as fs,av as q,aw as me,an as Le,b3 as bs,b4 as Ze,g as T,b5 as vs,aK as we,b6 as fn,b7 as bn,aA as al,b8 as Pa,b9 as qs,ba as nl,u as X,V as Vs,W as ct,bb as ea,Y as O,bc as vn,bd as rl,ai as es,be as il,bf as Bs,_ as ss,y as dt,F as Xe,G as hs,M as xs,bg as sa,k as Z,bh as yn,ah as ta,bi as wn,a0 as Fe,J as Hs,bj as ts,Q as Sn,bk as as,bl as ys,bm as ll,aH as te,bn as kn,bo as ut,bp as Ye,bq as se,br as aa,a9 as Pe,ab as ze,aE as na,bs as mt,bt as ol,ag as cl,bu as dl,bv as ul,bw as ml,bx as Nn,by as As,bz as Cn,bA as _n,bB as gl,bC as hl,bD as xl,bE as pl,bF as jl,aM as fl,bG as bl,bH as vl,ao as ps,bI as An,bJ as Rt,S as ra,bK as ia,bL as yl,bM as la,K as oa,bN as En,bO as wl,bP as Sl,q as kl,aq as ca,o as da,bQ as Nl,bR as Cl,aa as _l,bS as Al,bT as El,bU as Il,bV as Ct,P as In,bW as gt,E as Tl,bX as Fl,bY as Pl,bZ as ms,b_ as Us,ak as Tn,b$ as zl,c0 as Dl,c1 as Ml,c2 as za,a2 as Fn,c3 as Pn,p as zn,c4 as Dn,c5 as Mn,H as $l,c6 as Rl,c7 as Ll,c8 as Ol,a3 as ua,X as ql,$ as ee,a1 as Vl}from"./main-0be1d019.js";import{a as Bl,b as Hl,c as Ul,d as Kl,u as ma,F as ga,s as Wl}from"./search-a322569b.js";import{S as ve}from"./section-helper-64d68e03.js";import{F as G,a as he,c as Oe,b as Qe,N as qe,k as Gl,l as je,m as De,n as Se,o as A,I as Fs,p as ns,q as be,j as Ce,i as rs,D as ws,r as Lt,U as ha,M as Ks,s as Ql,v as $n,T as ht,e as xt,f as Ue,w as K,x as Jl,y as Yl,z as Rn,t as Xl,g as Ln,E as Da,u as On,H as xa,J as Ae,K as Zl,L as eo,O as Ma,P as so,Q as to,B as ao,R as qn,S as Vn,G as no,V as ro,W as io,X as lo,h as oo}from"./search-report-table-f0bbbc10.js";import{d as Ws,b as co,C as uo,a as ue,c as He,e as Me,f as ks,h as mo,u as go,L as Bn,j as Hn,k as Un,l as Kn,m as ho,n as xo,o as gs,p as po,I as jo,q as fo,r as bo,s as vo,t as yo,v as wo,T as So,D as ko,w as No}from"./reply-editor-b3f60ce1.js";import{E as _e}from"./Edit-75236d4e.js";import{B as Wn,a as Es}from"./breadcrumb-9f769b36.js";import{u as Gn,a as Co,O as _o}from"./OpenInNew-6a51e2d3.js";import{B as Ao,u as Eo}from"./bullet-seprated-items-25a8819d.js";function Io({className:s,isCompactMode:t}){const{version:a}=Y();return e.jsxs("div",{className:I(s,"relative flex flex-col gap-20 overflow-y-auto border-r bg-alt px-12 pb-16 pt-26 text-sm font-medium text-muted"),children:[e.jsx(Wi,{matchDescendants:n=>n==="/admin",menu:"admin-sidebar",orientation:"vertical",onlyShowIcons:t,itemClassName:({isActive:n})=>I("block w-full rounded-button py-12 px-16",n?"bg-primary/6 text-primary font-semibold":"hover:bg-hover"),gap:"gap-8"}),!t&&e.jsx("div",{className:"mt-auto gap-14 px-16 text-xs",children:e.jsx(r,{message:"Version: :number",values:{number:a}})})]})}function To(){return ne({queryKey:["admin-setup-alerts"],queryFn:()=>Fo()})}function Fo(){return w.get("admin/setup-alerts").then(s=>s.data)}function Po(){return e.jsxs(Bl,{name:"admin",leftSidenavCanBeCompact:!0,children:[e.jsx(Hl,{size:"sm",menuPosition:"admin-navbar"}),e.jsx(Ul,{position:"left",size:"sm",children:e.jsx(Io,{})}),e.jsx(Kl,{children:e.jsxs("div",{className:"bg dark:bg-alt",children:[e.jsx(zo,{}),e.jsx($s,{})]})})]})}function zo(){const{data:s}=To(),[t]=jn("admin-setup-alert-dismissed",null),a=!t||Date.now()-t.timestamp>864e5;return!(s!=null&&s.alerts.length)||!a?null:e.jsx("div",{className:"fixed left-0 right-0 top-24 z-10 mx-auto w-max overflow-hidden rounded-panel bg shadow-md",children:e.jsx(Do,{alert:s.alerts[0]})})}function Do({alert:s}){const t=e.jsx("div",{dangerouslySetInnerHTML:{__html:s.description}});return e.jsx(ve,{leadingIcon:e.jsx(Yt,{size:"xs",className:"text-danger"}),onClose:()=>{Gi("admin-setup-alert-dismissed",{timestamp:Date.now()})},title:s.title,description:t,color:"neutral"},s.title)}const Mo=[{key:"email_verified_at",label:m("Email"),description:m("Email verification status"),defaultOperator:G.ne,control:{type:he.Select,defaultValue:"01",options:[{key:"01",label:m("is confirmed"),value:{value:null,operator:G.ne}},{key:"02",label:m("is not confirmed"),value:{value:null,operator:G.eq}}]}},Oe({description:m("Date user registered or was created")}),Qe({description:m("Date user was last updated")}),{key:"subscriptions",label:m("Subscription"),description:m("Whether user is subscribed or not"),defaultOperator:G.eq,control:{type:he.Select,defaultValue:"01",options:[{key:"01",label:m("is subscribed"),value:{value:"*",operator:G.has}},{key:"02",label:m("is not subscribed"),value:{value:"*",operator:G.doesntHave}}]}}],Ps=""+new URL("team-de984127.svg",import.meta.url).href;function $o(s){return F({mutationFn:t=>Ro(s,t),onError:t=>B(t)})}function Ro(s,t){return w.post(s,t).then(a=>a.data)}function Lo(){const{close:s}=H();return e.jsxs(U,{children:[e.jsx(Q,{children:e.jsx(r,{message:"Csv export"})}),e.jsx(W,{children:e.jsx(r,{message:`Your request is being processed. We'll email you when the report is ready to download. In
            certain cases, it might take a little longer, depending on the number of items beings
            exported and the volume of activity.`})}),e.jsx(ae,{children:e.jsx(f,{variant:"flat",color:"primary",onClick:s,children:e.jsx(r,{message:"Got it"})})})]})}function Qn({endpoint:s,payload:t}){const[a,n]=g.useState(!1),i=$o(s);return e.jsxs(g.Fragment,{children:[e.jsx(_,{variant:"outline",color:"primary",size:"sm",className:"flex-shrink-0",disabled:i.isPending,onClick:()=>{i.mutate(t,{onSuccess:l=>{l.downloadPath?Ws(l.downloadPath):n(!0)}})},children:e.jsx(co,{})}),e.jsx(z,{type:"modal",isOpen:a,onOpenChange:n,children:e.jsx(Lo,{})})]})}const Jn=R(e.jsx("path",{d:"m20 17.17-3.37-3.38c.64.22 1.23.48 1.77.76.97.51 1.58 1.52 1.6 2.62zm1.19 4.02-1.41 1.41-2.61-2.6H4v-2.78c0-1.12.61-2.15 1.61-2.66 1.29-.66 2.87-1.22 4.67-1.45L1.39 4.22 2.8 2.81l18.39 18.38zM15.17 18l-3-3H12c-2.37 0-4.29.73-5.48 1.34-.32.16-.52.5-.52.88V18h9.17zM12 6c1.1 0 2 .9 2 2 0 .86-.54 1.59-1.3 1.87l1.48 1.48C15.28 10.64 16 9.4 16 8c0-2.21-1.79-4-4-4-1.4 0-2.64.72-3.35 1.82l1.48 1.48C10.41 6.54 11.14 6 12 6z"}),"PersonOffOutlined");function Oo(s){return F({mutationFn:()=>qo(s),onSuccess:()=>{P(m("User unsuspended")),k.invalidateQueries({queryKey:["users"]})},onError:t=>B(t)})}function qo(s){return w.delete(`users/${s}/unban`).then(t=>t.data)}function Vo(){return F({mutationFn:s=>Bo(s),onSuccess:async s=>{P(m(`Impersonating User "${s.user.display_name}"`)),window.location.href="/"},onError:s=>B(s)})}function Bo(s){return w.post(`admin/users/impersonate/${s.userId}`,s).then(t=>t.data)}const $a=[{key:"name",allowsSorting:!0,sortingKey:"email",width:"flex-3 min-w-200",visibleInMode:"all",header:()=>e.jsx(r,{message:"User"}),body:s=>e.jsx(qe,{image:s.avatar,label:s.display_name,description:s.email})},{key:"subscribed",header:()=>e.jsx(r,{message:"Subscribed"}),width:"w-96",body:s=>{var t;return(t=s.subscriptions)!=null&&t.length?e.jsx(Rs,{className:"text-positive icon-md"}):e.jsx(ye,{className:"text-danger icon-md"})}},{key:"roles",header:()=>e.jsx(r,{message:"Roles"}),body:s=>{var t;return e.jsx(uo,{radius:"rounded",size:"xs",children:(t=s==null?void 0:s.roles)==null?void 0:t.map(a=>e.jsx(Xt,{selectable:!0,children:e.jsx(D,{className:I("capitalize"),target:"_blank",to:`/admin/roles/${a.id}/edit`,children:e.jsx(r,{message:a.name})})},a.id))})}},{key:"firstName",allowsSorting:!0,header:()=>e.jsx(r,{message:"First name"}),body:s=>s.first_name},{key:"lastName",allowsSorting:!0,header:()=>e.jsx(r,{message:"Last name"}),body:s=>s.last_name},{key:"createdAt",allowsSorting:!0,width:"w-96",header:()=>e.jsx(r,{message:"Created at"}),body:s=>e.jsx("time",{children:e.jsx(ce,{date:s.created_at})})},{key:"actions",header:()=>e.jsx(r,{message:"Actions"}),width:"w-128 flex-shrink-0",hideHeader:!0,align:"end",visibleInMode:"all",body:s=>e.jsxs("div",{className:"text-muted",children:[e.jsx(D,{to:`${s.id}/edit`,children:e.jsx(de,{label:e.jsx(r,{message:"Edit user"}),children:e.jsx(_,{size:"md",children:e.jsx(_e,{})})})}),s.banned_at?e.jsx(Ho,{user:s}):e.jsxs(z,{type:"modal",children:[e.jsx(de,{label:e.jsx(r,{message:"Suspend user"}),children:e.jsx(_,{size:"md",children:e.jsx(Jn,{})})}),e.jsx(Gl,{user:s})]}),e.jsx(Uo,{user:s})]})}];function Ho({user:s}){const t=Oo(s.id);return e.jsxs(z,{type:"modal",onClose:a=>{a&&t.mutate()},children:[e.jsx(de,{label:e.jsx(r,{message:"Remove suspension"}),children:e.jsx(_,{size:"md",color:"danger",children:e.jsx(Jn,{})})}),e.jsx(xe,{isDanger:!0,title:e.jsx(r,{message:"Suspend “:name“",values:{name:s.display_name}}),body:e.jsx(r,{message:"Are you sure you want to remove suspension from this user?"}),confirm:e.jsx(r,{message:"Unsuspend"})})]})}function Uo({user:s}){const t=Vo();return e.jsxs(z,{type:"modal",children:[e.jsx(de,{label:e.jsx(r,{message:"Login as user"}),children:e.jsx(_,{size:"md",children:e.jsx(Qi,{})})}),e.jsx(xe,{title:e.jsx(r,{message:"Login as “:name“",values:{name:s.display_name}}),isLoading:t.isPending,body:e.jsx(r,{message:"Are you sure you want to login as this user?"}),confirm:e.jsx(r,{message:"Login"}),onConfirm:()=>{t.mutate({userId:s.id})}})]})}function Ko(){const{billing:s}=Y(),t=s.enable?$a:$a.filter(a=>a.key!=="subscribed");return e.jsx(g.Fragment,{children:e.jsx(je,{endpoint:"users",title:e.jsx(r,{message:"Users"}),filters:Mo,columns:t,actions:e.jsx(Wo,{}),queryParams:{with:"subscriptions,bans"},selectedActions:e.jsx(De,{}),emptyStateMessage:e.jsx(ue,{image:Ps,title:e.jsx(r,{message:"No users have been created yet"}),filteringTitle:e.jsx(r,{message:"No matching users"})})})})}function Wo(){return e.jsxs(g.Fragment,{children:[e.jsx(Qn,{endpoint:"users/csv/export"}),e.jsx(Se,{elementType:D,to:"new",children:e.jsx(r,{message:"Add new user"})})]})}const Go=s=>(t,a,n)=>{const i=n.subscribe;return n.subscribe=(o,c,d)=>{let u=o;if(c){const h=(d==null?void 0:d.equalityFn)||Object.is;let p=o(n.getState());u=b=>{const v=o(b);if(!h(p,v)){const S=p;c(p=v,S)}},d!=null&&d.fireImmediately&&c(p,p)}return i(u)},s(t,a,n)},Qo=Go;function Yn(s,t){return s.reduce((a,n,i)=>{const l=Math.floor(i/t);return a[l]||(a[l]=[]),a[l].push(n),a},[])}const Jo={preview:{defaultRoute:"/",navigationRoutes:[]},sections:{general:{label:m("General"),position:1,buildBreadcrumb:()=>[{label:m("General"),location:"general"}]},themes:{label:m("Themes"),position:2,buildBreadcrumb:(s,t)=>{var l;const a=s.split("/").filter(o=>!!o),[,,,n]=a,i=[{label:m("Themes"),location:"themes"}];return n!=null&&i.push({label:(l=t.appearance.themes.all[+n])==null?void 0:l.name,location:`themes/${n}`}),a.at(-1)==="font"&&i.push({label:m("Font"),location:`themes/${n}/font`}),a.at(-1)==="radius"&&i.push({label:m("Rounding"),location:`themes/${n}/radius`}),i}},menus:{label:m("Menus"),position:3,buildBreadcrumb:(s,t)=>{const a=s.split("/").filter(o=>!!o),[,,...n]=a,i=[{label:m("Menus"),location:"menus"}],l=Yn(n,2);return l.forEach(([o,c],d)=>{var u,h;if(o==="menus"&&c!=null)i.push({label:(u=t.settings.menus[+c])==null?void 0:u.name,location:`menus/${c}`});else if(o==="items"&&c!=null){const[,p]=l[d-1];i.push({label:(h=t.settings.menus[+p].items[+c])==null?void 0:h.label,location:`menus/${p}/${c}`})}}),i},config:{availableRoutes:["/","/login","/register","/contact","/pricing","/account-settings","/admin","/admin/appearance","/admin/settings","/admin/plans","/admin/subscriptions","/admin/users","/admin/roles","/admin/pages","/admin/tags","/admin/files","/admin/localizations","/admin/ads","/admin/settings/authentication","/admin/settings/branding","/admin/settings/cache","/admin/settings/providers","/api-docs"],positions:["admin-navbar","admin-sidebar","custom-page-navbar","auth-page-footer","auth-dropdown","account-settings-page","billing-page","checkout-page-navbar","checkout-page-footer","pricing-table-page","contact-us-page","notifications-page","footer","footer-secondary"]}},"custom-code":{label:m("Custom Code"),position:4,buildBreadcrumb:()=>[{label:m("Custom code"),location:"custom-code"}]},"seo-settings":{label:m("SEO Settings"),position:5,buildBreadcrumb:()=>[{label:m("SEO"),location:"seo"}]}}},Yo={cover:{label:m("Stretch to fit"),bgConfig:{backgroundRepeat:"no-repeat",backgroundSize:"cover"}},contain:{label:m("Fit"),bgConfig:{backgroundRepeat:"no-repeat",backgroundSize:"contain",backgroundPosition:"center top"}},repeat:{label:m("Repeat"),bgConfig:{backgroundRepeat:"repeat",backgroundSize:void 0,backgroundPosition:"left top"}}};function Xo({value:s,onChange:t,className:a,disabled:n}){const i=Zo(s);return e.jsx("div",{className:a,children:e.jsx(Ji,{size:"sm",disabled:n,children:Object.entries(Yo).map(([l,o])=>e.jsx(Yi,{name:"background-position",value:l,checked:l===i,onChange:c=>{s&&(t==null||t({...s,...o.bgConfig}))},children:e.jsx(r,{...o.label})},l))})})}function Zo(s){return(s==null?void 0:s.backgroundSize)==="cover"?"cover":(s==null?void 0:s.backgroundSize)==="contain"?"contain":"repeat"}function ec(){const{watch:s,setValue:t,getValues:a}=N();return e.jsxs(g.Fragment,{children:[e.jsxs(M,{selectionMode:"single",label:e.jsx(r,{message:"Header style"}),className:"mb-24",name:"settings.landing.header.variant",children:[e.jsx(x,{value:"simple",children:e.jsx(r,{message:"Simple"})}),e.jsx(x,{value:"colorful",children:e.jsx(r,{message:"Colorful"})})]}),e.jsx(Ls,{name:"settings.landing.header.background",className:"mb-12",label:e.jsx(r,{message:"Header image"}),defaultValue:"",diskPrefix:"homepage"}),e.jsx(Xo,{value:s("settings.landing.header"),disabled:!s("settings.landing.header.background"),onChange:n=>{t("settings.landing.header",{...a("settings.landing.header"),...n})},className:"mb-20 border-b pb-12"}),e.jsxs(M,{selectionMode:"single",label:e.jsx(r,{message:"Content style"}),className:"mb-12",name:"settings.landing.content.variant",children:[e.jsx(x,{value:"articleGrid",children:e.jsx(r,{message:"Article grid"})}),e.jsx(x,{value:"multiProduct",children:e.jsx(r,{message:"Multiproduct"})})]}),s("settings.landing.content.variant")==="articleGrid"&&e.jsx(sc,{}),e.jsx(j,{label:e.jsx(r,{message:"Header title"}),className:"mb-24",name:"settings.landing.header.title",inputElementType:"textarea",rows:2,onFocus:()=>{J().preview.setHighlight('[data-testid="headerTitle"]')}}),e.jsx(j,{label:e.jsx(r,{message:"Header subtitle"}),className:"mb-24",inputElementType:"textarea",rows:2,name:"settings.landing.header.subtitle",onFocus:()=>{J().preview.setHighlight('[data-testid="headerSubtitle"]')}}),e.jsx(j,{label:e.jsx(r,{message:"Search field placeholder"}),className:"mb-24",name:"settings.landing.header.placeholder",inputElementType:"textarea",rows:2,onFocus:()=>{J().preview.setHighlight('[data-testid="headerSubtitle"]')}}),e.jsx(A,{className:"mb-24",name:"settings.landing.show_footer",children:e.jsx(r,{message:"Show footer"})})]})}function sc(){return e.jsxs("div",{className:"mb-18 border-b pb-18",children:[e.jsx(j,{name:"settings.landing.articles_per_category",label:e.jsx(r,{message:"Articles per category"}),labelSuffixPosition:"inline",labelSuffix:e.jsx(Fs,{body:e.jsx(r,{message:"How many articles should each category display in help center homepage."})}),type:"number",className:"mb-12",min:"1",max:"50"}),e.jsx(j,{name:"settings.landing.children_per_category",label:e.jsx(r,{message:"Child categories"}),labelSuffix:e.jsx(Fs,{body:e.jsx(r,{message:"How many child categories should each parent category display in help center homepage."})}),labelSuffixPosition:"inline",className:"mb-18",type:"number",min:"1",max:"50"}),e.jsx(A,{name:"settings.landing.hide_small_categories",children:e.jsx(r,{message:"Hide empty categories"})})]})}const Ee=g.forwardRef(({startIcon:s,children:t,className:a,description:n,...i},l)=>e.jsxs(lt,{ref:l,display:"flex",className:I("relative mb-10 h-54 w-full items-center gap-10 rounded-input border bg px-14 text-sm hover:bg-hover",a),variant:null,...i,children:[s,e.jsxs("span",{className:"block min-w-0",children:[e.jsx("span",{className:"block",children:t}),n&&e.jsx("span",{className:"block overflow-hidden overflow-ellipsis whitespace-nowrap text-xs text-muted",children:n})]}),e.jsx(ot,{"aria-hidden":!0,className:"ml-auto text-muted icon-sm"})]}));function tc(){return e.jsxs(g.Fragment,{children:[e.jsx(j,{label:e.jsx(r,{message:"Title"}),className:"mb-20",name:"settings.hc.newTicket.appearance.title",inputElementType:"textarea",rows:2}),e.jsx(j,{label:e.jsx(r,{message:"Category label"}),className:"mb-20",name:"settings.hc.newTicket.appearance.categoryLabel",inputElementType:"textarea",rows:2}),e.jsx(j,{label:e.jsx(r,{message:"Subject label"}),className:"mb-20",name:"settings.hc.newTicket.appearance.subjectLabel",inputElementType:"textarea",rows:2}),e.jsx(j,{label:e.jsx(r,{message:"Description label"}),className:"mb-20",name:"settings.hc.newTicket.appearance.descriptionLabel",inputElementType:"textarea",rows:2}),e.jsx(j,{label:e.jsx(r,{message:"Submit button text"}),className:"mb-20",name:"settings.hc.newTicket.appearance.submitButtonText",inputElementType:"textarea",rows:2}),e.jsxs("div",{className:"mt-24 border-t pt-24",children:[e.jsx(j,{label:e.jsx(r,{message:"Sidebar title"}),className:"mb-20",name:"settings.hc.newTicket.appearance.sidebarTitle",inputElementType:"textarea",rows:2}),e.jsx(Ee,{to:"sidebar",elementType:D,children:e.jsx(r,{message:"Sidebar tips"})})]})]})}function ac(){const{fields:s,remove:t,append:a}=pe({name:"settings.hc.newTicket.appearance.sidebarTips"}),[n,i]=g.useState([0]);return e.jsxs("div",{children:[e.jsx(ns,{variant:"outline",expandedValues:n,onExpandedChange:l=>{i(l)},children:s.map((l,o)=>e.jsxs(be,{value:o,label:e.jsx(r,{message:`Sidebar tip ${o+1}`}),children:[e.jsx(nc,{index:o}),e.jsx("div",{className:"text-right",children:e.jsx(f,{size:"xs",variant:"outline",color:"danger",onClick:()=>{t(o)},children:e.jsx(r,{message:"Remove"})})})]},l.id))}),e.jsx("div",{className:"mt-20 text-right",children:e.jsx(f,{size:"xs",variant:"outline",color:"primary",startIcon:e.jsx(Ce,{}),onClick:()=>{a({}),i([s.length])},children:e.jsx(r,{message:"Add another"})})})]})}function nc({index:s}){return e.jsxs(g.Fragment,{children:[e.jsx(j,{name:`settings.hc.newTicket.appearance.sidebarTips.${s}.title`,label:e.jsx(r,{message:"Title"}),className:"mb-20",inputElementType:"textarea",rows:2}),e.jsx(j,{name:`settings.hc.newTicket.appearance.sidebarTips.${s}.content`,label:e.jsx(r,{message:"Content"}),className:"mb-20",inputElementType:"textarea",rows:4})]})}const Xn={preview:{defaultRoute:"/",navigationRoutes:["/"]},sections:{"landing-page":{label:m("Landing page"),position:0,previewRoute:"/",routes:[{path:"landing-page",element:e.jsx(ec,{})}],buildBreadcrumb:()=>[{label:m("Landing page"),location:"landing-page"}]},"new-ticket":{label:m("New ticket page"),position:1,previewRoute:"/hc/tickets/new",routes:[{path:"new-ticket",element:e.jsx(tc,{})},{path:"new-ticket/sidebar",element:e.jsx(ac,{})}],buildBreadcrumb:s=>{const t=[{label:m("New ticket page"),location:"new-ticket"}];return s.endsWith("sidebar")&&t.push({label:m("Sidebar"),location:"landing-page/sidebar"}),t}},menus:{config:{positions:["header","agent-mailbox","landing-page-navbar","landing-page-footer"],availableRoutes:["/hc","/hc/tickets","/hc/tickets/new","/agent/tickets","/admin/hc/arrange","/admin/hc/articles","/admin/triggers"]}},"seo-settings":{config:{pages:[{key:"landing-page",label:m("Landing page")},{key:"article-page",label:m("Article page")},{key:"category-page",label:m("Category page")},{key:"search-page",label:m("Search page")}]}}}},pa=Xi.all([Jo,Xn]),pt=Zi()(Qo(el((s,t)=>({defaults:null,iframeWindow:null,config:pa,setDefaults:a=>{s(n=>{n.defaults={...a}})},setIframeWindow:a=>{s(()=>({iframeWindow:a}))},preview:{navigate:a=>{var o;const n=(o=t().config)==null?void 0:o.sections[a],i=(n==null?void 0:n.previewRoute)||"/",l=t().iframeWindow;i&&ds(l,{type:"navigate",to:i})},setValues:a=>{const n=t().iframeWindow;ds(n,{type:"setValues",values:a})},setThemeFont:a=>{const n=t().iframeWindow;ds(n,{type:"setThemeFont",value:a})},setThemeValue:(a,n)=>{const i=t().iframeWindow;ds(i,{type:"setThemeValue",name:a,value:n})},setActiveTheme:a=>{const n=t().iframeWindow;ds(n,{type:"setActiveTheme",themeId:a})},setCustomCode:(a,n)=>{const i=t().iframeWindow;ds(i,{type:"setCustomCode",mode:a,value:n})},setHighlight:a=>{s(()=>{var l;let n=null;const i=(l=t().iframeWindow)==null?void 0:l.document;i&&a&&(n=i.querySelector(a)),n&&requestAnimationFrame(()=>{n&&n.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})})})}}}))));function ds(s,t){s&&s.postMessage({source:"be-appearance-editor",...t},"*")}function J(){return pt.getState()}function rc(){return F({mutationFn:s=>ic(s),onSuccess:async()=>{await k.invalidateQueries({queryKey:["admin/appearance/values"]}),P(m("Changes saved"))},onError:s=>B(s)})}function ic(s){return w.post("admin/appearance",{changes:s}).then(t=>t.data)}function lc(){return ne({queryKey:["admin/appearance/values"],queryFn:()=>oc(),staleTime:1/0})}function oc(){return w.get("admin/appearance/values").then(s=>s.data)}function cc(){const{pathname:s}=Os(),{getValues:t}=N(),[a,n]=g.useState(null);return g.useEffect(()=>{var l;const[,,i]=s.split("/").filter(o=>!!o);if(i){const o=(l=J().config)==null?void 0:l.sections[i];if(o){n([{label:m("Appearance"),location:""},...o.buildBreadcrumb(s,t())]);return}}n(null)},[s,t]),!a||a.length<2?null:e.jsxs("div",{className:"flex items-center border-b h-60 flex-shrink-0",children:[e.jsx(_,{iconSize:"md",radius:"rounded-none",className:"text-muted h-full w-50 flex-shrink-0",elementType:D,to:`/admin/appearance/${a[a.length-2].location}`,children:e.jsx(Zt,{})}),e.jsxs("div",{className:"border-l p-10 min-w-0",children:[e.jsx("div",{className:"text-xs text-muted",children:e.jsx(r,{message:"Customizing"})}),e.jsx("div",{className:"flex items-center gap-4 text-sm mt-2",children:a.map((i,l)=>{const o=a.length-1===l,c=l===0,d=e.jsx(sl,{value:i.label});return c?null:e.jsxs(g.Fragment,{children:[e.jsx("div",{className:I("whitespace-nowrap overflow-hidden overflow-ellipsis min-w-0",o&&"text-primary",o?"flex-shrink-0":"flex-auto"),children:d}),!o&&e.jsx(ot,{className:"icon-sm text-muted flex-shrink-0"})]},l)})})]})]})}function dc(){const{isAppearanceEditorActive:s}=tl(),{data:t}=lc(),{base_url:a}=Y(),n=g.useRef(null),{pathname:i}=Os();return g.useEffect(()=>{t!=null&&t.defaults&&!J().defaults&&J().setDefaults(t.defaults)},[t]),g.useEffect(()=>{n.current&&J().setIframeWindow(n.current.contentWindow)},[]),g.useEffect(()=>{const l=i.split("/")[3];J().preview.navigate(l)},[i]),s?e.jsx(_s,{to:"/admin"}):e.jsxs("div",{className:"h-screen items-center md:flex",children:[e.jsx(fs,{children:e.jsx(r,{message:"Appearance"})}),e.jsx(uc,{values:t==null?void 0:t.values}),e.jsx("div",{className:"relative h-full flex-auto",children:e.jsx("iframe",{ref:n,className:"h-full w-full max-md:hidden",src:`${a}?appearanceEditor=true`})})]})}function uc({values:s}){const t=e.jsx("div",{className:"flex h-full flex-auto items-center justify-center",children:e.jsx(bs,{isIndeterminate:!0,"aria-label":"Loading editor"})});return e.jsx("div",{className:"relative z-10 h-full w-full border-r bg shadow-lg @container md:w-320",children:s?e.jsx(mc,{defaultValues:s}):t})}function mc({defaultValues:s}){const t=q({defaultValues:s}),{watch:a,reset:n}=t,i=rc();return g.useEffect(()=>{const l=a(o=>{J().preview.setValues(o)});return()=>l.unsubscribe()},[a]),e.jsxs(me,{className:"flex h-full flex-col",form:t,onSubmit:l=>{i.mutate(l,{onSuccess:()=>n(l)})},children:[e.jsx(gc,{isLoading:i.isPending}),e.jsx(cc,{}),e.jsx("div",{className:"flex-auto overflow-y-auto px-14 py-20",children:e.jsx(Le,{children:e.jsx($s,{})})})]})}function gc({isLoading:s}){const{formState:{dirtyFields:t}}=N(),a=Object.keys(t).length;return e.jsxs("div",{className:"flex h-50 flex-shrink-0 items-center border-b pr-10",children:[e.jsx(_,{border:"border-r",className:"text-muted",elementType:D,to:"..",children:e.jsx(ye,{})}),e.jsx("div",{className:"pl-10",children:e.jsx(r,{message:"Appearance editor"})}),e.jsx(f,{variant:"flat",color:"primary",className:"ml-auto block",disabled:!a||s,type:"submit",children:a?e.jsx(r,{message:"Save"}):e.jsx(r,{message:"Saved"})})]})}function hc(){const s=Ze(),{trans:t}=T(),{fields:a,append:n}=pe({name:"settings.menus",keyName:"key"});return e.jsxs(g.Fragment,{children:[e.jsx("div",{children:a.map((i,l)=>e.jsx(Ee,{to:`${l}`,elementType:D,children:i.name},i.key))}),e.jsx("div",{className:"text-right",children:e.jsx(f,{variant:"outline",color:"primary",startIcon:e.jsx(Ce,{}),size:"xs",onClick:()=>{const i=vs(10);n({name:t(m("New menu :number",{values:{number:a.length+1}})),id:i,positions:[],items:[]}),s(`${a.length}`)},children:e.jsx(r,{message:"Create menu"})})})]})}function Zn(){const s=pa.sections.menus.config;return s?s.availableRoutes.map(t=>({id:t,label:t,action:t,type:"route",target:"_self"})):[]}function er(s){return s&&s.charAt(0).toUpperCase()+s.slice(1)}function sr({title:s=e.jsx(r,{message:"Add menu item"})}){const{data:t}=we(["menuItemCategories"]),a=(t==null?void 0:t.menuItemCategories)||[],n=Zn();return e.jsxs(U,{size:"sm",children:[e.jsx(Q,{children:s}),e.jsx(W,{children:e.jsxs(ns,{variant:"outline",children:[e.jsx(be,{label:e.jsx(r,{message:"Link"}),bodyClassName:"max-h-240 overflow-y-auto",children:e.jsx(xc,{})}),e.jsx(be,{label:e.jsx(r,{message:"Route"}),bodyClassName:"max-h-240 overflow-y-auto",children:e.jsx(Ra,{items:n})}),a.map(i=>e.jsx(be,{label:e.jsx(r,{message:i.name}),children:e.jsx(Ra,{items:i.items})},i.name))]})})]})}function xc(){const s=q({defaultValues:{id:vs(6),type:"link",target:"_blank"}}),{close:t}=H();return e.jsxs(me,{form:s,onSubmit:a=>{t(a)},children:[e.jsx(j,{required:!0,name:"label",label:e.jsx(r,{message:"Label"}),className:"mb-20"}),e.jsx(j,{required:!0,type:"url",name:"action",placeholder:"https://",label:e.jsx(r,{message:"Url"}),className:"mb-20"}),e.jsx("div",{className:"text-right",children:e.jsx(f,{type:"submit",variant:"flat",color:"primary",size:"xs",children:e.jsx(r,{message:"Add to menu"})})})]})}function Ra({items:s}){const{close:t}=H();return e.jsx(fn,{children:s.map(a=>e.jsx(bn,{startIcon:e.jsx(Ce,{size:"sm"}),onSelected:()=>{if(a.label){const n=a.label.split("/").pop();a.label=n?er(n):a.label,a.id=vs(6)}t(a)},children:a.label},a.id))})}const tr=R(e.jsx("path",{d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2zm-2-8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0-6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm6 4c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"DragIndicatorOutlined"),pc=""+new URL("dropdown-menu-c9b3bd6a.svg",import.meta.url).href;function _t({e:s,rect:t,deltaX:a,deltaY:n}){return{rect:t,x:s.clientX,y:s.clientY,deltaX:a??0,deltaY:n??0,nativeEvent:s}}let ar=null;function La(s){ar=s}function jc(s){return{left:s.left,top:s.top,width:s.width,height:s.height}}function nr(s){const t=new IntersectionObserver(a=>{a.forEach(n=>{const{width:i,height:l,left:o,top:c}=n.boundingClientRect,[d,u]=[...s].find(([,p])=>p.ref.current===n.target)||[];if(d==null||u==null)return;const h={width:i,height:l,left:o,top:c};s.set(d,{...u,rect:h})}),t.disconnect()});[...s.values()].forEach(a=>{a.ref.current&&t.observe(a.ref.current)})}function fc({id:s,disabled:t,ref:a,preview:n,hidePreview:i,...l}){const o=g.useRef(null),{addGlobalListener:c,removeAllGlobalListeners:d}=al(),u=g.useRef({lastPosition:{x:0,y:0}}).current,h=g.useRef(l);h.current=l,g.useLayoutEffect(()=>(t?He.delete(s):He.set(s,{...He.get(s),id:s,ref:a,type:h.current.type,getData:h.current.getData}),()=>{He.delete(s)}),[s,t,h,a]);const p=y=>{mo.forEach(E=>{var $;E.type===(($=He.get(s))==null?void 0:$.type)&&y(E)})},b=y=>{var re,ke;const E=He.get(s),$=a.current,oe=!o.current||!u.clickedEl||o.current.contains(u.clickedEl);if(ar||!$||!E||!oe){y.preventDefault(),y.stopPropagation();return}nr(Me),La("drag"),i&&bc(y),y.dataTransfer.effectAllowed="move",u.lastPosition={x:y.clientX,y:y.clientY},u.currentRect=jc($.getBoundingClientRect());const fe=_t({rect:u.currentRect,e:y});n!=null&&n.current&&n.current(E,Be=>{y.dataTransfer.setDragImage(Be,0,0)}),ks.status="dragging",ks.dragTargetId=s,a.current&&(a.current.dataset.dragging="true"),(ke=(re=h.current).onDragStart)==null||ke.call(re,fe,E),requestAnimationFrame(()=>{p(Be=>{var cs;return(cs=Be.onDragStart)==null?void 0:cs.call(Be,fe,E)})}),c(window,"dragover",v,!0)},v=y=>{var ke,Be;if(y.preventDefault(),!u.currentRect)return;const E=y.clientX-u.lastPosition.x,$=y.clientY-u.lastPosition.y,oe={...u.currentRect,left:u.currentRect.left+E,top:u.currentRect.top+$},fe=_t({rect:oe,e:y,deltaX:E,deltaY:$}),re=He.get(s);re&&((Be=(ke=h.current).onDragMove)==null||Be.call(ke,fe,re),p(cs=>{var Fa;return(Fa=cs.onDragMove)==null?void 0:Fa.call(cs,fe,re)})),u.lastPosition={x:y.clientX,y:y.clientY},u.currentRect=oe};return{draggableProps:{draggable:!t,onDragStart:b,onDragEnd:y=>{var oe,fe;if(d(),!u.currentRect)return;La(null),Je&&Je.remove();const E=_t({rect:u.currentRect,e:y}),$=He.get(s);$&&((fe=(oe=h.current).onDragEnd)==null||fe.call(oe,E,$),p(re=>{var ke;return(ke=re.onDragEnd)==null?void 0:ke.call(re,E,$,ks.status)})),requestAnimationFrame(()=>{ks.dragTargetId=void 0,ks.status="inactive",a.current&&delete a.current.dataset.dragging})},onPointerDown:y=>{u.clickedEl=y.target}},dragHandleRef:o}}let Je;function bc(s){Je||(Je=new Image,document.body.append(Je),Je.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),s.dataTransfer.setDragImage(Je,0,0)}const vc={onDragStart:()=>{},onDragEnter:()=>{},onDragOver:({e:s,ref:t,item:a,sortSession:n,onDropPositionChange:i})=>{var d;const l=n.dropPosition;let o=null;const c=(d=Me.get(a))==null?void 0:d.rect;if(c){const u=c.top+c.height/2;s.clientY<=u?o="before":s.clientY>=u&&(o="after")}if(o!==l){const u=n.sortables.indexOf(a);if(n.dropPosition=o,i==null||i(n.dropPosition),Oa(n),t.current)if(n.dropPosition==="after")At(t.current,"bottom",n);else if(u===0)At(t.current,"top",n);else{const b=n.sortables[u-1],v=Me.get(b);v!=null&&v.ref.current&&At(v.ref.current,"bottom",n)}const h=n.sortables.indexOf(a);if(n.activeIndex===h){n.finalIndex=n.activeIndex;return}(u>n.activeIndex?"after":"before")==="after"?n.finalIndex=n.dropPosition==="before"?h-1:h:n.finalIndex=n.dropPosition==="after"?h+1:h}},onDragEnd:s=>{Oa(s)}};function Oa(s){s!=null&&s.linePreviewEl&&(s.linePreviewEl.style.borderBottomColor="",s.linePreviewEl.style.borderTopColor="",s.linePreviewEl=void 0)}function At(s,t,a){const n="rgb(var(--be-primary))";t==="top"?s.style.borderTopColor=n:s.style.borderBottomColor=n,a&&(a.linePreviewEl=s)}function rr(s,t,a){const n=Pa(t,0,s.length-1),i=Pa(a,0,s.length-1);if(n===i)return s;const l=s[n],o=i<n?-1:1;for(let c=n;c!==i;c+=o)s[c]=s[c+o];return s[i]=l,s}function ja(s,t,a){const n=s.slice();return n.splice(a<0?n.length+a:a,0,n.splice(t,1)[0]),n}const yc="transform 0.2s cubic-bezier(0.2, 0, 0, 1)",wc={onDragStart:s=>{s.sortables.forEach((t,a)=>{const n=Me.get(t);n!=null&&n.ref.current&&(n.ref.current.style.transition=yc,(s==null?void 0:s.activeIndex)===a&&(n.ref.current.style.opacity="0.4"))})},onDragEnter:(s,t,a)=>{rr(s.sortables,a,t);const n=s.sortables.map(i=>{var l;return(l=Me.get(i))==null?void 0:l.rect});s.sortables.forEach((i,l)=>{if(!s)return;const o=ja(n,t,s.activeIndex),c=n[l],d=o[l],u=Me.get(i);if(u!=null&&u.ref.current&&d&&c){const h=d.left-c.left,p=d.top-c.top;u.ref.current.style.transform=`translate3d(${h}px, ${p}px, 0)`}}),s.finalIndex=t},onDragOver:()=>{},onDragEnd:s=>{s.sortables.forEach(t=>{const a=Me.get(t);a!=null&&a.ref.current&&(a.ref.current.style.transform="",a.ref.current.style.transition="",a.ref.current.style.opacity="",a.ref.current.style.zIndex="")})}},Sc={onDragStart:()=>{},onDragOver:()=>{},onDragEnter:(s,t,a)=>{var i;const n=(i=Me.get(s.sortables[a]))==null?void 0:i.ref.current;n&&(kc(n,a,t),rr(s.sortables,a,t),s.finalIndex=t)},onDragEnd:()=>{}};function kc(s,t,a){const n=s.parentElement;if(a<0)n.prepend(s);else{t>-1&&t<=a&&a++;const i=n.children.item(a);i?i.before(s):n.append(s)}}let V=null;const Js={line:vc,liveSort:wc,moveNode:Sc};function ir({item:s,items:t,type:a,ref:n,onSortEnd:i,onSortStart:l,onDragEnd:o,preview:c,disabled:d,onDropPositionChange:u,strategy:h="liveSort"}){g.useEffect(()=>{V&&V.sortables.length!==t.length&&(V.sortables=[...t],V.activeIndex=t.indexOf(s))},[t,s]);const{draggableProps:p,dragHandleRef:b}=fc({id:s,ref:n,type:a,preview:c,disabled:d,onDragStart:()=>{var S;V={sortables:[...t],activeSortable:s,activeIndex:t.indexOf(s),finalIndex:t.indexOf(s),dropPosition:null,ref:n,scrollParent:n.current?nl(n.current):void 0,scrollListener:()=>{nr(Me)}},Js[h].onDragStart(V),l==null||l(),(S=V.scrollParent)==null||S.addEventListener("scroll",V.scrollListener)},onDragEnd:()=>{var S;V&&(V.dropPosition=null,u==null||u(V.dropPosition),V.activeIndex!==V.finalIndex&&(i==null||i(V.activeIndex,V.finalIndex)),(S=V.scrollParent)==null||S.removeEventListener("scroll",V.scrollListener),Js[h].onDragEnd(V),o==null||o(),V=null)},getData:()=>{}}),{droppableProps:v}=go({id:s,ref:n,types:[a],disabled:d,allowDragEventsFromItself:!0,onDragOver:(S,C)=>{V&&Js[h].onDragOver({e:C,ref:n,item:s,sortSession:V,onDropPositionChange:u})},onDragEnter:()=>{if(!V)return;const S=V.sortables.indexOf(s),C=V.sortables.indexOf(V.activeSortable);Js[h].onDragEnter(V,S,C)},onDragLeave:()=>{V&&(V.dropPosition=null,u==null||u(V.dropPosition))}});return{sortableProps:{...qs(p,v)},dragHandleRef:b}}function Nc(){const{menuIndex:s}=X(),t=Ze(),{getValues:a}=N(),n=`settings.menus.${s}`,i=a(n);return g.useEffect(()=>{i?J().preview.setHighlight(`[data-menu-id="${i.id}"]`):t("/admin/appearance/menus")},[t,i]),i?e.jsx(Cc,{formPath:n}):null}function Cc({formPath:s}){const{site:{has_mobile_app:t}}=Y(),a=pt(l=>{var o;return(o=l.config)==null?void 0:o.sections.menus.config}),n=g.useMemo(()=>{const l=[...a==null?void 0:a.positions];return t&&l.push("mobile-app-about"),l.map(o=>({key:o,name:o.replaceAll("-"," ")}))},[a,t]),i=pe({name:`${s}.items`,keyName:"key"});return e.jsxs(g.Fragment,{children:[e.jsxs("div",{className:"mb-30 border-b pb-30",children:[e.jsx(j,{name:`${s}.name`,label:e.jsx(r,{message:"Menu name"}),className:"mb-20",autoFocus:!0}),e.jsx(rs,{chipSize:"sm",name:`${s}.positions`,valueKey:"id",label:e.jsx(r,{message:"Menu positions"}),description:e.jsx(r,{message:"Where should this menu appear on the site"}),children:n.map(l=>e.jsx(x,{value:l.key,capitalizeFirst:!0,children:l.name},l.key))})]}),e.jsx(_c,{fieldArray:i}),e.jsx("div",{className:"text-right",children:e.jsx(Ac,{})})]})}function _c({fieldArray:{append:s,fields:t,move:a}}){const n=Ze();return e.jsxs(g.Fragment,{children:[e.jsxs("div",{className:"flex flex-shrink-0 items-center justify-between gap-16",children:[e.jsx(r,{message:"Menu items"}),e.jsxs(z,{type:"popover",placement:"right",offset:20,onClose:i=>{i&&(s({...i}),n(`items/${t.length}`))},children:[e.jsx(f,{variant:"outline",color:"primary",size:"xs",startIcon:e.jsx(Ce,{}),children:e.jsx(r,{message:"Add"})}),e.jsx(sr,{})]})]}),e.jsxs("div",{className:"mt-20 flex-shrink-0",children:[t.map((i,l)=>e.jsx(Ec,{item:i,items:t,index:l,onSortEnd:(o,c)=>{a(o,c)}},i.key)),t.length?null:e.jsx(Vs,{size:"xs",className:"my-40",image:e.jsx(ct,{src:pc}),title:e.jsx(r,{message:"No menu items yet"}),description:e.jsx(r,{message:"Click “add“ button to start adding links, pages, routes and other items to this menu. "})})]})]})}function Ac(){const s=Ze(),{menuIndex:t}=X(),{fields:a,remove:n}=pe({name:"settings.menus",keyName:"key"});if(!t)return null;const i=a[+t];return e.jsxs(z,{type:"modal",onClose:l=>{if(l){const o=a.findIndex(c=>c.id===i.id);n(o),s("/admin/appearance/menus")}},children:[e.jsx(f,{variant:"outline",color:"danger",size:"xs",startIcon:e.jsx(ws,{}),children:e.jsx(r,{message:"Delete menu"})}),e.jsx(xe,{isDanger:!0,title:e.jsx(r,{message:"Delete menu"}),body:e.jsx(r,{message:"Are you sure you want to delete “:name“?",values:{name:i.name}}),confirm:e.jsx(r,{message:"Delete"})})]})}function Ec({item:s,items:t,index:a,onSortEnd:n}){const i=g.useRef(null),{sortableProps:l,dragHandleRef:o}=ir({item:s,items:t,type:"menuEditorSortable",ref:i,onSortEnd:n,strategy:"liveSort"}),c=s.icon&&ea(s.icon),d=e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted",children:[c&&e.jsx(c,{size:"sm"}),"(",e.jsx(r,{message:"No label..."}),")"]});return e.jsx(g.Fragment,{children:e.jsx(Ee,{elementType:D,to:`items/${a}`,ref:i,...l,children:e.jsxs("div",{className:"flex items-center gap-10",children:[e.jsx(_,{ref:o,size:"sm",children:e.jsx(tr,{className:"text-muted hover:cursor-move"})}),e.jsx("div",{children:s.label||d})]})})})}const Ic=O.forwardRef(({valueListKey:s="permissions",...t},a)=>{const{data:n}=we([s]),i=(n==null?void 0:n.permissions)||(n==null?void 0:n.workspacePermissions),[l,o]=vn(t.value,[],t.onChange),[c,d]=g.useState(!1);if(!i)return null;const u=lr(i,l,c),h=p=>{const b=[...l],v=b.findIndex(S=>S.id===p.id);v>-1&&b.splice(v,1,p),o(b)};return e.jsxs(g.Fragment,{children:[e.jsx(ns,{variant:"outline",ref:a,children:u.map(({groupName:p,items:b,anyChecked:v})=>e.jsx(be,{label:e.jsx(r,{message:jt(p)}),startIcon:v?e.jsx(rl,{size:"sm"}):void 0,children:e.jsx(fn,{children:b.map(S=>{const C=l.findIndex(E=>E.id===S.id),y=C>-1;return e.jsxs("div",{children:[e.jsx(bn,{onSelected:()=>{if(y){const E=[...l];E.splice(C,1),o(E)}else o([...l,S])},endSection:e.jsx(Lt,{tabIndex:-1,checked:y,onChange:()=>{}}),description:e.jsx(r,{message:S.description}),children:e.jsx(r,{message:S.display_name||S.name})}),y&&e.jsx(Tc,{permission:S,onChange:h})]},S.id)})})},p))}),e.jsx(Lt,{className:"mt-30",checked:c,onChange:p=>{d(p.target.checked)},children:e.jsx(r,{message:"Show advanced permissions"})})]})});function Tc({permission:s,onChange:t}){var n;if(!((n=s==null?void 0:s.restrictions)!=null&&n.length))return null;const a=(i,l)=>{const o=il(s,c=>{const d=c.restrictions.find(u=>u.name===i);d&&(d.value=l)});t==null||t(o)};return e.jsx("div",{className:"px-40 py-20",children:s.restrictions.map((i,l)=>{const o=l===s.restrictions.length-1,c=e.jsx(r,{message:jt(i.name)}),d=i.description?e.jsx(r,{message:i.description}):void 0;return i.type==="bool"?e.jsx(Lt,{description:d,className:I(!o&&"mb-30"),checked:!!i.value,onChange:u=>{a(i.name,u.target.checked)},children:c},i.name):e.jsx(es,{size:"sm",label:c,description:d,type:"number",className:I(!o&&"mb-30"),value:i.value||"",onChange:u=>{a(i.name,u.target.value===""?void 0:parseInt(u.target.value))}},i.name)})})}function fa(s){const{field:{onChange:t,value:a=[],ref:n}}=Bs({name:s.name}),i={onChange:t,value:a};return e.jsx(Ic,{ref:n,...qs(i,s)})}const jt=s=>er(s.replace("_"," "));function lr(s,t,a){const n=[];return s.forEach(i=>{const l=t.findIndex(c=>c.id===i.id);if(!a&&i.advanced)return;let o=n.find(c=>c.groupName===i.group);if(o||(o={groupName:i.group,anyChecked:!1,items:[]},n.push(o)),l>-1){const c={...i,restrictions:Fc(i.restrictions,t[l].restrictions)};o.anyChecked=!0,o.items.push(c)}else o.items.push(i)}),n}function Fc(s,t){return s==null?void 0:s.map(a=>{const n=t.find(i=>i.name===a.name);return n?{...a,value:n.value}:a})}const Et={grid:"flex flex-wrap gap-24",button:"flex flex-col items-center rounded hover:bg-hover h-90 aspect-square"},Pc=[...Array(60).keys()],zc=O.lazy(()=>ss(()=>import("./icon-list-ea140923.js"),["./icon-list-ea140923.js","./main-0be1d019.js","./main-5e25457c.css","./search-report-table-f0bbbc10.js","./reply-editor-b3f60ce1.js","./search-a322569b.js","./Edit-75236d4e.js","./AttachFile-577a01ff.js","./CalendarToday-ac5ebbff.js","./Comment-1f6b3e75.js","./OpenInNew-6a51e2d3.js","./Reply-1872c748.js","./TaskAlt-b41f0451.js","./section-helper-64d68e03.js","./breadcrumb-9f769b36.js","./bullet-seprated-items-25a8819d.js"],import.meta.url));function Dc({onIconSelected:s}){const{trans:t}=T(),[a,n]=O.useState("");return e.jsxs("div",{className:"py-4",children:[e.jsx(es,{className:"mb-20",value:a,onChange:i=>{n(i.target.value)},placeholder:t({message:"Search icons..."})}),e.jsx(dt,{mode:"wait",children:e.jsx(g.Suspense,{fallback:e.jsx(Xe.div,{...hs,className:Et.grid,children:Pc.map((i,l)=>e.jsx("div",{className:Et.button,children:e.jsx(xs,{variant:"rect"})},l))}),children:e.jsx(Xe.div,{...hs,className:Et.grid,children:e.jsx(zc,{searchQuery:a,onIconSelected:s})})})})]})}function Mc(){return e.jsxs(U,{size:"w-850",className:"min-h-dialog",children:[e.jsx(Q,{children:e.jsx(r,{message:"Select icon"})}),e.jsx(W,{children:e.jsx($c,{})})]})}function $c(){const{close:s}=H();return e.jsx(Dc,{onIconSelected:t=>{s(t)}})}function ba({formPathPrefix:s,hideRoleAndPermissionFields:t}){const{trans:a}=T(),n=i=>s?`${s}.${i}`:i;return e.jsxs(g.Fragment,{children:[e.jsx(j,{className:"mb-20",name:n("label"),label:e.jsx(r,{message:"Label"}),placeholder:a(m("No label...")),startAppend:e.jsx(Rc,{prefixName:n})}),e.jsx(Lc,{prefixName:n}),!t&&e.jsxs(g.Fragment,{children:[e.jsx(Oc,{prefixName:n}),e.jsx(qc,{prefixName:n})]}),e.jsx(Vc,{prefixName:n})]})}function Rc({prefixName:s,...t}){const{watch:a,setValue:n}=N(),i=s("icon"),l=a(i),o=l&&ea(l);return e.jsxs(z,{type:"modal",onClose:c=>{(c||c===null)&&n(i,c,{shouldDirty:!0})},children:[e.jsx(_,{className:"text-muted icon-sm",variant:"outline",size:"md",...t,children:o?e.jsx(o,{}):e.jsx(_e,{})}),e.jsx(Mc,{})]})}function Lc({prefixName:s}){const t=N(),a=t.watch(s("type")),n=ma(a),{data:i}=we(["menuItemCategories"]),l=(i==null?void 0:i.menuItemCategories)||[],o=l.find(u=>u.type===a),{trans:c}=T(),d=Zn();return g.useEffect(()=>{n&&n!==a&&t.setValue(s("action"),"")},[a,n,t,s]),e.jsxs(g.Fragment,{children:[e.jsxs(M,{className:"mb-20",name:s("type"),selectionMode:"single",label:e.jsx(r,{message:"Type"}),children:[e.jsx(x,{value:"link",children:e.jsx(r,{message:"Custom link"})}),e.jsx(x,{value:"route",children:e.jsx(r,{message:"Site page"})}),l.map(u=>e.jsx(x,{value:u.type,children:u.name},u.type))]}),a==="link"&&e.jsx(j,{className:"mb-20",required:!0,type:"url",name:s("action"),placeholder:c({message:"Enter a url..."}),label:e.jsx(r,{message:"Url"})}),a==="route"&&e.jsx(M,{className:"mb-20",required:!0,items:d,name:s("action"),label:e.jsx(r,{message:"Page"}),searchPlaceholder:c(m("Search pages")),showSearchField:!0,selectionMode:"single",children:u=>e.jsx(x,{value:u.id,children:u.label},u.id)}),o&&e.jsx(M,{className:"mb-20",required:!0,items:o.items,name:s("action"),showSearchField:!0,searchPlaceholder:c(m("Search...")),selectionMode:"single",label:e.jsx(r,{message:o.name}),children:u=>e.jsx(x,{value:u.action,children:e.jsx(r,{message:u.label})})})]})}function Oc({prefixName:s}){const{data:t}=we(["roles","permissions"]),a=(t==null?void 0:t.roles)||[],{trans:n}=T();return e.jsx(rs,{className:"mb-20",placeholder:n({message:"Add role..."}),label:e.jsx(r,{message:"Only show if user has role"}),name:s("roles"),chipSize:"sm",suggestions:a,valueKey:"id",displayWith:i=>{var l;return(l=a.find(o=>o.id===i.id))==null?void 0:l.name},children:i=>e.jsx(x,{value:i.id,capitalizeFirst:!0,children:e.jsx(r,{message:i.name})},i.id)})}function qc({prefixName:s}){const{data:t}=we(["roles","permissions"]),{trans:a}=T(),n=g.useMemo(()=>lr((t==null?void 0:t.permissions)||[],[],!1),[t==null?void 0:t.permissions]);return e.jsx(rs,{label:e.jsx(r,{message:"Only show if user has permissions"}),placeholder:a({message:"Add permission..."}),chipSize:"sm",suggestions:n,name:s("permissions"),valueKey:"name",children:({groupName:i,items:l})=>e.jsx(sa,{label:jt(i),children:l.map(o=>e.jsx(x,{value:o.name,description:e.jsx(r,{message:o.description}),children:e.jsx(r,{message:o.display_name||o.name})},o.name))},i)})}function Vc({prefixName:s}){return e.jsxs(M,{className:"mt-20",selectionMode:"single",name:s("target"),label:e.jsx(r,{message:"Open link in"}),children:[e.jsx(x,{value:"_self",children:e.jsx(r,{message:"Same window"})}),e.jsx(x,{value:"_blank",children:e.jsx(r,{message:"New window"})})]})}function Bc(){const{menuIndex:s,menuItemIndex:t}=X(),a=Z(),{getValues:n}=N(),i=`settings.menus.${s}.items.${t}`,l=n(i);return g.useEffect(()=>{l&&J().preview.setHighlight(`[data-menu-item-id="${l.id}"]`)},[a,l]),!l||t==null?null:e.jsx(Hc,{formPath:i})}function Hc({formPath:s}){return e.jsxs(g.Fragment,{children:[e.jsx(ba,{formPathPrefix:s}),e.jsx("div",{className:"text-right mt-40",children:e.jsx(Uc,{})})]})}function Uc(){const s=Z(),{menuIndex:t,menuItemIndex:a}=X(),{fields:n,remove:i}=pe({name:`settings.menus.${+t}.items`});if(!a)return null;const l=n[+a];return e.jsxs(z,{type:"modal",onClose:o=>{o&&a&&(i(+a),s(`/admin/appearance/menus/${t}`))},children:[e.jsx(f,{variant:"outline",color:"danger",size:"xs",startIcon:e.jsx(ws,{}),children:e.jsx(r,{message:"Delete this item"})}),e.jsx(xe,{isDanger:!0,title:e.jsx(r,{message:"Delete menu item"}),body:e.jsx(r,{message:"Are you sure you want to delete “:name“?",values:{name:l.label}}),confirm:e.jsx(r,{message:"Delete"})})]})}function Kc(){return e.jsxs(g.Fragment,{children:[e.jsx(Ns,{label:e.jsx(r,{message:"Favicon"}),description:e.jsx(r,{message:"This will generate different size favicons. Image should be at least 512x512 in size."}),type:"favicon"}),e.jsx(Ns,{label:e.jsx(r,{message:"Light logo"}),description:e.jsx(r,{message:"Will be used on dark backgrounds."}),type:"logo_light"}),e.jsx(Ns,{label:e.jsx(r,{message:"Dark logo"}),description:e.jsx(r,{message:"Will be used on light backgrounds. Will default to light logo if left empty."}),type:"logo_dark"}),e.jsx(Ns,{label:e.jsx(r,{message:"Mobile light logo"}),description:e.jsx(r,{message:"Will be used on light backgrounds on mobile. Will default to desktop logo if left empty."}),type:"logo_light_mobile"}),e.jsx(Ns,{label:e.jsx(r,{message:"Mobile dark logo"}),description:e.jsx(r,{message:"Will be used on dark backgrounds on mobile. Will default to desktop if left empty."}),type:"logo_dark_mobile"}),e.jsx(Wc,{}),e.jsx(Gc,{})]})}function Ns({label:s,description:t,type:a}){const n=pt(i=>{var l;return(l=i.defaults)==null?void 0:l.settings.branding[a]});return e.jsx(Ls,{name:`settings.branding.${a}`,className:"border-b pb-30 mb-30",label:s,description:t,diskPrefix:"branding_media",defaultValue:n,onChange:()=>{J().preview.setHighlight('[data-logo="navbar"]')}})}function Wc(){return e.jsx(j,{name:"appearance.env.app_name",required:!0,className:"mt-20",label:e.jsx(r,{message:"Site name"})})}function Gc(){return e.jsx(j,{name:"settings.branding.site_description",className:"mt-20",inputElementType:"textarea",rows:4,label:e.jsx(r,{message:"Site description"})})}function Qc(s=1,t=1e4){const a=new Uint32Array(1);window.crypto.getRandomValues(a);const n=a[0]/(4294967295+1);return s=Math.ceil(s),t=Math.floor(t),Math.floor(n*(t-s+1))+s}function Jc(){const{trans:s}=T(),t=Ze(),{data:{themes:a}}=yn(),{fields:n,append:i}=pe({name:"appearance.themes.all",keyName:"key"});return g.useEffect(()=>{a.selectedThemeId&&J().preview.setActiveTheme(a.selectedThemeId)},[a.selectedThemeId]),e.jsxs(g.Fragment,{children:[e.jsx("div",{className:"mb-20",children:e.jsx(f,{size:"xs",variant:"outline",color:"primary",startIcon:e.jsx(Ce,{}),onClick:()=>{var o;const l=(o=J().defaults)==null?void 0:o.appearance.themes.light;i({id:Qc(),name:s(m("New theme")),values:l}),t(`${n.length+1}`)},children:e.jsx(r,{message:"New theme"})})}),n.map((l,o)=>e.jsx(Ee,{to:`${o}`,elementType:ta,children:l.name},l.key))]})}const Yc=O.lazy(()=>ss(()=>import("./ace-editor-5fb22f83.js"),["./ace-editor-5fb22f83.js","./main-0be1d019.js","./main-5e25457c.css","./index-2a52c48e.js"],import.meta.url));function va({defaultValue:s,mode:t="html",title:a,onSave:n,isSaving:i,footerStartAction:l,beautify:o,editorRef:c}){const[d,u]=g.useState(s),[h,p]=g.useState(!0);return e.jsxs(U,{size:"fullscreen",className:"h-full w-full",children:[e.jsx(Q,{children:a}),e.jsx(W,{className:"relative flex-auto",padding:"p-0",children:e.jsx(g.Suspense,{fallback:e.jsx("div",{className:"flex h-400 w-full items-center justify-center",children:e.jsx(bs,{"aria-label":"Loading editor...",isIndeterminate:!0,size:"md"})}),children:e.jsx(Yc,{beautify:o,mode:t,onChange:b=>u(b),defaultValue:d||"",onIsValidChange:p,editorRef:c})})}),e.jsx(Xc,{disabled:!h||i,value:d,onSave:n,startAction:l})]})}function Xc({disabled:s,value:t,onSave:a,startAction:n}){const{close:i}=H();return e.jsxs(ae,{dividerTop:!0,startAction:n,children:[e.jsx(f,{onClick:()=>i(),children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{disabled:s,variant:"flat",color:"primary",onClick:()=>{a?a(t):i(t)},children:e.jsx(r,{message:"Save"})})]})}function or(s){return ne({queryKey:["admin","seo-tags",s],queryFn:()=>Zc(s)})}function Zc(s){return w.get(`admin/appearance/seo-tags/${s}`).then(t=>t.data)}function ed(s){const t=wn();return F({mutationFn:a=>sd(s,a.tags),onSuccess:async()=>{await t.invalidateQueries({queryKey:["admin","seo-tags",s]}),P(m("Updated SEO tags"))},onError:a=>B(a)})}function sd(s,t){return w.put(`admin/appearance/seo-tags/${s}`,{tags:t}).then(a=>a.data)}var pn;const cr=((pn=pa.sections["seo-settings"].config)==null?void 0:pn.pages)||[],dr=cr.map(s=>s.key);function td(){const{isLoading:s}=or(dr);return s?e.jsx(Fe,{}):e.jsx(g.Fragment,{children:cr.map(t=>e.jsx(ad,{label:t.label,name:t.key},t.key))})}function ad({label:s,name:t}){const{data:a,isLoading:n}=or(dr);return e.jsxs(z,{type:"modal",children:[e.jsx(Ee,{disabled:n,children:e.jsx(r,{...s})}),a?e.jsx(nd,{name:t,value:a[t]}):null]})}function nd({name:s,value:t}){const{close:a}=H(),n=ed(s),i=g.useRef(null),l=e.jsx(f,{variant:"outline",color:"primary",onClick:()=>{i.current&&i.current.editor.setValue(t.original)},children:e.jsx(r,{message:"Reset to original"})});return e.jsx(va,{mode:"php_laravel_blade",title:e.jsx(r,{message:"Edit SEO meta tags"}),footerStartAction:l,editorRef:i,defaultValue:t.custom||t.original,isSaving:n.isPending,beautify:!1,onSave:o=>{o!=null&&n.mutate({tags:o},{onSuccess:()=>a()})}})}function rd(){return e.jsxs(g.Fragment,{children:[e.jsx(qa,{mode:"css"}),e.jsx(qa,{mode:"html"})]})}function qa({mode:s}){const{getValues:t}=N(),{setValue:a}=N(),n=s==="html"?e.jsx(r,{message:"Custom HTML & JavaScript"}):e.jsx(r,{message:"Custom CSS"});return e.jsxs(z,{type:"modal",onClose:i=>{i!=null&&(a(`appearance.custom_code.${s}`,i,{shouldDirty:!0}),J().preview.setCustomCode(s,i))},children:[e.jsx(Ee,{children:n}),e.jsx(va,{title:n,defaultValue:t(`appearance.custom_code.${s}`)||"",mode:s})]})}const id=""+new URL("articles-8bfd9f17.svg",import.meta.url).href,ld=s=>{const t=s.customPages.types.length>1?[{control:{type:he.Select,defaultValue:"default",options:s.customPages.types.map(a=>({value:a.type,label:a.label,key:a.type}))},key:"type",label:m("Type"),description:m("Type of the page"),defaultOperator:G.eq}]:[];return[{key:"user_id",label:m("User"),description:m("User page was created by"),defaultOperator:G.eq,control:{type:he.SelectModel,model:ha}},...t,Oe({description:m("Date page was created")}),Qe({description:m("Date page was last updated")})]},od=[{key:"slug",allowsSorting:!0,width:"flex-2 min-w-200",visibleInMode:"all",header:()=>e.jsx(r,{message:"Slug"}),body:s=>e.jsx(D,{target:"_blank",to:`/pages/${s.slug}`,className:Hs,children:s.slug})},{key:"user_id",allowsSorting:!0,width:"flex-2 min-w-140",header:()=>e.jsx(r,{message:"Owner"}),body:s=>s.user&&e.jsx(qe,{image:s.user.avatar,label:s.user.display_name,description:s.user.email})},{key:"type",maxWidth:"max-w-100",header:()=>e.jsx(r,{message:"Type"}),body:s=>e.jsx(r,{message:s.type})},{key:"updated_at",allowsSorting:!0,width:"w-100",header:()=>e.jsx(r,{message:"Last updated"}),body:s=>e.jsx(ce,{date:s.updated_at})},{key:"actions",header:()=>e.jsx(r,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-84 flex-shrink-0",visibleInMode:"all",body:s=>e.jsx(_,{size:"md",className:"text-muted",elementType:D,to:`${s.id}/edit`,children:e.jsx(_e,{})})}];function cd(){const s=g.useContext(ts),t=g.useMemo(()=>ld(s),[s]);return e.jsx(je,{endpoint:"custom-pages",title:e.jsx(r,{message:"Custom pages"}),filters:t,columns:od,queryParams:{with:"user"},actions:e.jsx(dd,{}),selectedActions:e.jsx(De,{}),emptyStateMessage:e.jsx(ue,{image:id,title:e.jsx(r,{message:"No pages have been created yet"}),filteringTitle:e.jsx(r,{message:"No matching pages"})})})}function dd(){return e.jsx(Se,{elementType:D,to:"new",children:e.jsx(r,{message:"New page"})})}const ud=[{label:m("Search"),to:"search"},{label:m("Incoming email"),to:"incoming-email"},{label:m("Help center"),to:"hc"},{label:m("Envato"),to:"envato"}],md=[{label:m("General"),to:"general"},...ud,Sn().settings.billing.integrated&&{label:m("Subscriptions"),to:"subscriptions"},{label:m("Localization"),to:"localization"},{label:m("Authentication"),to:"authentication"},{label:m("Uploading"),to:"uploading"},{label:m("Outgoing email"),to:"outgoing-email"},{label:m("Cache"),to:"cache"},{label:m("Analytics"),to:"analytics"},{label:m("Logging"),to:"logging"},{label:m("Queue"),to:"queue"},{label:m("Recaptcha"),to:"recaptcha"},{label:m("GDPR"),to:"gdpr"},{label:m("Menus"),to:"/admin/appearance/menus"},{label:m("Seo"),to:"/admin/appearance/seo-settings"},{label:m("Themes"),to:"/admin/appearance/themes"}].filter(Boolean),ur=md;function gd({className:s}){const t=as();return e.jsxs("div",{className:I(s,"container mx-auto min-h-full items-start gap-30 p-24 md:flex"),children:[e.jsx(fs,{children:e.jsx(r,{message:"Settings"})}),t?e.jsx(hd,{}):e.jsx(xd,{}),e.jsx("div",{className:"relative max-w-500 flex-auto md:px-30",children:e.jsx($s,{})})]})}function hd(){const{pathname:s}=Os(),t=Ze(),a=s.split("/").pop();return e.jsx(ys,{minWidth:"min-w-none",className:"mb-24 w-full bg",selectionMode:"single",selectedValue:a,onSelectionChange:n=>{t(n)},children:ur.map(n=>e.jsx(x,{value:n.to,children:e.jsx(r,{...n.label})},n.to))})}function xd(){return e.jsx("div",{className:"sticky top-24 w-240 flex-shrink-0",children:ur.map(s=>e.jsx(ta,{to:s.to,className:({isActive:t})=>I("mb-8 block whitespace-nowrap rounded-button p-14 text-sm transition-bg-color",t?"bg-primary/6 font-semibold text-primary":"hover:bg-hover"),children:e.jsx(r,{...s.label})},s.to))})}function Gs(){return ne({queryKey:["fetchAdminSettings"],queryFn:()=>pd(),staleTime:1/0})}function pd(){return w.get("settings").then(s=>s.data)}function jd(){return w.post("sitemap/generate").then(s=>s.data)}function fd(){return F({mutationFn:()=>jd(),onSuccess:()=>{P(m("Sitemap generated"))},onError:s=>B(s)})}const It=s=>s instanceof Date,bd=s=>Object.keys(s).length===0,Ot=s=>s!=null&&typeof s=="object",Va=(s,...t)=>Object.prototype.hasOwnProperty.call(s,...t),Tt=s=>Ot(s)&&bd(s),vd=()=>Object.create(null),qt=(s,t)=>{if(s===t)return{};if(!Ot(s)||!Ot(t))return t;const a=Object.keys(s).reduce((n,i)=>(Va(t,i)||(n[i]=void 0),n),vd());return It(s)||It(t)?s.valueOf()==t.valueOf()?{}:t:Object.keys(t).reduce((n,i)=>{if(!Va(s,i))return n[i]=t[i],n;const l=qt(s[i],t[i]);return Tt(l)&&!It(l)&&(Tt(s[i])||!Tt(t[i]))||(n[i]=l),n},a)};function is(s,t){var a,n;if(typeof t=="function")n=t(s),n!==void 0&&(s=n);else if(Array.isArray(t))for(a=0;a<t.length;a++)n=t[a](s),n!==void 0&&(s=n);return s}function yd(s,t){return s[0]==="-"&&Array.isArray(t)&&/^-\d+$/.test(s)?t.length+parseInt(s,10):s}function wd(s){return/^\d+$/.test(s)}function st(s){return Object.prototype.toString.call(s)==="[object Object]"}function Cs(s){return Object(s)===s}function tt(s){return Object.keys(s).length===0}var Sd=["__proto__","prototype","constructor"],kd=function(s){return Sd.indexOf(s)===-1};function ft(s,t){s.indexOf("[")>=0&&(s=s.replace(/\[/g,t).replace(/]/g,""));var a=s.split(t),n=a.filter(kd);if(n.length!==a.length)throw Error("Refusing to update blacklisted property "+s);return a}var Ba=Object.prototype.hasOwnProperty;function L(s,t,a,n){if(!(this instanceof L))return new L(s,t,a,n);typeof t>"u"&&(t=!1),typeof a>"u"&&(a=!0),typeof n>"u"&&(n=!0),this.separator=s||".",this.override=t,this.useArray=a,this.useBrackets=n,this.keepArray=!1,this.cleanup=[]}var js=new L(".",!1,!0,!0);function Ie(s){return function(){return js[s].apply(js,arguments)}}L.prototype._fill=function(s,t,a,n){var i=s.shift();if(s.length>0){if(t[i]=t[i]||(this.useArray&&wd(s[0])?[]:{}),!Cs(t[i]))if(this.override)t[i]={};else{if(!(Cs(a)&&tt(a)))throw new Error("Trying to redefine `"+i+"` which is a "+typeof t[i]);return}this._fill(s,t[i],a,n)}else{if(!this.override&&Cs(t[i])&&!tt(t[i])){if(!(Cs(a)&&tt(a)))throw new Error("Trying to redefine non-empty obj['"+i+"']");return}t[i]=is(a,n)}};L.prototype.object=function(s,t){var a=this;return Object.keys(s).forEach(function(n){var i=t===void 0?null:t[n],l=ft(n,a.separator).join(a.separator);l.indexOf(a.separator)!==-1?(a._fill(l.split(a.separator),s,s[n],i),delete s[n]):s[n]=is(s[n],i)}),s};L.prototype.str=function(s,t,a,n){var i=ft(s,this.separator).join(this.separator);return s.indexOf(this.separator)!==-1?this._fill(i.split(this.separator),a,t,n):a[s]=is(t,n),a};L.prototype.pick=function(s,t,a,n){var i,l,o,c,d;for(l=ft(s,this.separator),i=0;i<l.length;i++)if(c=yd(l[i],t),t&&typeof t=="object"&&c in t){if(i===l.length-1)return a?(o=t[c],n&&Array.isArray(t)?t.splice(c,1):delete t[c],Array.isArray(t)&&(d=l.slice(0,-1).join("."),this.cleanup.indexOf(d)===-1&&this.cleanup.push(d)),o):t[c];t=t[c]}else return;return a&&Array.isArray(t)&&(t=t.filter(function(u){return u!==void 0})),t};L.prototype.delete=function(s,t){return this.remove(s,t,!0)};L.prototype.remove=function(s,t,a){var n;if(this.cleanup=[],Array.isArray(s)){for(n=0;n<s.length;n++)this.pick(s[n],t,!0,a);return a||this._cleanup(t),t}else return this.pick(s,t,!0,a)};L.prototype._cleanup=function(s){var t,a,n,i;if(this.cleanup.length){for(a=0;a<this.cleanup.length;a++)n=this.cleanup[a].split("."),i=n.splice(0,-1).join("."),t=i?this.pick(i,s):s,t=t[n[0]].filter(function(l){return l!==void 0}),this.set(this.cleanup[a],t,s);this.cleanup=[]}};L.prototype.del=L.prototype.remove;L.prototype.move=function(s,t,a,n,i){return typeof n=="function"||Array.isArray(n)?this.set(t,is(this.pick(s,a,!0),n),a,i):(i=n,this.set(t,this.pick(s,a,!0),a,i)),a};L.prototype.transfer=function(s,t,a,n,i,l){return typeof i=="function"||Array.isArray(i)?this.set(t,is(this.pick(s,a,!0),i),n,l):(l=i,this.set(t,this.pick(s,a,!0),n,l)),n};L.prototype.copy=function(s,t,a,n,i,l){return typeof i=="function"||Array.isArray(i)?this.set(t,is(JSON.parse(JSON.stringify(this.pick(s,a,!1))),i),n,l):(l=i,this.set(t,this.pick(s,a,!1),n,l)),n};L.prototype.set=function(s,t,a,n){var i,l,o,c;if(typeof t>"u")return a;for(o=ft(s,this.separator),i=0;i<o.length;i++){if(c=o[i],i===o.length-1)if(n&&st(t)&&st(a[c]))for(l in t)Ba.call(t,l)&&(a[c][l]=t[l]);else if(n&&Array.isArray(a[c])&&Array.isArray(t))for(var d=0;d<t.length;d++)a[o[i]].push(t[d]);else a[c]=t;else(!Ba.call(a,c)||!st(a[c])&&!Array.isArray(a[c]))&&(/^\d+$/.test(o[i+1])?a[c]=[]:a[c]={});a=a[c]}return a};L.prototype.transform=function(s,t,a){return t=t||{},a=a||{},Object.keys(s).forEach((function(n){this.set(s[n],this.pick(n,t),a)}).bind(this)),a};L.prototype.dot=function(s,t,a){t=t||{},a=a||[];var n=Array.isArray(s);return Object.keys(s).forEach((function(i){var l=n&&this.useBrackets?"["+i+"]":i;if(Cs(s[i])&&(st(s[i])&&!tt(s[i])||Array.isArray(s[i])&&!this.keepArray&&s[i].length!==0))if(n&&this.useBrackets){var o=a[a.length-1]||"";return this.dot(s[i],t,a.slice(0,-1).concat(o+l))}else return this.dot(s[i],t,a.concat(l));else n&&this.useBrackets?t[a.join(this.separator).concat("["+i+"]")]=s[i]:t[a.concat(l).join(this.separator)]=s[i]}).bind(this)),t};L.pick=Ie("pick");L.move=Ie("move");L.transfer=Ie("transfer");L.transform=Ie("transform");L.copy=Ie("copy");L.object=Ie("object");L.str=Ie("str");L.set=Ie("set");L.delete=Ie("delete");L.del=L.remove=Ie("remove");L.dot=Ie("dot");["override","overwrite"].forEach(function(s){Object.defineProperty(L,s,{get:function(){return js.override},set:function(t){js.override=!!t}})});["useArray","keepArray","useBrackets"].forEach(function(s){Object.defineProperty(L,s,{get:function(){return js[s]},set:function(t){js[s]=t}})});L._process=is;var Nd=L;const Ha=ll(Nd);function mr(s){const{data:t}=Gs();return F({mutationFn:a=>{var l,o,c,d,u,h,p,b,v,S,C;(o=(l=a.client)==null?void 0:l.cookie_notice)!=null&&o.button&&(a.client.cookie_notice.button=JSON.stringify(a.client.cookie_notice.button)),(d=(c=a.client)==null?void 0:c.registration)!=null&&d.policies&&(a.client.registration.policies=JSON.stringify(a.client.registration.policies)),(h=(u=a.client)==null?void 0:u.artistPage)!=null&&h.tabs&&(a.client.artistPage.tabs=JSON.stringify(a.client.artistPage.tabs)),(b=(p=a.client)==null?void 0:p.title_page)!=null&&b.sections&&(a.client.title_page.sections=JSON.stringify(a.client.title_page.sections)),(v=a.client)!=null&&v.incoming_email&&(a.client.incoming_email=JSON.stringify(a.client.incoming_email)),(C=(S=a.client)==null?void 0:S.publish)!=null&&C.default_credentials&&(a.client.publish.default_credentials=JSON.stringify(a.client.publish.default_credentials));const n=a.client?qt(t.client,a.client):null,i=a.server?qt(t.server,a.server):null;return Cd({client:n,server:i,files:a.files})},onSuccess:()=>{P(m("Settings updated"),{position:"bottom-right"}),k.invalidateQueries({queryKey:["fetchAdminSettings"]})},onError:a=>te(a,s)})}function Cd({client:s,server:t,files:a}){const n=new FormData;return s&&n.set("client",JSON.stringify(Ha.dot(s))),t&&n.set("server",JSON.stringify(Ha.dot(t))),Object.entries(a||{}).forEach(([i,l])=>{n.set(i,l)}),w.post("settings",n,{headers:{"Content-Type":"multipart/form-data"}}).then(i=>i.data)}function ge({title:s,description:t,children:a,transformValues:n}){const{data:i}=Gs();return e.jsxs("section",{children:[e.jsxs("div",{className:"mb-40",children:[e.jsx("h2",{className:"mb-4 text-xl",children:s}),e.jsx("div",{className:"text-sm text-muted",children:t})]}),i?e.jsx(_d,{defaultValues:i,transformValues:n,children:a}):e.jsx(bs,{isIndeterminate:!0,"aria-label":"Loading settings..."})]})}function _d({children:s,defaultValues:t,transformValues:a}){const n=q({defaultValues:t}),i=mr(n);return e.jsxs(g.Fragment,{children:[e.jsxs(me,{form:n,onBeforeSubmit:()=>{const l=n.formState.errors,o=Object.keys(l).filter(c=>c.endsWith("_group"));n.clearErrors(o)},onSubmit:l=>{l=a?a(l):l,i.mutate(l)},children:[s,e.jsx("div",{className:"mt-40",children:e.jsx(f,{type:"submit",variant:"flat",color:"primary",disabled:i.isPending,children:e.jsx(r,{message:"Update"})})})]}),i.isPending&&e.jsx(kn,{size:"xs",className:"absolute -bottom-14 left-30 w-full",isIndeterminate:!0,"aria-label":"Saving settings..."})]})}function Re(){return e.jsx("div",{className:"h-1 bg-divider my-30"})}function Ve({link:s,className:t}){const{site:a}=Y();return a.hide_docs_button?null:e.jsxs("div",{className:I("flex items-center gap-8",t),children:[e.jsx(Bn,{size:"sm"}),e.jsx(ut,{href:s,children:e.jsx(r,{message:"Learn more"})})]})}function Ad(){return e.jsxs(ge,{title:e.jsx(r,{message:"General"}),description:e.jsx(r,{message:"Configure site url, homepage, theme and other general settings."}),children:[e.jsx(Ed,{}),e.jsx(Re,{}),e.jsx(Id,{}),e.jsx(Re,{}),e.jsx(Td,{}),e.jsx(Re,{}),e.jsx(Fd,{})]})}function Ed(){const{data:s}=Gs();if(!s)return null;let t=null;const a=s.server,n=a.newAppUrl&&a.newAppUrl!==a.app_url;return n&&(t=e.jsx("div",{className:"mt-20 text-sm text-danger",children:e.jsx(r,{values:{baseUrl:a.app_url,currentUrl:a.newAppUrl,b:i=>e.jsx("b",{children:i})},message:"Base site url is set as <b>:baseUrl</b> in configuration, but current url is <b>:currentUrl</b>. It is recommended to set the primary url you want to use in configuration file and then redirect all other url versions to this primary version via cpanel or .htaccess file."})})),e.jsxs(g.Fragment,{children:[e.jsx(j,{invalid:!!n,name:"server.app_url",label:e.jsx(r,{message:"Primary site url"}),description:e.jsx(Ve,{link:"https://support.vebto.com/help-center/articles/35/primary-site-url"})}),t]})}function Id(){var i,l;const{watch:s}=N(),{homepage:t}=g.useContext(ts),{data:a}=we(["menuItemCategories"]),n=s("client.homepage.type");return e.jsxs("div",{children:[e.jsxs(M,{name:"client.homepage.type",selectionMode:"single",label:e.jsx(r,{message:"Site home page"}),description:e.jsx(r,{message:"Which page should be used as site homepage."}),children:[t.options.map(o=>e.jsx(x,{value:o.value,children:e.jsx(r,{...o.label})},o.value)),(i=a==null?void 0:a.menuItemCategories)==null?void 0:i.map(o=>e.jsx(x,{value:o.type,children:o.name},o.type))]}),(l=a==null?void 0:a.menuItemCategories)==null?void 0:l.map(o=>n===o.type?e.jsx(M,{className:"mt-24",name:"client.homepage.value",selectionMode:"single",label:e.jsx(r,{message:"Homepage :name",values:{name:o.name}}),children:o.items.map(c=>e.jsx(x,{value:c.model_id,children:c.label},c.label))},o.name):null)]})}function Td(){const{data:{themes:s}}=yn();return e.jsxs(g.Fragment,{children:[e.jsxs(M,{className:"mb-20",name:"client.themes.default_id",selectionMode:"single",label:e.jsx(r,{message:"Default site theme"}),description:e.jsx(r,{message:"Which theme to use for users that have not chosen a theme manually."}),children:[e.jsx(x,{value:0,children:e.jsx(r,{message:"System"})}),s.all.map(t=>e.jsx(x,{value:t.id,children:t.name},t.id))]}),e.jsx(A,{name:"client.themes.user_change",description:e.jsx(r,{message:"Allow users to manually change site theme."}),children:e.jsx(r,{message:"Allow theme change"})})]})}function Fd(){const s=fd(),{base_url:t}=Y(),a=`${t}/storage/sitemaps/sitemap-index.xml`,n=e.jsx(ut,{href:a,children:a});return e.jsxs(e.Fragment,{children:[e.jsx(f,{variant:"outline",size:"xs",color:"primary",disabled:s.isPending,onClick:()=>{s.mutate()},children:e.jsx(r,{message:"Generate sitemap"})}),e.jsx("div",{className:"mt-14 text-sm text-muted",children:e.jsx(r,{message:"Once generated, sitemap url will be: :url",values:{url:n}})})]})}const gr=R(e.jsx("path",{stroke:"#E0E0E0",d:"M24,44c-7.168,0-13-5.816-13-12.971C11,24,24,4,24,4s13,20,13,27.029C37,38.184,31.168,44,24,44z"}));class Pd{getStringForLocale(t,a){let n=this.strings[a];n||(n=zd(a,this.strings,this.defaultLocale),this.strings[a]=n);let i=n[t];if(!i)throw new Error(`Could not find intl message ${t} in ${a} locale`);return i}constructor(t,a="en-US"){this.strings={...t},this.defaultLocale=a}}function zd(s,t,a="en-US"){if(t[s])return t[s];let n=Dd(s);if(t[n])return t[n];for(let i in t)if(i.startsWith(n+"-"))return t[i];return t[a]}function Dd(s){return Intl.Locale?new Intl.Locale(s).language:s.split("-")[0]}function Md(s){return s&&s.__esModule?s.default:s}var hr={},xr={};xr={alpha:"ألفا",blue:"أزرق",brightness:"السطوع",green:"أخضر",hue:"درجة اللون",lightness:"الإضاءة",red:"أحمر",saturation:"التشبع"};var pr={};pr={alpha:"Алфа",blue:"Синьо",brightness:"Яркост",green:"Зелено",hue:"Оттенък",lightness:"Лекота",red:"Червено",saturation:"Наситеност"};var jr={};jr={alpha:"Alfa",blue:"Modrá",brightness:"Jas",green:"Zelená",hue:"Odstín",lightness:"Světlost",red:"Červená",saturation:"Sytost"};var fr={};fr={alpha:"Alfa",blue:"Blå",brightness:"Lysstyrke",green:"Grøn",hue:"Tone",lightness:"Lyshed",red:"Rød",saturation:"Farvemætning"};var br={};br={alpha:"Alpha",blue:"Blau",brightness:"Helligkeit",green:"Grün",hue:"Farbton",lightness:"Leuchtkraft",red:"Rot",saturation:"Sättigung"};var vr={};vr={alpha:"Άλφα",blue:"Μπλε",brightness:"Φωτεινότητα",green:"Πράσινο",hue:"Τόνος",lightness:"Φωτεινότητα",red:"Κόκκινο",saturation:"Κορεσμός"};var yr={};yr={hue:"Hue",saturation:"Saturation",lightness:"Lightness",brightness:"Brightness",red:"Red",green:"Green",blue:"Blue",alpha:"Alpha"};var wr={};wr={alpha:"Alpha",blue:"Azul",brightness:"Brillo",green:"Verde",hue:"Tono",lightness:"Luminosidad",red:"Rojo",saturation:"Saturación"};var Sr={};Sr={alpha:"Alfa",blue:"Sinine",brightness:"Heledus",green:"Roheline",hue:"Värv",lightness:"Valgus",red:"Punane",saturation:"Küllastus"};var kr={};kr={alpha:"Alpha",blue:"Sininen",brightness:"Kirkkaus",green:"Vihreä",hue:"Sävy",lightness:"Valomäärä",red:"Punainen",saturation:"Värikylläisyys"};var Nr={};Nr={alpha:"Alpha",blue:"Bleu",brightness:"Luminosité",green:"Vert",hue:"Teinte",lightness:"Luminosité",red:"Rouge",saturation:"Saturation"};var Cr={};Cr={alpha:"אלפא",blue:"כחול",brightness:"בהירות",green:"ירוק",hue:"גוון",lightness:"כמות אור",red:"אדום",saturation:"רוויה"};var _r={};_r={alpha:"Alfa",blue:"Plava",brightness:"Svjetlina",green:"Zelena",hue:"Nijansa",lightness:"Osvijetljenost",red:"Crvena",saturation:"Zasićenost"};var Ar={};Ar={alpha:"Alfa",blue:"Kék",brightness:"Fényesség",green:"Zöld",hue:"Színárnyalat",lightness:"Világosság",red:"Piros",saturation:"Telítettség"};var Er={};Er={alpha:"Alfa",blue:"Blu",brightness:"Luminosità",green:"Verde",hue:"Tonalità",lightness:"Luminosità",red:"Rosso",saturation:"Saturazione"};var Ir={};Ir={alpha:"アルファ",blue:"青",brightness:"明るさ",green:"緑",hue:"色相",lightness:"明度",red:"赤",saturation:"彩度"};var Tr={};Tr={alpha:"알파",blue:"파랑",brightness:"명도",green:"초록",hue:"색조",lightness:"밝기",red:"빨강",saturation:"채도"};var Fr={};Fr={alpha:"Alfa",blue:"Mėlyna",brightness:"Ryškumas",green:"Žalia",hue:"Atspalvis",lightness:"Šviesumas",red:"Raudona",saturation:"Įsotinimas"};var Pr={};Pr={alpha:"Alfa",blue:"Zila",brightness:"Spilgtums",green:"Zaļa",hue:"Nokrāsa",lightness:"Gaišums",red:"Sarkana",saturation:"Piesātinājums"};var zr={};zr={alpha:"Alfa",blue:"Blå",brightness:"Lysstyrke",green:"Grønn",hue:"Fargetone",lightness:"Lyshet",red:"Rød",saturation:"Metning"};var Dr={};Dr={alpha:"Alfa",blue:"Blauw",brightness:"Helderheid",green:"Groen",hue:"Kleurtoon",lightness:"Lichtsterkte",red:"Rood",saturation:"Verzadiging"};var Mr={};Mr={alpha:"Alfa",blue:"Niebieski",brightness:"Jasność",green:"Zielony",hue:"Odcień",lightness:"Jaskrawość",red:"Czerwony",saturation:"Nasycenie"};var $r={};$r={alpha:"Alfa",blue:"Azul",brightness:"Brilho",green:"Verde",hue:"Matiz",lightness:"Luminosidade",red:"Vermelho",saturation:"Saturação"};var Rr={};Rr={alpha:"Alfa",blue:"Azul",brightness:"Luminosidade",green:"Verde",hue:"Tonalidade",lightness:"Claridade",red:"Vermelho",saturation:"Saturação"};var Lr={};Lr={alpha:"Alfa",blue:"Albastru",brightness:"Luminozitate",green:"Verde",hue:"Nuanță",lightness:"Luminozitate",red:"Roșu",saturation:"Saturație"};var Or={};Or={alpha:"Альфа",blue:"Синий",brightness:"Яркость",green:"Зеленый",hue:"Оттенок",lightness:"Освещенность",red:"Красный",saturation:"Насыщенность"};var qr={};qr={alpha:"Alfa",blue:"Modrá",brightness:"Jas",green:"Zelená",hue:"Odtieň",lightness:"Svetlosť",red:"Červená",saturation:"Sýtosť"};var Vr={};Vr={alpha:"Alfa",blue:"Modra",brightness:"Svetlost",green:"Zelena",hue:"Barva",lightness:"Lahkost",red:"Rdeča",saturation:"Nasičenost"};var Br={};Br={alpha:"Alfa",blue:"Plava",brightness:"Osvetljenost",green:"Zelena",hue:"Nijansa",lightness:"Osvetljenje",red:"Crvena",saturation:"Zasićenje"};var Hr={};Hr={alpha:"Alfa",blue:"Blått",brightness:"Ljusstyrka",green:"Grönt",hue:"Nyans",lightness:"Ljushet",red:"Rött",saturation:"Mättnad"};var Ur={};Ur={alpha:"Alfa",blue:"Mavi",brightness:"Parlaklık",green:"Yeşil",hue:"Ton",lightness:"Canlılık",red:"Kırmızı",saturation:"Doygunluk"};var Kr={};Kr={alpha:"Альфа",blue:"Синій",brightness:"Яскравість",green:"Зелений",hue:"Тон",lightness:"Освітленість",red:"Червоний",saturation:"Насиченість"};var Wr={};Wr={alpha:"Alpha",blue:"蓝色",brightness:"亮度",green:"绿色",hue:"色相",lightness:"明亮度",red:"红色",saturation:"饱和度"};var Gr={};Gr={alpha:"Alpha",blue:"藍色",brightness:"亮度",green:"綠色",hue:"色相",lightness:"明亮",red:"紅色",saturation:"飽和度"};hr={"ar-AE":xr,"bg-BG":pr,"cs-CZ":jr,"da-DK":fr,"de-DE":br,"el-GR":vr,"en-US":yr,"es-ES":wr,"et-EE":Sr,"fi-FI":kr,"fr-FR":Nr,"he-IL":Cr,"hr-HR":_r,"hu-HU":Ar,"it-IT":Er,"ja-JP":Ir,"ko-KR":Tr,"lt-LT":Fr,"lv-LV":Pr,"nb-NO":zr,"nl-NL":Dr,"pl-PL":Mr,"pt-BR":$r,"pt-PT":Rr,"ro-RO":Lr,"ru-RU":Or,"sk-SK":qr,"sl-SI":Vr,"sr-SP":Br,"sv-SE":Hr,"tr-TR":Ur,"uk-UA":Kr,"zh-CN":Wr,"zh-TW":Gr};const $d=new Pd(Md(hr));function ls(s){let t=Ke.parse(s)||We.parse(s)||Ge.parse(s);if(t)return t;throw new Error("Invalid color value: "+s)}class ya{toHexInt(){return this.toFormat("rgb").toHexInt()}getChannelValue(t){if(t in this)return this[t];throw new Error("Unsupported color channel: "+t)}withChannelValue(t,a){if(t in this){let n=this.clone();return n[t]=a,n}throw new Error("Unsupported color channel: "+t)}getChannelName(t,a){return $d.getStringForLocale(t,a)}getColorSpaceAxes(t){let{xChannel:a,yChannel:n}=t,i=a||this.getColorChannels().find(c=>c!==n),l=n||this.getColorChannels().find(c=>c!==i),o=this.getColorChannels().find(c=>c!==i&&c!==l);return{xChannel:i,yChannel:l,zChannel:o}}}class Ke extends ya{static parse(t){let a=[];if(/^#[\da-f]+$/i.test(t)&&[4,5,7,9].includes(t.length)){const l=(t.length<6?t.replace(/[^#]/gi,"$&$&"):t).slice(1).split("");for(;l.length>0;)a.push(parseInt(l.splice(0,2).join(""),16));a[3]=a[3]!==void 0?a[3]/255:void 0}const n=t.match(/^rgba?\((.*)\)$/);n!=null&&n[1]&&(a=n[1].split(",").map(l=>Number(l.trim())),a=a.map((l,o)=>Ye(l,0,o<3?255:1)));var i;return a.length<3?void 0:new Ke(a[0],a[1],a[2],(i=a[3])!==null&&i!==void 0?i:1)}toString(t){switch(t){case"hex":return"#"+(this.red.toString(16).padStart(2,"0")+this.green.toString(16).padStart(2,"0")+this.blue.toString(16).padStart(2,"0")).toUpperCase();case"hexa":return"#"+(this.red.toString(16).padStart(2,"0")+this.green.toString(16).padStart(2,"0")+this.blue.toString(16).padStart(2,"0")+Math.round(this.alpha*255).toString(16).padStart(2,"0")).toUpperCase();case"rgb":return`rgb(${this.red}, ${this.green}, ${this.blue})`;case"css":case"rgba":return`rgba(${this.red}, ${this.green}, ${this.blue}, ${this.alpha})`;default:return this.toFormat(t).toString(t)}}toFormat(t){switch(t){case"hex":case"hexa":case"rgb":case"rgba":return this;case"hsb":case"hsba":return this.toHSB();case"hsl":case"hsla":return this.toHSL();default:throw new Error("Unsupported color conversion: rgb -> "+t)}}toHexInt(){return this.red<<16|this.green<<8|this.blue}toHSB(){const t=this.red/255,a=this.green/255,n=this.blue/255,i=Math.min(t,a,n),l=Math.max(t,a,n),o=l-i,c=l===0?0:o/l;let d=0;if(o!==0){switch(l){case t:d=(a-n)/o+(a<n?6:0);break;case a:d=(n-t)/o+2;break;case n:d=(t-a)/o+4;break}d/=6}return new We(se(d*360,2),se(c*100,2),se(l*100,2),this.alpha)}toHSL(){const t=this.red/255,a=this.green/255,n=this.blue/255,i=Math.min(t,a,n),l=Math.max(t,a,n),o=(l+i)/2,c=l-i;let d,u;if(c===0)d=u=0;else{switch(u=c/(o<.5?l+i:2-l-i),l){case t:d=(a-n)/c+(a<n?6:0);break;case a:d=(n-t)/c+2;break;case n:d=(t-a)/c+4;break}d/=6}return new Ge(se(d*360,2),se(u*100,2),se(o*100,2),this.alpha)}clone(){return new Ke(this.red,this.green,this.blue,this.alpha)}getChannelRange(t){switch(t){case"red":case"green":case"blue":return{minValue:0,maxValue:255,step:1,pageSize:17};case"alpha":return{minValue:0,maxValue:1,step:.01,pageSize:.1};default:throw new Error("Unknown color channel: "+t)}}formatChannelValue(t,a){let n,i=this.getChannelValue(t);switch(t){case"red":case"green":case"blue":n={style:"decimal"};break;case"alpha":n={style:"percent"};break;default:throw new Error("Unknown color channel: "+t)}return new aa(a,n).format(i)}getColorSpace(){return"rgb"}getColorChannels(){return Ke.colorChannels}constructor(t,a,n,i){super(),this.red=t,this.green=a,this.blue=n,this.alpha=i}}Ke.colorChannels=["red","green","blue"];const Rd=/hsb\(([-+]?\d+(?:.\d+)?\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d+(?:.\d+)?%)\)|hsba\(([-+]?\d+(?:.\d+)?\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d(.\d+)?)\)/;class We extends ya{static parse(t){let a;if(a=t.match(Rd)){var n;const[i,l,o,c]=((n=a[1])!==null&&n!==void 0?n:a[2]).split(",").map(d=>Number(d.trim().replace("%","")));return new We(Qr(i,360),Ye(l,0,100),Ye(o,0,100),Ye(c??1,0,1))}}toString(t){switch(t){case"css":return this.toHSL().toString("css");case"hex":return this.toRGB().toString("hex");case"hexa":return this.toRGB().toString("hexa");case"hsb":return`hsb(${this.hue}, ${se(this.saturation,2)}%, ${se(this.brightness,2)}%)`;case"hsba":return`hsba(${this.hue}, ${se(this.saturation,2)}%, ${se(this.brightness,2)}%, ${this.alpha})`;default:return this.toFormat(t).toString(t)}}toFormat(t){switch(t){case"hsb":case"hsba":return this;case"hsl":case"hsla":return this.toHSL();case"rgb":case"rgba":return this.toRGB();default:throw new Error("Unsupported color conversion: hsb -> "+t)}}toHSL(){let t=this.saturation/100,a=this.brightness/100,n=a*(1-t/2);return t=n===0||n===1?0:(a-n)/Math.min(n,1-n),new Ge(se(this.hue,2),se(t*100,2),se(n*100,2),this.alpha)}toRGB(){let t=this.hue,a=this.saturation/100,n=this.brightness/100,i=(l,o=(l+t/60)%6)=>n-a*n*Math.max(Math.min(o,4-o,1),0);return new Ke(Math.round(i(5)*255),Math.round(i(3)*255),Math.round(i(1)*255),this.alpha)}clone(){return new We(this.hue,this.saturation,this.brightness,this.alpha)}getChannelRange(t){switch(t){case"hue":return{minValue:0,maxValue:360,step:1,pageSize:15};case"saturation":case"brightness":return{minValue:0,maxValue:100,step:1,pageSize:10};case"alpha":return{minValue:0,maxValue:1,step:.01,pageSize:.1};default:throw new Error("Unknown color channel: "+t)}}formatChannelValue(t,a){let n,i=this.getChannelValue(t);switch(t){case"hue":n={style:"unit",unit:"degree",unitDisplay:"narrow"};break;case"saturation":case"brightness":n={style:"percent"},i/=100;break;case"alpha":n={style:"percent"};break;default:throw new Error("Unknown color channel: "+t)}return new aa(a,n).format(i)}getColorSpace(){return"hsb"}getColorChannels(){return We.colorChannels}constructor(t,a,n,i){super(),this.hue=t,this.saturation=a,this.brightness=n,this.alpha=i}}We.colorChannels=["hue","saturation","brightness"];const Ld=/hsl\(([-+]?\d+(?:.\d+)?\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d+(?:.\d+)?%)\)|hsla\(([-+]?\d+(?:.\d+)?\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d+(?:.\d+)?%\s*,\s*[-+]?\d(.\d+)?)\)/;function Qr(s,t){return(s%t+t)%t}class Ge extends ya{static parse(t){let a;if(a=t.match(Ld)){var n;const[i,l,o,c]=((n=a[1])!==null&&n!==void 0?n:a[2]).split(",").map(d=>Number(d.trim().replace("%","")));return new Ge(Qr(i,360),Ye(l,0,100),Ye(o,0,100),Ye(c??1,0,1))}}toString(t){switch(t){case"hex":return this.toRGB().toString("hex");case"hexa":return this.toRGB().toString("hexa");case"hsl":return`hsl(${this.hue}, ${se(this.saturation,2)}%, ${se(this.lightness,2)}%)`;case"css":case"hsla":return`hsla(${this.hue}, ${se(this.saturation,2)}%, ${se(this.lightness,2)}%, ${this.alpha})`;default:return this.toFormat(t).toString(t)}}toFormat(t){switch(t){case"hsl":case"hsla":return this;case"hsb":case"hsba":return this.toHSB();case"rgb":case"rgba":return this.toRGB();default:throw new Error("Unsupported color conversion: hsl -> "+t)}}toHSB(){let t=this.saturation/100,a=this.lightness/100,n=a+t*Math.min(a,1-a);return t=n===0?0:2*(1-a/n),new We(se(this.hue,2),se(t*100,2),se(n*100,2),this.alpha)}toRGB(){let t=this.hue,a=this.saturation/100,n=this.lightness/100,i=a*Math.min(n,1-n),l=(o,c=(o+t/30)%12)=>n-i*Math.max(Math.min(c-3,9-c,1),-1);return new Ke(Math.round(l(0)*255),Math.round(l(8)*255),Math.round(l(4)*255),this.alpha)}clone(){return new Ge(this.hue,this.saturation,this.lightness,this.alpha)}getChannelRange(t){switch(t){case"hue":return{minValue:0,maxValue:360,step:1,pageSize:15};case"saturation":case"lightness":return{minValue:0,maxValue:100,step:1,pageSize:10};case"alpha":return{minValue:0,maxValue:1,step:.01,pageSize:.1};default:throw new Error("Unknown color channel: "+t)}}formatChannelValue(t,a){let n,i=this.getChannelValue(t);switch(t){case"hue":n={style:"unit",unit:"degree",unitDisplay:"narrow"};break;case"saturation":case"lightness":n={style:"percent"},i/=100;break;case"alpha":n={style:"percent"};break;default:throw new Error("Unknown color channel: "+t)}return new aa(a,n).format(i)}getColorSpace(){return"hsl"}getColorChannels(){return Ge.colorChannels}constructor(t,a,n,i){super(),this.hue=t,this.saturation=a,this.lightness=n,this.alpha=i}}Ge.colorChannels=["hue","saturation","lightness"];ls("#ffffff");ls("hsl(0, 100%, 50%)");const Od=ls("#000000"),qd=ls("#FFFFFF");Od.toHexInt();qd.toHexInt();function Ua(s){return ls(s).toString("rgb").replace("rgb(","").replace(")","").replace(/, ?/g," ")}const Vd=R(e.jsx("path",{d:"M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"}),"TuneOutlined");function Bd(){const{getValues:s,setValue:t}=N(),{themeIndex:a}=X(),n=s(`appearance.themes.all.${+a}`);return e.jsxs(z,{type:"modal",onClose:i=>{i&&s("appearance.themes.all").forEach((l,o)=>{if(l.id===i.id){t(`appearance.themes.all.${o}`,i,{shouldDirty:!0});return}if(i.default_light){t(`appearance.themes.all.${o}`,{...l,default_light:!1},{shouldDirty:!0});return}if(i.default_dark){t(`appearance.themes.all.${o}`,{...l,default_dark:!1},{shouldDirty:!0});return}})},children:[e.jsx(f,{size:"xs",variant:"outline",color:"primary",startIcon:e.jsx(Vd,{}),children:e.jsx(r,{message:"Settings"})}),e.jsx(Hd,{theme:n})]})}function Hd({theme:s}){const t=q({defaultValues:s}),{close:a,formId:n}=H();return g.useEffect(()=>{const i=t.watch((l,{name:o})=>{o==="default_light"&&l.default_light&&t.setValue("default_dark",!1),o==="default_dark"&&l.default_dark&&t.setValue("default_light",!1)});return()=>i.unsubscribe()},[t]),e.jsxs(U,{children:[e.jsx(Q,{children:e.jsx(r,{message:"Update settings"})}),e.jsx(W,{children:e.jsxs(me,{form:t,id:n,onSubmit:i=>{a(i)},children:[e.jsx(j,{name:"name",label:e.jsx(r,{message:"Name"}),className:"mb-30",autoFocus:!0}),e.jsx(A,{name:"is_dark",className:"mb-20 pb-20 border-b",description:e.jsx(r,{message:"Whether this theme has light text on dark background."}),children:e.jsx(r,{message:"Dark theme"})}),e.jsx(A,{name:"default_light",className:"mb-30",description:e.jsx(r,{message:"When light mode is selected, this theme will be used."}),children:e.jsx(r,{message:"Default for light mode"})}),e.jsx(A,{name:"default_dark",description:e.jsx(r,{message:"When dark mode is selected, this theme will be used."}),children:e.jsx(r,{message:"Default for dark mode"})})]})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:()=>{a()},children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{variant:"flat",color:"primary",type:"submit",form:n,disabled:!t.formState.isDirty,children:e.jsx(r,{message:"Save"})})]})]})}const Ud=R(e.jsx("path",{d:"M6 13c0-1.65.67-3.15 1.76-4.24L6.34 7.34C4.9 8.79 4 10.79 4 13c0 4.08 3.05 7.44 7 7.93v-2.02c-2.83-.48-5-2.94-5-5.91zm14 0c0-4.42-3.58-8-8-8-.06 0-.12.01-.18.01l1.09-1.09L11.5 2.5 8 6l3.5 3.5 1.41-1.41-1.08-1.08c.06 0 .12-.01.17-.01 3.31 0 6 2.69 6 6 0 2.97-2.17 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93z"}),"RestartAltOutlined");function Kd(){const s=Z(),{themeIndex:t}=X(),[a,n]=g.useState(!1),{setValue:i,getValues:l}=N(),{fields:o,remove:c}=pe({name:"appearance.themes.all"}),d=()=>{if(o.length<=1){P.danger(m("At least one theme is required"));return}t&&(s("/admin/appearance/themes"),c(+t),i("appearance.themes.selectedThemeId",null))};return e.jsxs(g.Fragment,{children:[e.jsxs(Pe,{onItemSelected:u=>{if(u==="delete")n(!0);else if(u==="reset"){const h=`appearance.themes.all.${+t}`,p=l(`${h}.is_dark`)?J().defaults.appearance.themes.dark:J().defaults.appearance.themes.light;Object.entries(p).forEach(([b,v])=>{J().preview.setThemeValue(b,v)}),J().preview.setThemeFont(null),i(`${h}.values`,p,{shouldDirty:!0}),i(`${h}.font`,void 0,{shouldDirty:!0})}},children:[e.jsx(_,{size:"md",className:"text-muted",children:e.jsx(Ks,{})}),e.jsxs(ze,{children:[e.jsx(x,{value:"reset",startIcon:e.jsx(Ud,{}),children:e.jsx(r,{message:"Reset colors"})}),e.jsx(x,{value:"delete",startIcon:e.jsx(ws,{}),children:e.jsx(r,{message:"Delete"})})]})]}),e.jsx(z,{type:"modal",isOpen:a,onClose:u=>{u&&d(),n(!1)},children:e.jsx(xe,{isDanger:!0,title:e.jsx(r,{message:"Delete theme"}),body:e.jsx(r,{message:"Are you sure you want to delete this theme?"}),confirm:e.jsx(r,{message:"Delete"})})})]})}function Ss(){return(Ss=Object.assign||function(s){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(s[n]=a[n])}return s}).apply(this,arguments)}function bt(s,t){if(s==null)return{};var a,n,i={},l=Object.keys(s);for(n=0;n<l.length;n++)t.indexOf(a=l[n])>=0||(i[a]=s[a]);return i}function zs(s){var t=g.useRef(s),a=g.useRef(function(n){t.current&&t.current(n)});return t.current=s,a.current}var Ds=function(s,t,a){return t===void 0&&(t=0),a===void 0&&(a=1),s>a?a:s<t?t:s},Is=function(s){return"touches"in s},Vt=function(s){return s&&s.ownerDocument.defaultView||self},Ka=function(s,t,a){var n=s.getBoundingClientRect(),i=Is(t)?function(l,o){for(var c=0;c<l.length;c++)if(l[c].identifier===o)return l[c];return l[0]}(t.touches,a):t;return{left:Ds((i.pageX-(n.left+Vt(s).pageXOffset))/n.width),top:Ds((i.pageY-(n.top+Vt(s).pageYOffset))/n.height)}},Wa=function(s){!Is(s)&&s.preventDefault()},Jr=O.memo(function(s){var t=s.onMove,a=s.onKey,n=bt(s,["onMove","onKey"]),i=g.useRef(null),l=zs(t),o=zs(a),c=g.useRef(null),d=g.useRef(!1),u=g.useMemo(function(){var v=function(y){Wa(y),(Is(y)?y.touches.length>0:y.buttons>0)&&i.current?l(Ka(i.current,y,c.current)):C(!1)},S=function(){return C(!1)};function C(y){var E=d.current,$=Vt(i.current),oe=y?$.addEventListener:$.removeEventListener;oe(E?"touchmove":"mousemove",v),oe(E?"touchend":"mouseup",S)}return[function(y){var E=y.nativeEvent,$=i.current;if($&&(Wa(E),!function(fe,re){return re&&!Is(fe)}(E,d.current)&&$)){if(Is(E)){d.current=!0;var oe=E.changedTouches||[];oe.length&&(c.current=oe[0].identifier)}$.focus(),l(Ka($,E,c.current)),C(!0)}},function(y){var E=y.which||y.keyCode;E<37||E>40||(y.preventDefault(),o({left:E===39?.05:E===37?-.05:0,top:E===40?.05:E===38?-.05:0}))},C]},[o,l]),h=u[0],p=u[1],b=u[2];return g.useEffect(function(){return b},[b]),O.createElement("div",Ss({},n,{onTouchStart:h,onMouseDown:h,className:"react-colorful__interactive",ref:i,onKeyDown:p,tabIndex:0,role:"slider"}))}),wa=function(s){return s.filter(Boolean).join(" ")},Yr=function(s){var t=s.color,a=s.left,n=s.top,i=n===void 0?.5:n,l=wa(["react-colorful__pointer",s.className]);return O.createElement("div",{className:l,style:{top:100*i+"%",left:100*a+"%"}},O.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:t}}))},ie=function(s,t,a){return t===void 0&&(t=0),a===void 0&&(a=Math.pow(10,t)),Math.round(a*s)/a},Wd=function(s){return Xd(Bt(s))},Bt=function(s){return s[0]==="#"&&(s=s.substring(1)),s.length<6?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?ie(parseInt(s[3]+s[3],16)/255,2):1}:{r:parseInt(s.substring(0,2),16),g:parseInt(s.substring(2,4),16),b:parseInt(s.substring(4,6),16),a:s.length===8?ie(parseInt(s.substring(6,8),16)/255,2):1}},Gd=function(s){return Yd(Jd(s))},Qd=function(s){var t=s.s,a=s.v,n=s.a,i=(200-t)*a/100;return{h:ie(s.h),s:ie(i>0&&i<200?t*a/100/(i<=100?i:200-i)*100:0),l:ie(i/2),a:ie(n,2)}},Ht=function(s){var t=Qd(s);return"hsl("+t.h+", "+t.s+"%, "+t.l+"%)"},Jd=function(s){var t=s.h,a=s.s,n=s.v,i=s.a;t=t/360*6,a/=100,n/=100;var l=Math.floor(t),o=n*(1-a),c=n*(1-(t-l)*a),d=n*(1-(1-t+l)*a),u=l%6;return{r:ie(255*[n,c,o,o,d,n][u]),g:ie(255*[d,n,n,c,o,o][u]),b:ie(255*[o,o,d,n,n,c][u]),a:ie(i,2)}},Ys=function(s){var t=s.toString(16);return t.length<2?"0"+t:t},Yd=function(s){var t=s.r,a=s.g,n=s.b,i=s.a,l=i<1?Ys(ie(255*i)):"";return"#"+Ys(t)+Ys(a)+Ys(n)+l},Xd=function(s){var t=s.r,a=s.g,n=s.b,i=s.a,l=Math.max(t,a,n),o=l-Math.min(t,a,n),c=o?l===t?(a-n)/o:l===a?2+(n-t)/o:4+(t-a)/o:0;return{h:ie(60*(c<0?c+6:c)),s:ie(l?o/l*100:0),v:ie(l/255*100),a:i}},Zd=O.memo(function(s){var t=s.hue,a=s.onChange,n=wa(["react-colorful__hue",s.className]);return O.createElement("div",{className:n},O.createElement(Jr,{onMove:function(i){a({h:360*i.left})},onKey:function(i){a({h:Ds(t+360*i.left,0,360)})},"aria-label":"Hue","aria-valuenow":ie(t),"aria-valuemax":"360","aria-valuemin":"0"},O.createElement(Yr,{className:"react-colorful__hue-pointer",left:t/360,color:Ht({h:t,s:100,v:100,a:1})})))}),eu=O.memo(function(s){var t=s.hsva,a=s.onChange,n={backgroundColor:Ht({h:t.h,s:100,v:100,a:1})};return O.createElement("div",{className:"react-colorful__saturation",style:n},O.createElement(Jr,{onMove:function(i){a({s:100*i.left,v:100-100*i.top})},onKey:function(i){a({s:Ds(t.s+100*i.left,0,100),v:Ds(t.v-100*i.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+ie(t.s)+"%, Brightness "+ie(t.v)+"%"},O.createElement(Yr,{className:"react-colorful__saturation-pointer",top:1-t.v/100,left:t.s/100,color:Ht(t)})))}),Xr=function(s,t){if(s===t)return!0;for(var a in s)if(s[a]!==t[a])return!1;return!0},su=function(s,t){return s.toLowerCase()===t.toLowerCase()||Xr(Bt(s),Bt(t))};function tu(s,t,a){var n=zs(a),i=g.useState(function(){return s.toHsva(t)}),l=i[0],o=i[1],c=g.useRef({color:t,hsva:l});g.useEffect(function(){if(!s.equal(t,c.current.color)){var u=s.toHsva(t);c.current={hsva:u,color:t},o(u)}},[t,s]),g.useEffect(function(){var u;Xr(l,c.current.hsva)||s.equal(u=s.fromHsva(l),c.current.color)||(c.current={hsva:l,color:u},n(u))},[l,s,n]);var d=g.useCallback(function(u){o(function(h){return Object.assign({},h,u)})},[]);return[l,d]}var au=typeof window<"u"?g.useLayoutEffect:g.useEffect,nu=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},Ga=new Map,ru=function(s){au(function(){var t=s.current?s.current.ownerDocument:document;if(t!==void 0&&!Ga.has(t)){var a=t.createElement("style");a.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,Ga.set(t,a);var n=nu();n&&a.setAttribute("nonce",n),t.head.appendChild(a)}},[])},iu=function(s){var t=s.className,a=s.colorModel,n=s.color,i=n===void 0?a.defaultColor:n,l=s.onChange,o=bt(s,["className","colorModel","color","onChange"]),c=g.useRef(null);ru(c);var d=tu(a,i,l),u=d[0],h=d[1],p=wa(["react-colorful",t]);return O.createElement("div",Ss({},o,{ref:c,className:p}),O.createElement(eu,{hsva:u,onChange:h}),O.createElement(Zd,{hue:u.h,onChange:h,className:"react-colorful__last-control"}))},lu={defaultColor:"000",toHsva:Wd,fromHsva:function(s){return Gd({h:s.h,s:s.s,v:s.v,a:1})},equal:su},ou=function(s){return O.createElement(iu,Ss({},s,{colorModel:lu}))},cu=/^#?([0-9A-F]{3,8})$/i,du=function(s){var t=s.color,a=t===void 0?"":t,n=s.onChange,i=s.onBlur,l=s.escape,o=s.validate,c=s.format,d=s.process,u=bt(s,["color","onChange","onBlur","escape","validate","format","process"]),h=g.useState(function(){return l(a)}),p=h[0],b=h[1],v=zs(n),S=zs(i),C=g.useCallback(function(E){var $=l(E.target.value);b($),o($)&&v(d?d($):$)},[l,d,o,v]),y=g.useCallback(function(E){o(E.target.value)||b(l(a)),S(E)},[a,l,o,S]);return g.useEffect(function(){b(l(a))},[a,l]),O.createElement("input",Ss({},u,{value:c?c(p):p,spellCheck:"false",onChange:C,onBlur:y}))},Qa=function(s){return"#"+s},uu=function(s){var t=s.prefixed,a=s.alpha,n=bt(s,["prefixed","alpha"]),i=g.useCallback(function(o){return o.replace(/([^0-9A-F]+)/gi,"").substring(0,a?8:6)},[a]),l=g.useCallback(function(o){return function(c,d){var u=cu.exec(c),h=u?u[1].length:0;return h===3||h===6||!!d&&h===4||!!d&&h===8}(o,a)},[a]);return O.createElement(du,Ss({},n,{escape:i,format:t?Qa:void 0,process:Qa,validate:l}))};function mu({onChange:s,value:t,colors:a}){const n=a.map(i=>{const l=t===i;return e.jsx(lt,{onClick:()=>{s==null||s(i)},className:I("relative block flex-shrink-0 w-26 h-26 border rounded",l&&"shadow-md"),style:{backgroundColor:i},children:l&&e.jsx("span",{className:"absolute inset-0 m-auto rounded-full w-8 h-8 bg-white"})},i)});return e.jsx("div",{className:"flex flex-wrap gap-6",children:n})}const gu=[{color:"rgb(255, 255, 255)",name:m("White")},{color:"rgb(239,245,245)",name:m("Solitude")},{color:"rgb(245,213,174)",name:m("Wheat")},{color:"rgb(253,227,167)",name:m("Cape Honey")},{color:"rgb(242,222,186)",name:m("Milk punch")},{color:"rgb(97,118,75)",name:m("Dingy"),foreground:"rgb(255, 255, 255)"},{color:"rgb(4, 147, 114)",name:m("Aquamarine"),foreground:"rgb(255, 255, 255)"},{color:"rgb(222,245,229)",name:m("Cosmic Latte")},{color:"rgb(233,119,119)",name:m("Geraldine"),foreground:"rgb(90,14,14)"},{color:"rgb(247,164,164)",name:m("Sundown")},{color:"rgb(30,139,195)",name:m("Pelorous"),foreground:"rgb(255, 255, 255)"},{color:"rgb(142,68,173)",name:m("Deep Lilac"),foreground:"rgb(255, 255, 255)"},{color:"rgb(108,74,182)",name:m("Blue marguerite"),foreground:"rgb(255, 255, 255)"},{color:"rgb(139,126,116)",name:m("Americano"),foreground:"rgb(255, 255, 255)"},{color:"rgb(0,0,0)",name:m("Black"),foreground:"rgb(255, 255, 255)"},{color:"rgb(64,66,88)",name:m("Blue zodiac"),foreground:"rgb(255, 255, 255)"},{color:"rgb(101,100,124)",name:m("Comet"),foreground:"rgb(255, 255, 255)"}],hu=gu.map(({color:s})=>s).slice(0,14);function xu({defaultValue:s,onChange:t,colorPresets:a,showInput:n}){const[i,l]=g.useState(s),o=a||hu,c=na({size:"sm"});return e.jsxs("div",{children:[e.jsx(ou,{className:"!w-auto",color:i,onChange:d=>{t==null||t(d),l(d)}}),e.jsxs("div",{className:"py-20 px-12",children:[o&&e.jsx(mu,{colors:o,onChange:d=>{if(d){const u=ls(d).toString("hex");t==null||t(u),l(u)}},value:i}),n&&e.jsx("div",{className:"pt-20",children:e.jsx(uu,{autoComplete:"off",role:"textbox",autoCorrect:"off",spellCheck:"false",required:!0,"aria-label":"Hex color",prefixed:!0,className:c.input,color:i,onChange:d=>{t==null||t(d),l(d)}})})]})]})}function Zr({hideFooter:s=!1,showInput:t=!0}){const{close:a,value:n,setValue:i,initialValue:l}=H();return e.jsxs(U,{size:"2xs",children:[e.jsx(xu,{showInput:t,defaultValue:l||"",onChange:o=>i(o)}),!s&&e.jsxs(ae,{dividerTop:!0,children:[e.jsx(f,{variant:"text",size:"xs",onClick:()=>a(),children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{variant:"flat",color:"primary",size:"xs",onClick:()=>a(n),children:e.jsx(r,{message:"Apply"})})]})]})}const Ja=[{label:m("Accent"),value:"primary",bgColor:"bg-primary",previewBgColor:"text-primary"},{label:m("Background"),value:"bg",bgColor:"bg-background",previewBgColor:"text-background"},{label:m("Background alt"),value:"bg-alt",bgColor:"bg-alt",previewBgColor:"text-background-alt"},{label:m("Transparent"),value:"transparent",bgColor:"bg-transparent",previewBgColor:"text-transparent"}];function pu(){var o;const{themeIndex:s}=X(),{watch:t,setValue:a}=N(),n=`appearance.themes.all.${s}.values.--be-navbar-color`,i=t(n),l=(o=Ja.find(({value:c})=>c===i))==null?void 0:o.previewBgColor;return e.jsxs(Pe,{placement:"right",selectionMode:"single",selectedValue:i,onSelectionChange:c=>{a(n,c,{shouldDirty:!0})},children:[e.jsx(Ee,{startIcon:e.jsx(gr,{viewBox:"0 0 48 48",className:I("icon-lg",l)}),children:e.jsx(r,{message:"Navbar"})}),e.jsx(ze,{children:Ja.map(({label:c,value:d,bgColor:u})=>e.jsx(x,{value:d,startIcon:e.jsx("div",{className:I("h-20 w-20 rounded border",u)}),children:e.jsx(r,{...c})},d))})]})}function Ut(s){try{return ls(`rgb(${s.split(" ").join(",")})`).toString("hex")}catch{return s}}const ju=[{label:m("Background"),key:"--be-background"},{label:m("Background alt"),key:"--be-background-alt"},{label:m("Foreground"),key:"--be-foreground-base"},{label:m("Accent light"),key:"--be-primary-light"},{label:m("Accent"),key:"--be-primary"},{label:m("Accent dark"),key:"--be-primary-dark"},{label:m("Text on accent"),key:"--be-on-primary"},{label:m("Chip"),key:"--be-background-chip"}];function fu(){const s=Ze(),{themeIndex:t}=X(),{getValues:a,watch:n}=N(),i=a(`appearance.themes.all.${+t}`),l=n(`appearance.themes.all.${+t}.font.family`);return g.useEffect(()=>{i||s("/admin/appearance/themes")},[s,i]),g.useEffect(()=>{i!=null&&i.id&&J().preview.setActiveTheme(i.id)},[i==null?void 0:i.id]),i?e.jsxs(g.Fragment,{children:[e.jsxs("div",{className:"mb-20 flex items-center justify-between gap-10",children:[e.jsx(Bd,{}),e.jsx(Kd,{})]}),e.jsxs("div",{children:[e.jsx(Ee,{elementType:D,to:"font",description:l||e.jsx(r,{message:"System"}),children:e.jsx(r,{message:"Font"})}),e.jsx(Ee,{elementType:D,to:"radius",children:e.jsx(r,{message:"Rounding"})}),e.jsx("div",{className:"mb-6 mt-22 text-sm font-semibold",children:e.jsx(r,{message:"Colors"})}),e.jsx(pu,{}),ju.map(o=>e.jsx(bu,{colorName:o.key,label:e.jsx(r,{...o.label}),initialThemeValue:i.values[o.key],theme:i},o.key))]})]}):null}function bu({label:s,theme:t,colorName:a,initialThemeValue:n}){const{setValue:i}=N(),{themeIndex:l}=X(),[o,c]=g.useState(n),d=u=>{c(u),J().preview.setThemeValue(a,u)};return g.useEffect(()=>{c(n)},[n]),e.jsxs(z,{value:Ut(o),type:"popover",placement:"right",offset:10,onValueChange:u=>{d(Ua(u))},onClose:(u,{valueChanged:h,initialValue:p})=>{u&&h?(i(`appearance.themes.all.${+l}.values.${a}`,Ua(u),{shouldDirty:!0}),i("appearance.themes.selectedThemeId",t.id)):d(p)},children:[e.jsx(Ee,{className:"capitalize",startIcon:e.jsx(gr,{viewBox:"0 0 48 48",className:"icon-lg",style:{fill:`rgb(${o})`}}),children:s}),e.jsx(Zr,{})]})}function le({children:s,name:t,separatorBottom:a=!0,separatorTop:n=!0}){const{formState:{errors:i}}=N(),l=g.useRef(null),o=i[t];return g.useEffect(()=>{var c;o&&((c=l.current)==null||c.scrollIntoView({behavior:"smooth"}))},[o]),e.jsxs("div",{className:I(a&&"border-b mb-20 pb-20",n&&"border-t mt-20 pt-20",o&&"border-y-error"),ref:l,children:[s(!!o),o&&e.jsx("div",{className:"text-danger text-sm mt-20",dangerouslySetInnerHTML:{__html:o.message}})]})}function vu(){return ne({queryKey:["search-models"],queryFn:()=>yu()})}function yu(){return w.get("admin/search/models").then(s=>s.data)}function wu(){const{trans:s}=T();return F({mutationFn:t=>Su(t),onSuccess:()=>{P(s(m("Imported search models")))},onError:t=>B(t)})}function Su(s){return w.post("admin/search/import",s).then(t=>t.data)}function ku(){return e.jsxs(ge,{title:e.jsx(r,{message:"Search"}),description:e.jsx(r,{message:"Configure search method used on the site as well as related 3rd party integrations."}),children:[e.jsx(Nu,{}),e.jsx(Iu,{})]})}function Nu(){const{watch:s}=N(),t=s("server.scout_driver");return e.jsx(le,{name:"search_group",separatorBottom:!1,children:a=>e.jsxs(g.Fragment,{children:[e.jsxs(M,{invalid:a,name:"server.scout_driver",selectionMode:"single",label:e.jsx(r,{message:"Search method"}),description:e.jsx(r,{message:"Which method should be used for search related functionality across the site."}),children:[e.jsx(x,{value:"mysql",children:"Mysql"}),e.jsx(x,{value:"meilisearch",children:"Meilisearch"}),e.jsx(x,{value:"tntsearch",children:"TNTSearch"}),e.jsx(x,{value:"Matchish\\ScoutElasticSearch\\Engines\\ElasticSearchEngine",children:"Elasticsearch"}),e.jsx(x,{value:"algolia",children:"Algolia"})]}),t==="mysql"&&e.jsx(Cu,{}),t==="meilisearch"&&e.jsx(_u,{}),t==="algolia"&&e.jsx(Eu,{}),t==="Matchish\\ScoutElasticSearch\\Engines\\ElasticSearchEngine"&&e.jsx(Au,{})]})})}function Cu(){const{clearErrors:s}=N();return e.jsxs(M,{className:"mt-24",name:"server.scout_mysql_mode",selectionMode:"single",label:e.jsx(r,{message:"MySQL mode"}),onSelectionChange:()=>{s()},children:[e.jsx(x,{value:"basic",children:e.jsx(r,{message:"Basic"})}),e.jsx(x,{value:"extended",children:e.jsx(r,{message:"Extended"})}),e.jsx(x,{value:"fulltext",children:e.jsx(r,{message:"Fulltext"})})]})}function _u(){return e.jsx(ve,{className:"mt-24",color:"warning",title:e.jsx(r,{message:"Important!"}),description:e.jsx(r,{message:"<a>Meilisearch</a> needs to be installed and running for this method to work.",values:{a:s=>e.jsx("a",{href:"https://www.meilisearch.com",target:"_blank",rel:"noreferrer",children:s})}})})}function Au(){return e.jsx(ve,{className:"mt-24",color:"warning",title:e.jsx(r,{message:"Important!"}),description:e.jsx(r,{message:"<a>Elasticsearch</a> needs to be installed and running for this method to work.",values:{a:s=>e.jsx("a",{href:"https://www.elastic.co",target:"_blank",rel:"noreferrer",children:s})}})})}function Eu(){return e.jsxs(g.Fragment,{children:[e.jsx(j,{className:"mt-24",name:"server.algolia_app_id",label:e.jsx(r,{message:"Algolia app ID"}),required:!0}),e.jsx(j,{className:"mt-24",name:"server.algolia_secret",label:e.jsx(r,{message:"Algolia app secret"}),required:!0})]})}function Iu(){const{getValues:s}=N(),{data:t}=vu(),a=wu(),[n,i]=g.useState("*");return e.jsx(ve,{className:"mt-34",color:"neutral",title:e.jsx(r,{message:"Import records"}),description:e.jsxs("span",{children:[e.jsx(r,{message:"Whenever a new search method is enabled, records that already exist in database need to be imported into the index. All records created after search method is enabled will be imported automatically."}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(r,{message:"Depending on number of records in database, importing could take some time. Don't close this window while it is in progress."})]}),actions:e.jsxs("div",{className:"mt-10 border-t pt-14",children:[e.jsxs(ys,{selectionMode:"single",label:e.jsx(r,{message:"What to import?"}),selectedValue:n,onSelectionChange:l=>{i(l)},children:[e.jsx(x,{value:"*",children:e.jsx(r,{message:"Everything"})}),t==null?void 0:t.models.map(l=>e.jsx(x,{value:l.model,children:e.jsx(r,{message:l.name})},l.model))]}),e.jsx(f,{variant:"flat",color:"primary",className:"mb-8 mt-24",disabled:a.isPending,onClick:()=>{a.mutate({model:n,driver:s("server.scout_driver")})},children:e.jsx(r,{message:"Import now"})})]})})}function Tu(){const{trans:s}=T();return F({mutationFn:()=>Fu(),onSuccess:()=>{P(s(m("Envato items imported")))},onError:t=>B(t)})}function Fu(){return w.post("envato/items/import").then(s=>s.data)}function Pu(){return e.jsxs(ge,{title:e.jsx(r,{message:"Envato"}),description:e.jsx(r,{message:"Manage envato integration related configuration or disable it completely."}),children:[e.jsx(A,{name:"client.envato.enable",className:"mb-24",description:e.jsx(r,{message:"Enable envato integration (social login, purchase code validation, sales reports and more)."}),children:e.jsx(r,{message:"Envato integration"})}),e.jsx(A,{name:"client.envato.require_purchase_code",className:"mb-24",description:e.jsx(r,{message:`Require users to enter a valid purchase code in order to register and submit support requests.
      Envato social login will also check for purchase code automatically when this is enabled.`}),children:e.jsx(r,{message:"Envato purchase code"})}),e.jsx(A,{name:"client.envato.active_support",className:"mb-24",description:e.jsx(r,{message:"Require users to have active support for item on envato in order to be able to create tickets."}),children:e.jsx(r,{message:"Envato active support"})}),e.jsx(A,{name:"client.envato.filter_search",className:"mb-24",description:e.jsx(r,{message:"Users will only be able to find articles for items that they have purchased."}),children:e.jsx(r,{message:"Filter help center search"})}),e.jsx(zu,{})]})}function zu(){const s=Tu();return e.jsx(ve,{className:"mt-34",color:"neutral",title:e.jsx(r,{message:"Import envato items"}),description:e.jsx(r,{message:`This will automatically import all your envato items for use as categories in new ticket and
      ticket list pages.`}),actions:e.jsx("div",{className:"mt-10 border-t pt-14",children:e.jsx(f,{variant:"flat",color:"primary",disabled:s.isPending,size:"xs",onClick:()=>{s.mutate()},children:e.jsx(r,{message:"Import now"})})})})}function Du(){const{trans:s}=T();return F({mutationFn:t=>Mu(t),onSuccess:()=>{P(s(m("Help center data imported")))},onError:t=>B(t)})}function Mu(s){const t=new FormData;return t.append("file",s.file.native),w.post("hc/actions/import",t).then(a=>a.data)}const $u=R([e.jsx("path",{d:"m2.53 19.65 1.34.56v-9.03l-2.43 5.86c-.41 1.02.08 2.19 1.09 2.61zm19.5-3.7L17.07 3.98c-.31-.75-1.04-1.21-1.81-1.23-.26 0-.53.04-.79.15L7.1 5.95c-.75.31-1.21 1.03-1.23 1.8-.01.27.04.54.15.8l4.96 11.97c.31.76 1.05 1.22 1.83 1.23.26 0 .52-.05.77-.15l7.36-3.05c1.02-.42 1.51-1.59 1.09-2.6zm-9.2 3.8L7.87 7.79l7.35-3.04h.01l4.95 11.95-7.35 3.05z"},"0"),e.jsx("circle",{cx:"11",cy:"9",r:"1"},"1"),e.jsx("path",{d:"M5.88 19.75c0 1.1.9 2 2 2h1.45l-3.45-8.34v6.34z"},"2")],"StyleOutlined");function Ru(){return e.jsxs(ge,{title:e.jsx(r,{message:"Help center"}),description:e.jsxs("div",{children:[e.jsx(r,{message:"Configure help center settings and import/export help center data."}),e.jsxs("div",{className:"mt-14 flex items-center gap-8",children:[e.jsx($u,{size:"sm",className:"text-primary"}),e.jsx(D,{to:"/admin/appearance/landing-page",className:Hs,target:"_blank",children:e.jsx(r,{message:"Edit help center appearance"})})]})]}),children:[e.jsxs(M,{label:e.jsx(r,{message:"Default article order"}),name:"client.articles.default_order",className:"mb-24",selectionMode:"single",description:e.jsx(r,{message:"In what way should help center articles be ordered by default."}),children:[e.jsx(x,{value:"position|desc",children:e.jsx(r,{message:"Position"})}),e.jsx(x,{value:"views|desc",children:e.jsx(r,{message:"Most viewed first"})}),e.jsx(x,{value:"was_helpful|desc",children:e.jsx(r,{message:"Most helpful first"})}),e.jsx(x,{value:"created_at|desc",children:e.jsx(r,{message:"Newest first"})}),e.jsx(x,{value:"title|asc",children:e.jsx(r,{message:"A to Z"})})]}),e.jsx(A,{name:"client.article.hide_new_ticket_link",className:"mb-24",description:e.jsx(r,{message:'Whether "Submit a Request" link on article pages should be hidden.'}),children:e.jsx(r,{message:"Hide new ticket link"})}),e.jsxs(M,{label:e.jsx(r,{message:"Default after reply action"}),name:"client.replies.after_reply_action",selectionMode:"single",children:[e.jsx(x,{value:"stay_on_page",children:e.jsx(r,{message:"Stay on page"})}),e.jsx(x,{value:"next_active_ticket",children:e.jsx(r,{message:"Open next active ticket"})}),e.jsx(x,{value:"back_to_folder",children:e.jsx(r,{message:"Go back to ticket list"})})]}),e.jsx(A,{name:"client.mail.simplified_threading",className:"mt-24",description:e.jsx(r,{message:"Removes full ticket thread from email respones, unless it's the initial agent response."}),children:e.jsx(r,{message:"Simplified threading"})}),e.jsx(Lu,{})]})}function Lu(){return e.jsx(ve,{className:"mt-34",color:"neutral",title:e.jsx(r,{message:"Help center data"}),description:e.jsx(r,{message:"Import and export help center data (articles, categories, images, tags) in a .zip file for backup or migration."}),actions:e.jsxs("div",{className:"mt-10 border-t pt-14",children:[e.jsx(Ou,{}),e.jsx(qu,{})]})})}function Ou(){const s=Du();return e.jsxs(z,{type:"modal",children:[e.jsx(f,{variant:"flat",color:"primary",size:"xs",className:"mr-10",children:e.jsx(r,{message:"Import"})}),({close:t})=>e.jsx(xe,{isDanger:!0,title:e.jsx(r,{message:"Import help center data"}),body:e.jsxs("div",{children:[e.jsx(r,{message:"Are you sure you want to import help center data?"}),e.jsx("div",{className:"mt-8 font-bold",children:e.jsx(r,{message:"This will erase all existing articles and categories."})})]}),confirm:e.jsx(r,{message:"Import"}),isLoading:s.isPending,onConfirm:async()=>{const a=await mt({extensions:["zip"]});s.mutate({file:a[0]},{onSuccess:()=>t()})}})]})}function qu(){const{base_url:s}=Y(),t=a=>{const n=`${s}/api/v1/hc/actions/export?format=${a}`;Ws(n,"hc-export.json")};return e.jsxs(Pe,{onItemSelected:a=>{t(a)},children:[e.jsx(f,{variant:"flat",color:"primary",size:"xs",children:e.jsx(r,{message:"Export"})}),e.jsxs(ze,{children:[e.jsx(x,{value:"html",children:e.jsx(r,{message:"HTML (Offline docs)"})}),e.jsx(x,{value:"json",children:e.jsx(r,{message:"JSON"})})]})]})}function Ya({connection:s}){const t=q({defaultValues:s||{id:vs(6).toLowerCase(),createTickets:!0,createReplies:!0}}),{formId:a,close:n}=H();return e.jsxs(U,{children:[e.jsx(Q,{children:s?e.jsx(r,{message:"Edit connection"}):e.jsx(r,{message:"New connection"})}),e.jsx(W,{children:e.jsxs(me,{form:t,id:a,onSubmit:i=>n(i),children:[e.jsx(j,{autoFocus:!0,required:!0,name:"name",label:e.jsx(r,{message:"Name"}),className:"mb-14"}),e.jsx(j,{required:!0,name:"host",placeholder:"imap.gmail.com",label:e.jsx(r,{message:"Host"}),className:"mb-14"}),e.jsx(j,{required:!0,name:"username",placeholder:"username@gmail.com",type:"email",label:e.jsx(r,{message:"Username"}),className:"mb-14"}),e.jsx(j,{required:!0,type:"password",name:"password",label:e.jsx(r,{message:"Password"}),className:"mb-14"}),e.jsx(j,{name:"port",type:"number",label:e.jsx(r,{message:"Port"}),placeholder:"993",className:"mb-14"}),e.jsx(j,{name:"folder",label:e.jsx(r,{message:"Folder"}),className:"mb-14",description:e.jsx(r,{message:"From which folder emails should be imported. Leave empty to import all emails in the inbox."})}),e.jsx(A,{name:"createTickets",className:"mb-14 mt-28",description:e.jsx(r,{message:"Create new tickets from emails received via this connection."}),children:e.jsx(r,{message:"Create new tickets"})}),e.jsx(A,{name:"createReplies",description:e.jsx(r,{message:"If email is in reply to existing ticket, create a new reply."}),children:e.jsx(r,{message:"Create replies"})})]})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:()=>n(),children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{type:"submit",form:a,variant:"flat",color:"primary",children:e.jsx(r,{message:"Save"})})]})]})}const Xa=R([e.jsx("path",{fill:"#4caf50",d:"M45,16.2l-5,2.75l-5,4.75L35,40h7c1.657,0,3-1.343,3-3V16.2z"},"0"),e.jsx("path",{fill:"#1e88e5",d:"M3,16.2l3.614,1.71L13,23.7V40H6c-1.657,0-3-1.343-3-3V16.2z"},"1"),e.jsx("polygon",{fill:"#e53935",points:"35,11.2 24,19.45 13,11.2 12,17 13,23.7 24,31.95 35,23.7 36,17"},"2"),e.jsx("path",{fill:"#c62828",d:"M3,12.298V16.2l10,7.5V11.2L9.876,8.859C9.132,8.301,8.228,8,7.298,8h0C4.924,8,3,9.924,3,12.298z"},"3"),e.jsx("path",{fill:"#fbc02d",d:"M45,12.298V16.2l-10,7.5V11.2l3.124-2.341C38.868,8.301,39.772,8,40.702,8h0 C43.076,8,45,9.924,45,12.298z"},"4")],"Gmail","0 0 48 48");function ei(){const{watch:s,setValue:t}=N(),{connectSocial:a}=ol(),n=s("server.connectedGmailAccount"),i=async()=>{const c=await a("secure/settings/mail/gmail/connect");if((c==null?void 0:c.status)==="SUCCESS"){const d=c.callbackData.profile.email;t("server.connectedGmailAccount",d),P(m("Connected gmail account: :email",{values:{email:d}}))}},l=e.jsx(f,{variant:"outline",color:"primary",startIcon:e.jsx(Xa,{}),onClick:()=>{i()},children:e.jsx(r,{message:"Connect gmail account"})}),o=e.jsxs("div",{className:"flex items-center gap-14 rounded border bg-alt px-14 py-6 text-sm",children:[e.jsx(Xa,{size:"lg"}),n,e.jsx(f,{variant:"text",color:"primary",className:"ml-auto",onClick:()=>{i()},children:e.jsx(r,{message:"Reconnect"})})]});return e.jsxs(g.Fragment,{children:[e.jsx("div",{className:"mb-6 text-sm",children:e.jsx(r,{message:"Gmail account"})}),n?o:l]})}function Vu(){return e.jsxs(ge,{title:e.jsx(r,{message:"Authentication"}),description:e.jsx(r,{message:"Configure registration, social login and related 3rd party integrations."}),children:[e.jsx(Bu,{}),e.jsx(A,{className:"mb-24",name:"client.registration.disable",description:e.jsx(r,{message:"All registration related functionality (including social login) will be disabled."}),children:e.jsx(r,{message:"Disable registration"})}),e.jsx(A,{className:"mb-24",name:"client.single_device_login",description:e.jsx(r,{message:"Only allow one device to be logged into user account at the same time."}),children:e.jsx(r,{message:"Single device login"})}),e.jsx(A,{name:"client.social.compact_buttons",description:e.jsx(r,{message:"Use compact design for social login buttons."}),children:e.jsx(r,{message:"Compact buttons"})}),e.jsx(Hu,{}),e.jsx(Uu,{}),e.jsx(Ku,{}),e.jsx(Wu,{}),e.jsx(Re,{}),e.jsx(j,{inputElementType:"textarea",rows:3,className:"mt-24",name:"client.auth.domain_blacklist",label:e.jsx(r,{message:"Domain blacklist"}),description:e.jsx(r,{message:"Comma separated list of domains. Users will not be able to register or login using any email adress from specified domains."})})]})}function si(){const{watch:s}=N();return s("server.mail_setup")?null:e.jsx("p",{className:"mt-10 rounded-panel border p-10 text-sm text-danger",children:e.jsx(r,{message:"Outgoing mail method needs to be setup before enabling this setting. <a>Fix now</a>",values:{a:a=>e.jsx(f,{elementType:D,variant:"outline",size:"xs",display:"flex",className:"mt-10 max-w-max",to:"/admin/settings/outgoing-email",children:a})}})})}function Bu(){return e.jsx(A,{className:"mb-30",name:"client.require_email_confirmation",description:e.jsxs(g.Fragment,{children:[e.jsx(r,{message:"Require newly registered users to validate their email address before being able to login."}),e.jsx(si,{})]}),children:e.jsx(r,{message:"Require email confirmation"})})}function Hu(){var n;const{watch:s}=N(),t=Y(),a=s("client.social.envato.enable");return(n=t.envato)!=null&&n.enable?e.jsx(le,{separatorBottom:!1,name:"envato_group",children:i=>e.jsxs(e.Fragment,{children:[e.jsx(A,{invalid:i,name:"client.social.envato.enable",description:e.jsx(r,{message:"Enable logging into the site via envato."}),children:e.jsx(r,{message:"Envato login"})}),!!a&&e.jsxs(e.Fragment,{children:[e.jsx(j,{invalid:i,className:"mt-30",name:"server.envato_id",label:e.jsx(r,{message:"Envato ID"}),required:!0}),e.jsx(j,{invalid:i,className:"mt-30",name:"server.envato_secret",label:e.jsx(r,{message:"Envato secret"}),required:!0}),e.jsx(j,{invalid:i,className:"mt-30",name:"server.envato_personal_token",label:e.jsx(r,{message:"Envato personal token"}),required:!0})]})]})}):null}function Uu(){const{watch:s}=N(),t=s("client.social.google.enable");return e.jsx(le,{name:"google_group",children:a=>e.jsxs(e.Fragment,{children:[e.jsx(A,{invalid:a,name:"client.social.google.enable",description:e.jsx(r,{message:"Enable logging into the site via google."}),children:e.jsx(r,{message:"Google login"})}),!!t&&e.jsxs(e.Fragment,{children:[e.jsx(j,{invalid:a,className:"mt-30",name:"server.google_id",label:e.jsx(r,{message:"Google client ID"}),required:!0}),e.jsx(j,{className:"mt-30",name:"server.google_secret",label:e.jsx(r,{message:"Google client secret"}),required:!0})]})]})})}function Ku(){const{watch:s}=N(),t=s("client.social.facebook.enable");return e.jsx(le,{name:"facebook_group",separatorTop:!1,children:a=>e.jsxs(e.Fragment,{children:[e.jsx(A,{invalid:a,name:"client.social.facebook.enable",description:e.jsx(r,{message:"Enable logging into the site via facebook."}),children:e.jsx(r,{message:"Facebook login"})}),!!t&&e.jsxs(e.Fragment,{children:[e.jsx(j,{invalid:a,className:"mt-30",name:"server.facebook_id",label:e.jsx(r,{message:"Facebook app ID"}),required:!0}),e.jsx(j,{invalid:a,className:"mt-30",name:"server.facebook_secret",label:e.jsx(r,{message:"Facebook app secret"}),required:!0})]})]})})}function Wu(){const{watch:s}=N(),t=s("client.social.twitter.enable");return e.jsx(le,{name:"twitter_group",separatorTop:!1,separatorBottom:!1,children:a=>e.jsxs(e.Fragment,{children:[e.jsx(A,{invalid:a,name:"client.social.twitter.enable",description:e.jsx(r,{message:"Enable logging into the site via twitter."}),children:e.jsx(r,{message:"Twitter login"})}),!!t&&e.jsxs(e.Fragment,{children:[e.jsx(j,{invalid:a,className:"mt-30",name:"server.twitter_id",label:e.jsx(r,{message:"Twitter ID"}),required:!0}),e.jsx(j,{invalid:a,className:"mt-30",name:"server.twitter_secret",label:e.jsx(r,{message:"Twitter secret"}),required:!0})]})]})})}const Gu=s=>{var t,a;return(t=s.client)!=null&&t.incoming_email&&dl(s.client.incoming_email,{copy:!1,arrays:!0,deep:!0}),(a=s.client)!=null&&a.incoming_email&&Object.keys(s.client.incoming_email).length===0&&delete s.client.incoming_email,s};function Qu(){const{branding:{site_name:s}}=Y(),[t,a]=jn("incoming-email-settings-expanded",[0,1,2]);return e.jsxs(ge,{title:e.jsx(r,{message:"Incoming email"}),transformValues:Gu,description:e.jsxs(g.Fragment,{children:[e.jsx(r,{message:"Configure different handlers for turning incoming emails into tickets and replies. You can enable multiple handlers at the same time.",values:{site:s}}),e.jsx(Ve,{className:"mt-6 text-sm",link:"https://support.vebto.com/hc/articles/42/44/155/incoming-emails"})]}),children:[e.jsx(A,{name:"client.tickets.create_from_emails",className:"mb-24",description:e.jsx(r,{message:"If email can't be matched to existing ticket, create a new ticket from it."}),children:e.jsx(r,{message:"New ticket from emails"})}),e.jsx(A,{name:"client.replies.create_from_emails",className:"mb-24",description:e.jsx(r,{message:"If email can be matched to existing ticket, create a new reply for that ticket from the email."}),children:e.jsx(r,{message:"Replies from emails"})}),e.jsx(A,{name:"client.tickets.send_ticket_created_notification",className:"mb-24",description:e.jsx(r,{message:"Send a notification to customer via email informing them that their ticket has been received."}),children:e.jsx(r,{message:"Ticket received notification"})}),e.jsx(sm,{}),e.jsx(tm,{}),e.jsx(j,{name:"server.openai_api_key",className:"mb-24",label:e.jsx(r,{message:"OpenAI API key"}),labelSuffix:e.jsx(Fs,{body:e.jsx(r,{message:"OpenAI API key is used to extract only relevant content from raw email. It will remove previous emails quoted by clients like gmail or outlook as well as signatures added by iPhone and other devices. :br This can be done by BeDesk without the API key, but it will be more consistent when using AI.",values:{br:e.jsxs(g.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{})]})}})}),labelSuffixPosition:"inline"}),e.jsxs(ns,{variant:"outline",mode:"multiple",expandedValues:t,onExpandedChange:n=>a(n),children:[e.jsx(be,{label:e.jsx(r,{message:"IMAP"}),children:e.jsx(em,{})}),e.jsx(be,{label:e.jsx(r,{message:"Pipe"}),children:e.jsx(Zu,{})}),e.jsx(be,{label:e.jsx(r,{message:"Rest API"}),children:e.jsx(Ju,{})}),e.jsx(be,{label:e.jsx(r,{message:"Gmail API"}),children:e.jsx(Xu,{})}),e.jsx(be,{label:e.jsx(r,{message:"Mailgun"}),children:e.jsx(Yu,{})})]})]})}function Ju(){const{base_url:s,branding:{site_name:t}}=Y();return e.jsxs("div",{children:[e.jsx(A,{name:"client.incoming_email.api.enabled",children:e.jsx(r,{message:"Enabled"})}),e.jsx("p",{className:"mt-10 text-xs text-muted",children:e.jsx(r,{message:"Send emails to :siteName from a 3rd party application or a different website using REST API.",values:{siteName:t}})}),e.jsx(Ve,{className:"mt-12 text-sm",link:`${s}/api-docs#Tickets-incomingEmail`})]})}function Yu(){const{branding:{site_name:s}}=Y();return e.jsxs("div",{children:[e.jsx(A,{name:"client.incoming_email.mailgun.enabled",children:e.jsx(r,{message:"Enabled"})}),e.jsx("p",{className:"mt-10 text-xs text-muted",children:e.jsx(r,{message:"Send emails to :siteName using Mailgun inbound routes functionality.",values:{siteName:s}})}),e.jsx(j,{size:"sm",className:"mt-20",name:"server.mailgun_secret",label:e.jsx(r,{message:"Mailgun API key"})}),e.jsx(A,{className:"mt-14",name:"client.incoming_email.mailgun.verify",description:e.jsx(r,{message:"Verify that incoming request is really from mailgun. It's highly recommended to have this on, unless you are not able to receive emails from mailgun otherwise."}),children:e.jsx(r,{message:"Verify"})}),e.jsx(Ve,{className:"mt-12 text-sm",link:"https://support.vebto.com/hc/articles/42/44/155/incoming-emails#mailgun"})]})}function Xu(){const{branding:{site_name:s}}=Y(),{watch:t}=N(),a=t("client.incoming_email.gmail.enabled");return e.jsx(le,{name:"gmail_group",separatorBottom:!1,separatorTop:!1,children:n=>e.jsxs(g.Fragment,{children:[e.jsx(A,{name:"client.incoming_email.gmail.enabled",invalid:n,children:e.jsx(r,{message:"Enabled"})}),e.jsx("p",{className:"mt-10 text-xs text-muted",children:e.jsx(r,{message:"Connect your existing gmail acocunt using gmail API.",values:{siteName:s}})}),e.jsx(j,{invalid:n,name:"client.incoming_email.gmail.topicName",minLength:10,required:a,label:e.jsx(r,{message:"Gmail topic name"}),description:e.jsx(r,{message:"Google cloud Pub/Sub topic name."}),className:"my-20",size:"sm"}),e.jsx(ei,{})]})})}function Zu(){const{branding:{site_name:s}}=Y();return e.jsxs("div",{children:[e.jsx(A,{name:"client.incoming_email.pipe.enabled",children:e.jsx(r,{message:"Enabled"})}),e.jsx("p",{className:"mt-10 text-xs text-muted",children:e.jsx(r,{message:"Pipe emails to :siteName from cpanel or another control panel used by your hosting provider.",values:{siteName:s}})}),e.jsx(Ve,{className:"mt-12 text-sm",link:"https://support.vebto.com/hc/articles/42/44/155/incoming-emails#piping"})]})}function em(){const{branding:{site_name:s}}=Y(),{fields:t,append:a,remove:n,update:i}=pe({name:"client.incoming_email.imap.connections",keyName:"key"});return e.jsx(le,{name:"imap_group",separatorBottom:!1,separatorTop:!1,children:l=>e.jsxs(g.Fragment,{children:[e.jsx("p",{className:"mb-10 text-xs text-muted",children:e.jsx(r,{message:"Connect your existing email accounts to :siteName using IMAP.",values:{siteName:s}})}),e.jsx("div",{className:"mb-20 space-y-14",children:t.map((o,c)=>e.jsxs("div",{className:I("flex items-center",l&&"text-danger"),children:[e.jsxs("div",{className:"mr-auto",children:[e.jsx("div",{children:o.name}),e.jsx("div",{className:"text-xs text-muted",children:o.username})]}),e.jsxs(z,{type:"modal",onClose:d=>{d&&i(c,d)},children:[e.jsx(de,{label:e.jsx(r,{message:"Edit"}),children:e.jsx(_,{size:"sm",className:"text-muted",children:e.jsx(cl,{})})}),e.jsx(Ya,{connection:o})]}),e.jsx(de,{label:e.jsx(r,{message:"Delete"}),children:e.jsx(_,{size:"sm",className:"text-muted",onClick:()=>n(c),children:e.jsx(ws,{})})})]},o.key))}),e.jsxs(z,{type:"modal",onClose:o=>{o&&a(o)},children:[e.jsx(f,{variant:"outline",color:"primary",startIcon:e.jsx(Ce,{}),size:"xs",children:e.jsx(r,{message:"Add connection"})}),e.jsx(Ya,{})]}),e.jsx(Ve,{className:"mt-20 text-sm",link:"https://support.vebto.com/hc/articles/42/44/155/incoming-emails#imap"})]})})}function sm(){const{watch:s}=N();return s("client.tickets.create_from_emails")?null:e.jsx(A,{name:"client.tickets.send_ticket_rejected_notification",className:"mb-24",description:e.jsx(r,{message:"Send a notification to customer, if their ticket has not been created, because ticket creation via email is disabled."}),children:e.jsx(r,{message:"Ticket rejected notification"})})}function tm(){const{watch:s}=N();return e.jsx(A,{name:"client.replies.send_email",className:"mb-24",disabled:!s("server.mail_setup"),description:e.jsxs(g.Fragment,{children:[e.jsx(r,{message:"When agent replies to ticket, send email to customer who created the ticket."}),e.jsx(si,{})]}),children:e.jsx(r,{message:"Send replies via email"})})}const am=[{path:"search",element:e.jsx(ku,{})},{path:"envato",element:e.jsx(Pu,{})},{path:"hc",element:e.jsx(Ru,{})},{path:"incoming-email",element:e.jsx(Qu,{})}];function Kt({children:s,...t}){const{field:{onChange:a,onBlur:n,value:i=[],ref:l},fieldState:{invalid:o,error:c}}=Bs({name:t.name}),d=g.useMemo(()=>{const h=i;return typeof h=="string"?JSON.parse(h):h},[i]),u={onChange:h=>{const p=JSON.stringify(h.map(b=>b.name));a(p)},onBlur:n,value:d,invalid:o,errorMessage:c==null?void 0:c.message};return e.jsx(Ql,{ref:l,...qs(u,t)})}function ti({children:s,className:t}){const{selectedTab:a,isLazy:n}=g.useContext($n),i=g.Children.toArray(s).filter(o=>!!o);let l;if(n){const o=i[a];l=g.isValidElement(o)?g.cloneElement(i[a],{index:a}):null}else l=i.map((o,c)=>{if(g.isValidElement(o)){const d=c===a;return g.cloneElement(o,{index:c,"aria-hidden":!d,className:d?o.props.className:I(o.props.className,"hidden")})}return null});return e.jsx("div",{className:t,children:l})}function at({className:s,children:t,index:a,...n}){const{id:i}=g.useContext($n),[l,o]=g.useState(0),c=g.useRef(null);return ul(()=>{if(c!=null&&c.current){const d=()=>{const h=ml(c.current,{tabbable:!0});o(h.nextNode()?void 0:0)};d();const u=new MutationObserver(d);return u.observe(c.current,{subtree:!0,childList:!0,attributes:!0,attributeFilter:["tabIndex","disabled"]}),()=>{u.disconnect()}}},[c]),e.jsx("div",{tabIndex:l,ref:c,id:`${i}-${a}-tabpanel`,"aria-labelledby":`${i}-${a}-tab`,className:I(s,"focus-visible:outline-primary-light"),role:"tabpanel",...n,children:t})}function nm(){const{trans:s}=T();return e.jsx(ge,{title:e.jsx(r,{message:"Subscriptions"}),description:e.jsx(r,{message:"Configure gateway integration, accepted cards, invoices and other related settings."}),children:e.jsxs(ht,{children:[e.jsxs(xt,{children:[e.jsx(Ue,{children:e.jsx(r,{message:"General"})}),e.jsx(Ue,{children:e.jsx(r,{message:"Invoices"})})]}),e.jsxs(ti,{className:"pt-30",children:[e.jsxs(at,{children:[e.jsx(A,{name:"client.billing.enable",description:e.jsx(r,{message:"Enable or disable all subscription related functionality across the site."}),children:e.jsx(r,{message:"Enable subscriptions"})}),e.jsx(Re,{}),e.jsx(rm,{}),e.jsx(im,{}),e.jsx(Re,{}),e.jsx(Kt,{label:e.jsx(r,{message:"Accepted cards"}),name:"client.billing.accepted_cards",placeholder:s({message:"Add new card..."})})]}),e.jsxs(at,{children:[e.jsx(j,{inputElementType:"textarea",rows:5,label:e.jsx(r,{message:"Invoice address"}),name:"client.billing.invoice.address",className:"mb-30"}),e.jsx(j,{inputElementType:"textarea",rows:5,label:e.jsx(r,{message:"Invoice notes"}),description:e.jsx(r,{message:"Default notes to show under `notes` section of user invoice. Optional."}),name:"client.billing.invoice.notes"})]})]})]})})}function rm(){const{watch:s}=N(),t=s("client.billing.paypal.enable");return e.jsxs("div",{className:"mb-30",children:[e.jsx(A,{name:"client.billing.paypal.enable",description:e.jsxs("div",{children:[e.jsx(r,{message:"Enable PayPal payment gateway integration."}),e.jsx(Ve,{className:"mt-6",link:"https://support.vebto.com/help-center/articles/147/configuring-paypal"})]}),children:e.jsx(r,{message:"PayPal gateway"})}),t?e.jsx(le,{name:"paypal_group",children:a=>e.jsxs(g.Fragment,{children:[e.jsx(j,{name:"server.paypal_client_id",label:e.jsx(r,{message:"PayPal Client ID"}),required:!0,invalid:a,className:"mb-20"}),e.jsx(j,{name:"server.paypal_secret",label:e.jsx(r,{message:"PayPal Secret"}),required:!0,invalid:a,className:"mb-20"}),e.jsx(j,{name:"server.paypal_webhook_id",label:e.jsx(r,{message:"PayPal Webhook ID"}),required:!0,invalid:a,className:"mb-20"}),e.jsx(A,{name:"client.billing.paypal_test_mode",invalid:a,description:e.jsx("div",{children:e.jsx(r,{message:"Allows testing PayPal payments with sandbox accounts."})}),children:e.jsx(r,{message:"PayPal test mode"})})]})}):null]})}function im(){const{watch:s}=N(),t=s("client.billing.stripe.enable");return e.jsxs(g.Fragment,{children:[e.jsx(A,{name:"client.billing.stripe.enable",description:e.jsxs("div",{children:[e.jsx(r,{message:"Enable Stripe payment gateway integration."}),e.jsx(Ve,{className:"mt-6",link:"https://support.vebto.com/help-center/articles/148/configuring-stripe"})]}),children:e.jsx(r,{message:"Stripe gateway"})}),t?e.jsx(le,{name:"stripe_group",separatorBottom:!1,children:a=>e.jsxs(g.Fragment,{children:[e.jsx(j,{name:"server.stripe_key",label:e.jsx(r,{message:"Stripe publishable key"}),required:!0,className:"mb-20",invalid:a}),e.jsx(j,{name:"server.stripe_secret",label:e.jsx(r,{message:"Stripe secret key"}),required:!0,className:"mb-20",invalid:a}),e.jsx(j,{name:"server.stripe_webhook_secret",label:e.jsx(r,{message:"Stripe webhook signing secret"}),className:"mb-20",invalid:a})]})}):null]})}function lm(){const{data:s}=we(["timezones","localizations"]),t=Hn(),{trans:a}=T();return e.jsxs(ge,{title:e.jsx(r,{message:"Localization"}),description:e.jsx(r,{message:"Configure global date, time and language settings."}),children:[e.jsxs(M,{className:"mb-30",required:!0,name:"client.dates.default_timezone",showSearchField:!0,selectionMode:"single",label:e.jsx(r,{message:"Default timezone"}),searchPlaceholder:a(m("Search timezones")),description:e.jsx(r,{message:"Which timezone should be selected by default for new users and guests."}),children:[e.jsx(x,{value:"auto",children:e.jsx(r,{message:"Auto"})},"auto"),Object.entries((s==null?void 0:s.timezones)||{}).map(([n,i])=>e.jsx(sa,{label:n,children:i.map(l=>e.jsx(x,{value:l.value,children:l.text},l.value))},n))]}),e.jsxs(M,{name:"client.locale.default",className:"mb-30",selectionMode:"single",label:e.jsx(r,{message:"Default language"}),description:e.jsx(r,{message:"Which localization should be selected by default for new users and guests."}),children:[e.jsx(x,{value:"auto",children:e.jsx(r,{message:"Auto"})},"auto"),((s==null?void 0:s.localizations)||[]).map(n=>e.jsx(x,{value:n.language,capitalizeFirst:!0,children:n.name},n.language))]}),e.jsxs(Nn,{required:!0,className:"mb-30",size:"sm",name:"client.dates.format",orientation:"vertical",label:e.jsx(r,{message:"Date verbosity"}),description:e.jsx(r,{message:"Default verbosity for all dates displayed across the site. Month/day order and separators will be adjusted automatically, based on user's locale."}),children:[e.jsx(As,{value:"auto",children:e.jsx(r,{message:"Auto"})},"auto"),Object.entries(Cn).map(([n,i])=>e.jsx(As,{value:n,children:e.jsx(ce,{date:t,options:i})},n))]}),e.jsx(A,{name:"client.i18n.enable",description:e.jsx(r,{message:"If disabled, site will always be shown in default language and user will not be able to change their locale."}),children:e.jsx(r,{message:"Enable translations"})})]})}function om(){return w.get("uploads/server-max-file-size").then(s=>s.data)}function cm(){return ne({queryKey:["MaxServerUploadSize"],queryFn:()=>om()})}const dm=["B","KB","MB","GB","TB","PB"];function Za(s,t){if(s==null)return 0;switch(t){case"KB":return s*1024;case"MB":return s*1024**2;case"GB":return s*1024**3;case"TB":return s*1024**4;case"PB":return s*1024**5;default:return s}}const um=0x630000000000,Ts=O.forwardRef(({name:s,...t},a)=>{const{field:{onChange:n,onBlur:i,value:l="",ref:o},fieldState:{invalid:c,error:d}}=Bs({name:s}),[u,h]=g.useState(""),[p,b]=g.useState("MB");g.useEffect(()=>{if(l==null||l===""){h("");return}const{amount:C,unit:y}=mm({bytes:Math.min(l,um)});b(y||"MB"),h(Number.isNaN(C)?"":C)},[l,p]);const v={onChange:C=>{const y=parseInt(C.target.value);if(Number.isNaN(y))n(y);else{const E=Za(parseInt(C.target.value),p);n(E)}},onBlur:i,value:u,invalid:c,errorMessage:d==null?void 0:d.message,inputRef:o},S=e.jsx(ys,{minWidth:"min-w-80",selectionMode:"single",selectedValue:p,disabled:!l,onSelectionChange:C=>{const y=Za(u||0,C);n(y)},children:dm.slice(0,5).map(C=>e.jsx(x,{value:C,children:C==="B"?"Bytes":C},C))});return e.jsx(es,{...qs(v,t),type:"number",ref:a,endAppend:S})}),mm=_n(({bytes:s})=>{const t=gl(s);if(!t)return{amount:"",unit:"MB"};let a=parseInt(t.split(" ")[0]);return a=Math.round(a),{amount:a,unit:t.split(" ")[1]}});function gm(){const{trans:s}=T();return F({mutationFn:()=>hm(),onSuccess:()=>{P(s(m("CORS file updated")))},onError:t=>B(t)})}function hm(){return w.post("s3/cors/upload").then(s=>s.data)}function xm(){return F({mutationFn:s=>pm(s),onError:s=>B(s)})}function pm(s){return w.post("settings/uploading/dropbox-refresh-token",s).then(t=>t.data)}function jm({isInvalid:s}){const{watch:t,setValue:a}=N(),n=t("server.storage_dropbox_app_key"),i=t("server.storage_dropbox_app_secret");return e.jsxs(g.Fragment,{children:[e.jsx(j,{invalid:s,className:"mb-20",name:"server.storage_dropbox_app_key",label:e.jsx(r,{message:"Dropbox application key"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-20",name:"server.storage_dropbox_app_secret",label:e.jsx(r,{message:"Dropbox application secret"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-20",name:"server.storage_dropbox_refresh_token",label:e.jsx(r,{message:"Dropbox refresh token"}),required:!0}),e.jsxs(z,{type:"modal",onClose:l=>{l&&a("server.storage_dropbox_refresh_token",l)},children:[e.jsx(f,{variant:"outline",color:"primary",size:"xs",disabled:!n||!i,children:e.jsx(r,{message:"Get dropbox refresh token"})}),e.jsx(fm,{appKey:n,appSecret:i})]})]})}function fm({appKey:s,appSecret:t}){const a=q(),{formId:n,close:i}=H(),l=xm();return e.jsxs(U,{children:[e.jsx(Q,{children:e.jsx(r,{message:"Connected dropbox account"})}),e.jsx(W,{children:e.jsxs(me,{id:n,form:a,onSubmit:o=>{l.mutate({app_key:s,app_secret:t,access_code:o.accessCode},{onSuccess:c=>{i(c.refreshToken)}})},children:[e.jsxs("div",{className:"mb-20 pb-20 border-b",children:[e.jsx("div",{className:"text-muted text-sm mb-10",children:e.jsx(r,{message:"Click the 'get access code' button to get dropbox access code, then paste it into the field below."})}),e.jsx(f,{variant:"outline",color:"primary",size:"xs",elementType:"a",target:"_blank",href:`https://www.dropbox.com/oauth2/authorize?client_id=${s}&token_access_type=offline&response_type=code`,children:e.jsx(r,{message:"Get access code"})})]}),e.jsx(j,{name:"accessCode",label:e.jsx(r,{message:"Dropbox access code"}),required:!0})]})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:()=>{i()},children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{variant:"flat",color:"primary",form:n,type:"submit",disabled:!s||!t||l.isPending,children:e.jsx(r,{message:"Connect"})})]})]})}function bm(){const{trans:s}=T();return e.jsxs(ge,{title:e.jsx(r,{message:"Uploading"}),description:e.jsx(r,{message:"Configure size and type of files that users are able to upload. This will affect all uploads across the site."}),children:[e.jsx(ym,{}),e.jsx(wm,{}),e.jsx(Sm,{}),e.jsx(le,{name:"static_delivery_group",children:t=>e.jsxs(Nn,{invalid:t,size:"sm",name:"server.static_file_delivery",orientation:"vertical",label:e.jsx(r,{message:"File delivery optimization"}),description:e.jsx(r,{message:"Both X-Sendfile and X-Accel need to be enabled on the server first. When enabled, it will reduce server memory and CPU usage when previewing or downloading files, especially for large files."}),children:[e.jsx(As,{value:"",children:e.jsx(r,{message:"None"})}),e.jsx(As,{value:"xsendfile",children:e.jsx(r,{message:"X-Sendfile (Apache)"})}),e.jsx(As,{value:"xaccel",children:e.jsx(r,{message:"X-Accel (Nginx)"})})]})}),e.jsx(Ts,{className:"mb-30",name:"client.uploads.chunk_size",min:1,label:e.jsx(r,{message:"Chunk size"}),placeholder:"Infinity",description:e.jsx(r,{message:"Size (in bytes) for each file chunk. It should only be changed if there is a maximum upload size on your server or proxy (for example cloudflare). If chunk size is larger then limit on the server, uploads will fail."})}),e.jsx(vm,{}),e.jsx(Re,{}),e.jsx(Ts,{min:1,name:"client.uploads.max_size",className:"mb-30",label:e.jsx(r,{message:"Maximum file size"}),description:e.jsx(r,{message:"Maximum size (in bytes) for a single file user can upload."})}),e.jsx(Ts,{min:1,name:"client.uploads.available_space",className:"mb-30",label:e.jsx(r,{message:"Available space"}),description:e.jsx(r,{message:"Disk space (in bytes) each user uploads are allowed to take up. This can be overridden per user."})}),e.jsx(Kt,{name:"client.uploads.allowed_extensions",className:"mb-30",label:e.jsx(r,{message:"Allowed extensions"}),placeholder:s(m("Add extension...")),description:e.jsx(r,{message:"List of allowed file types (jpg, mp3, pdf etc.). Leave empty to allow all file types."})}),e.jsx(Kt,{name:"client.uploads.blocked_extensions",label:e.jsx(r,{message:"Blocked extensions"}),placeholder:s(m("Add extension...")),description:e.jsx(r,{message:"Prevent uploading of these file types, even if they are allowed above."})})]})}function vm(){const{data:s}=cm();return e.jsx(ve,{color:"warning",description:e.jsx(r,{message:"Maximum upload size on your server currently is set to <b>:size</b>",values:{size:s==null?void 0:s.maxSize,b:t=>e.jsx("b",{children:t})}})})}function ym(){const{watch:s,clearErrors:t}=N();return s("server.uploads_disk_driver")?e.jsxs(M,{className:"mb-30",selectionMode:"single",name:"server.uploads_disk_driver",label:e.jsx(r,{message:"User Uploads Storage Method"}),description:e.jsx(r,{message:"Where should user private file uploads be stored."}),onSelectionChange:()=>{t()},children:[e.jsx(x,{value:"local",children:e.jsx(r,{message:"Local Disk (Default)"})}),e.jsx(x,{value:"ftp",children:"FTP"}),e.jsx(x,{value:"digitalocean_s3",children:"DigitalOcean Spaces"}),e.jsx(x,{value:"backblaze_s3",children:"Backblaze"}),e.jsx(x,{value:"s3",children:"Amazon S3 (Or compatible service)"}),e.jsx(x,{value:"dropbox",children:"Dropbox"}),e.jsx(x,{value:"rackspace",children:"Rackspace"})]}):null}function wm(){const{watch:s,clearErrors:t}=N();return s("server.public_disk_driver")?e.jsxs(M,{label:e.jsx(r,{message:"Public Uploads Storage Method"}),selectionMode:"single",name:"server.public_disk_driver",description:e.jsx(r,{message:"Where should user public uploads (like avatars) be stored."}),onSelectionChange:()=>{t()},children:[e.jsx(x,{value:"local",children:e.jsx(r,{message:"Local Disk (Default)"})}),e.jsx(x,{value:"s3",children:"Amazon S3"}),e.jsx(x,{value:"ftp",children:"FTP"}),e.jsx(x,{value:"digitalocean_s3",children:"DigitalOcean Spaces"}),e.jsx(x,{value:"backblaze_s3",children:"Backblaze"})]}):null}function Sm(){const{watch:s}=N(),t=[s("server.uploads_disk_driver"),s("server.public_disk_driver")];return t[0]==="local"&&t[1]==="local"?null:e.jsx(le,{separatorBottom:!1,name:"storage_group",children:a=>{if(t.includes("s3"))return e.jsx(km,{isInvalid:a});if(t.includes("ftp"))return e.jsx(_m,{isInvalid:a});if(t.includes("dropbox"))return e.jsx(jm,{isInvalid:a});if(t.includes("digitalocean_s3"))return e.jsx(Nm,{isInvalid:a});if(t.includes("backblaze_s3"))return e.jsx(Cm,{isInvalid:a})}})}function km({isInvalid:s}){return e.jsxs(g.Fragment,{children:[e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_s3_key",label:e.jsx(r,{message:"Amazon S3 key"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_s3_secret",label:e.jsx(r,{message:"Amazon S3 secret"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_s3_region",label:e.jsx(r,{message:"Amazon S3 region"}),pattern:"[a-z1-9\\-]+",placeholder:"us-east-1"}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_s3_bucket",label:e.jsx(r,{message:"Amazon S3 bucket"}),required:!0}),e.jsx(j,{invalid:s,name:"server.storage_s3_endpoint",label:e.jsx(r,{message:"Amazon S3 endpoint"}),description:e.jsx(r,{message:"Only change endpoint if you are using another S3 compatible storage service."})}),e.jsx(Sa,{invalid:s})]})}function Nm({isInvalid:s}){return e.jsxs(g.Fragment,{children:[e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_digitalocean_key",label:e.jsx(r,{message:"DigitalOcean key"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_digitalocean_secret",label:e.jsx(r,{message:"DigitalOcean secret"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_digitalocean_region",label:e.jsx(r,{message:"DigitalOcean region"}),pattern:"[a-z0-9\\-]+",placeholder:"us-east-1",required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_digitalocean_bucket",label:e.jsx(r,{message:"DigitalOcean bucket"}),required:!0}),e.jsx(Sa,{invalid:s})]})}function Cm({isInvalid:s}){return e.jsxs(g.Fragment,{children:[e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_backblaze_key",label:e.jsx(r,{message:"Backblaze KeyID"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_backblaze_secret",label:e.jsx(r,{message:"Backblaze applicationKey"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_backblaze_region",label:e.jsx(r,{message:"Backblaze Region"}),pattern:"[a-z0-9\\-]+",placeholder:"us-west-002",required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_backblaze_bucket",label:e.jsx(r,{message:"Backblaze bucket name"}),required:!0}),e.jsx(Sa,{invalid:s})]})}function Sa({invalid:s}){var i,l;const t=gm(),{data:a}=Gs(),n=((i=a==null?void 0:a.server.uploads_disk_driver)==null?void 0:i.endsWith("s3"))||((l=a==null?void 0:a.server.public_disk_driver)==null?void 0:l.endsWith("s3"));return e.jsxs(g.Fragment,{children:[e.jsx(A,{className:"mt-30",invalid:s,name:"client.uploads.s3_direct_upload",description:e.jsxs("div",{children:[e.jsx("p",{children:e.jsx(r,{message:"Upload files directly from the browser to s3 without going through the server. It will save on server bandwidth and should result in faster upload times. This should be enabled, unless storage provider does not support multipart uploads."})}),e.jsx("p",{className:"mt-10",children:e.jsx(r,{message:"If s3 provider is not configured to allow uploads from browser, this can be done automatically via CORS button below, when valid credentials are saved."})})]}),children:e.jsx(r,{message:"Direct upload"})}),e.jsx(f,{variant:"flat",color:"primary",size:"xs",className:"mt-20",onClick:()=>{t.mutate()},disabled:!n||t.isPending,children:e.jsx(r,{message:"Configure CORS"})})]})}function _m({isInvalid:s}){return e.jsxs(e.Fragment,{children:[e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_ftp_host",label:e.jsx(r,{message:"FTP hostname"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_ftp_username",label:e.jsx(r,{message:"FTP username"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_ftp_password",label:e.jsx(r,{message:"FTP password"}),type:"password",required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_ftp_root",label:e.jsx(r,{message:"FTP directory"}),placeholder:"/"}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.storage_ftp_port",label:e.jsx(r,{message:"FTP port"}),type:"number",min:0,placeholder:"21"}),e.jsx(A,{invalid:s,name:"server.storage_ftp_passive",className:"mb-30",children:e.jsx(r,{message:"Passive"})}),e.jsx(A,{invalid:s,name:"server.storage_ftp_ssl",children:e.jsx(r,{message:"SSL"})})]})}function Am({isInvalid:s}){return e.jsxs(g.Fragment,{children:[e.jsx(j,{invalid:s,className:"mb-30",name:"server.mailgun_domain",label:e.jsx(r,{message:"Mailgun domain"}),description:e.jsx(r,{message:"Usually the domain of your site (site.com)"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.mailgun_secret",label:e.jsx(r,{message:"Mailgun API key"}),description:e.jsx(r,{message:"Should start with `key-`"}),required:!0}),e.jsx(j,{invalid:s,name:"server.mailgun_endpoint",label:e.jsx(r,{message:"Mailgun endpoint"}),description:e.jsx(r,{message:"Can be left empty, if your mailgun account is in the US region."}),placeholder:"api.eu.mailgun.net"})]})}function Em({isInvalid:s}){return e.jsxs(e.Fragment,{children:[e.jsx(j,{invalid:s,className:"mb-30",name:"server.mail_host",label:e.jsx(r,{message:"SMTP host"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.mail_username",label:e.jsx(r,{message:"SMTP username"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",type:"password",name:"server.mail_password",label:e.jsx(r,{message:"SMTP password"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",type:"number",name:"server.mail_port",label:e.jsx(r,{message:"SMTP port"})}),e.jsxs(M,{selectionMode:"single",invalid:s,className:"mb-30",name:"server.mail_encryption",label:e.jsx(r,{message:"SMTP encryption"}),children:[e.jsx(x,{value:"",children:e.jsx(r,{message:"None"})}),e.jsx(x,{value:"tls",children:e.jsx(r,{message:"TLS"})})]})]})}function Im({isInvalid:s}){return e.jsxs(g.Fragment,{children:[e.jsx(j,{invalid:s,className:"mb-30",name:"server.ses_key",label:e.jsx(r,{message:"SES key"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.ses_secret",label:e.jsx(r,{message:"SES secret"}),required:!0}),e.jsx(j,{invalid:s,name:"server.ses_region",label:e.jsx(r,{message:"SES region"}),placeholder:"us-east-1",required:!0})]})}function Tm({isInvalid:s}){return e.jsx(j,{invalid:s,name:"server.postmark_token",label:e.jsx(r,{message:"Postmark token"}),required:!0})}function Fm(){const{watch:s,clearErrors:t}=N(),a=s("server.mail_driver"),n=[];return a==="mailgun"&&n.push(Am),a==="smtp"&&n.push(Em),a==="ses"&&n.push(Im),a==="postmark"&&n.push(Tm),a==="gmailApi"&&n.push(ei),e.jsx(le,{separatorTop:!1,separatorBottom:!1,name:"mail_group",children:i=>e.jsxs(g.Fragment,{children:[e.jsxs(M,{onSelectionChange:()=>{t()},invalid:i,selectionMode:"single",name:"server.mail_driver",label:e.jsx(r,{message:"Outgoing mail method"}),description:e.jsxs("div",{children:[e.jsx(r,{message:"Which method should be used for sending outgoing application emails (like registration confirmation)"}),e.jsx(Ve,{className:"mt-8",link:"https://support.vebto.com/help-center/articles/42/44/155/incoming-emails"})]}),children:[e.jsx(x,{value:"mailgun",children:"Mailgun"}),e.jsx(x,{value:"gmailApi",children:"Gmail Api"}),e.jsx(x,{value:"smtp",children:"SMTP"}),e.jsx(x,{value:"postmark",children:"Postmark"}),e.jsx(x,{value:"ses",children:"Ses (Amazon Simple Email Service)"}),e.jsx(x,{value:"sendmail",children:"SendMail"}),e.jsx(x,{value:"log",children:"Log (Email will be saved to error log)"})]}),n.length?e.jsx("div",{className:"mt-30",children:n.map((l,o)=>e.jsx(l,{isInvalid:i},o))}):null]})})}function Pm(){return e.jsxs(ge,{title:e.jsx(r,{message:"Outgoing email settings"}),description:e.jsx(r,{message:"Change outgoing email handlers, email credentials and other related settings."}),children:[e.jsx(j,{id:"outgoing-emails",className:"mb-30",type:"email",name:"server.mail_from_address",label:e.jsx(r,{message:"From address"}),description:e.jsx(r,{message:"All outgoing application emails will be sent from this email address."}),required:!0}),e.jsx(zm,{}),e.jsx(j,{className:"mb-30",name:"server.mail_from_name",label:e.jsx(r,{message:"From name"}),description:e.jsx(r,{message:"All outgoing application emails will be sent using this name."}),required:!0}),e.jsx(ve,{color:"warning",description:e.jsx(r,{message:"Your selected mail method must be authorized to send emails using this address and name."})}),e.jsx(Re,{}),e.jsx(Fm,{})]})}function zm(){const{base_url:s}=Y(),t=`${s}/contact`,a=e.jsx(ut,{href:t,children:t});return e.jsx(j,{className:"mb-30",type:"email",name:"client.mail.contact_page_address",label:e.jsx(r,{message:"Contact page address"}),description:e.jsx(r,{values:{contactPageUrl:a},message:"Where emails from :contactPageUrl page should be sent to."})})}function Dm(){return w.post("cache/flush").then(s=>s.data)}function Mm(){return F({mutationFn:()=>Dm(),onSuccess:()=>{P(m("Cache cleared"))},onError:s=>B(s)})}function $m(){const s=Mm();return e.jsxs(ge,{title:e.jsx(r,{message:"Cache settings"}),description:e.jsx(r,{message:"Select cache provider and manually clear cache."}),children:[e.jsx(Rm,{}),e.jsx(f,{type:"button",variant:"outline",size:"xs",color:"primary",disabled:s.isPending,onClick:()=>{s.mutate()},children:e.jsx(r,{message:"Clear cache"})}),e.jsx(ve,{color:"warning",className:"mt-30",description:e.jsx(r,{message:'"File" is the best option for most cases and should not be changed, unless you are familiar with another cache method and have it set up on the server already.'})})]})}function Rm(){const{watch:s,clearErrors:t}=N(),a=s("server.cache_driver");let n=null;return a==="memcached"&&(n=Lm),e.jsx(le,{separatorTop:!1,name:"cache_group",children:i=>e.jsxs(e.Fragment,{children:[e.jsxs(M,{invalid:i,onSelectionChange:()=>{t()},selectionMode:"single",name:"server.cache_driver",label:e.jsx(r,{message:"Cache method"}),description:e.jsx(r,{message:"Which method should be used for storing and retrieving cached items."}),children:[e.jsx(x,{value:"file",children:e.jsx(r,{message:"File (Default)"})}),e.jsx(x,{value:"array",children:e.jsx(r,{message:"None"})}),e.jsx(x,{value:"apc",children:"APC"}),e.jsx(x,{value:"memcached",children:"Memcached"}),e.jsx(x,{value:"redis",children:"Redis"})]}),n&&e.jsx("div",{className:"mt-30",children:e.jsx(n,{isInvalid:i})})]})})}function Lm({isInvalid:s}){return e.jsxs(e.Fragment,{children:[e.jsx(j,{invalid:s,className:"mb-30",name:"server.memcached_host",label:e.jsx(r,{message:"Memcached host"}),required:!0}),e.jsx(j,{invalid:s,type:"number",name:"server.memcached_port",label:e.jsx(r,{message:"Memcached port"}),required:!0})]})}function Om(){return e.jsxs(ge,{title:e.jsx(r,{message:"Error logging"}),description:e.jsx(r,{message:"Configure site error logging and related 3rd party integrations."}),children:[e.jsx(qm,{}),e.jsx(ve,{className:"mt-30",color:"positive",description:e.jsx(r,{values:{a:s=>e.jsx(ut,{href:"https://sentry.io",children:s})},message:"<a>Sentry</a> integration provides real-time error tracking and helps identify and fix issues when site is in production."})})]})}function qm(){const{clearErrors:s}=N();return e.jsx(le,{separatorTop:!1,separatorBottom:!1,name:"logging_group",children:t=>e.jsx(j,{onChange:()=>{s()},invalid:t,name:"server.sentry_dsn",type:"url",minLength:30,label:e.jsx(r,{message:"Sentry DSN"})})})}function Vm(){return e.jsxs(ge,{title:e.jsx(r,{message:"Queue"}),description:e.jsx(r,{message:"Select active queue method and enter related 3rd party API keys."}),children:[e.jsx(ve,{color:"positive",className:"mb-30",description:e.jsx(r,{message:"Queues allow to defer time consuming tasks, such as sending an email, until a later time. Deferring these tasks can speed up web requests to the application."})}),e.jsx(ve,{color:"warning",className:"mb-30",description:e.jsx(r,{message:"All methods except sync require additional setup, which should be performed before changing the queue method. Consult documentation for more information."})}),e.jsx(Bm,{})]})}function Bm(){const{watch:s,clearErrors:t}=N(),a=s("server.queue_driver");let n=null;return a==="sqs"&&(n=Hm),e.jsx(le,{separatorTop:!1,separatorBottom:!1,name:"queue_group",children:i=>e.jsxs(e.Fragment,{children:[e.jsxs(M,{invalid:i,onSelectionChange:()=>{t()},selectionMode:"single",name:"server.queue_driver",label:e.jsx(r,{message:"Queue method"}),required:!0,children:[e.jsx(x,{value:"sync",children:e.jsx(r,{message:"Sync (Default)"})}),e.jsx(x,{value:"beanstalkd",children:"Beanstalkd"}),e.jsx(x,{value:"database",children:e.jsx(r,{message:"Database"})}),e.jsx(x,{value:"sqs",children:e.jsx(r,{message:"SQS (Amazon simple queue service)"})}),e.jsx(x,{value:"redis",children:"Redis"})]}),n&&e.jsx("div",{className:"mt-30",children:e.jsx(n,{isInvalid:i})})]})})}function Hm({isInvalid:s}){return e.jsxs(e.Fragment,{children:[e.jsx(j,{invalid:s,className:"mb-30",name:"server.sqs_queue_key",label:e.jsx(r,{message:"SQS queue key"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.sqs_queue_secret",label:e.jsx(r,{message:"SQS queue secret"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.sqs_queue_prefix",label:e.jsx(r,{message:"SQS queue prefix"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.sqs_queue_name",label:e.jsx(r,{message:"SQS queue name"}),required:!0}),e.jsx(j,{invalid:s,className:"mb-30",name:"server.sqs_queue_region",label:e.jsx(r,{message:"SQS queue region"}),required:!0})]})}function Um(){const{settings:s}=g.useContext(ts);return e.jsxs(ge,{title:e.jsx(r,{message:"Recaptcha"}),description:e.jsx(r,{message:"Configure google recaptcha integration and credentials."}),children:[(s==null?void 0:s.showRecaptchaLinkSwitch)&&e.jsx(A,{className:"mb-30",name:"client.recaptcha.enable.link_creation",description:e.jsx(r,{message:"Enable recaptcha integration when creating links from homepage or user dashboard."}),children:e.jsx(r,{message:"Link creation"})}),e.jsx(A,{className:"mb-30",name:"client.recaptcha.enable.contact",description:e.jsx(r,{message:'Enable recaptcha integration for "contact us" page.'}),children:e.jsx(r,{message:"Contact page"})}),e.jsx(A,{className:"mb-30",name:"client.recaptcha.enable.register",description:e.jsx(r,{message:"Enable recaptcha integration for registration page."}),children:e.jsx(r,{message:"Registration page"})}),e.jsx(Km,{})]})}function Km(){const{clearErrors:s}=N();return e.jsx(le,{separatorTop:!1,separatorBottom:!1,name:"recaptcha_group",children:t=>e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"mb-30",onChange:()=>{s()},invalid:t,name:"client.recaptcha.site_key",label:e.jsx(r,{message:"Recaptcha v3 site key"})}),e.jsx(j,{onChange:()=>{s()},invalid:t,name:"client.recaptcha.secret_key",label:e.jsx(r,{message:"Recaptcha v3 secret key"})})]})})}const Wm=O.forwardRef((s,t)=>{const a=hl(t),{fieldProps:n,inputProps:i}=xl({...s,focusRef:a}),l=na(s);return e.jsx(pl,{ref:t,fieldClassNames:l,...n,children:e.jsx("input",{type:"file",ref:a,...i,className:I(l.input,"py-8","file:bg-primary file:text-on-primary file:border-none file:rounded file:text-sm file:font-semibold file:px-10 file:h-24 file:mr-10")})})});function Gm({name:s,...t}){const{field:{onChange:a,onBlur:n,ref:i},fieldState:{invalid:l,error:o}}=Bs({name:s}),[c,d]=O.useState(""),u={onChange:h=>{var p;a((p=h.target.files)==null?void 0:p[0]),d(h.target.value)},onBlur:n,value:c,invalid:l,errorMessage:o==null?void 0:o.message};return e.jsx(Wm,{ref:i,...qs(u,t)})}function Qm(){return e.jsx(ge,{title:e.jsx(r,{message:"Analytics"}),description:e.jsx(r,{message:"Configure google analytics integration and credentials."}),children:e.jsx(Jm,{})})}function Jm(){const{clearErrors:s}=N();return e.jsx(le,{separatorTop:!1,separatorBottom:!1,name:"analytics_group",children:t=>e.jsxs(g.Fragment,{children:[e.jsx(Gm,{className:"mb-30",onChange:()=>{s()},invalid:t,name:"files.certificate",accept:".json",label:e.jsx(r,{message:"Google service account key file (.json)"})}),e.jsx(j,{className:"mb-30",onChange:()=>{s()},invalid:t,name:"server.analytics_property_id",type:"number",label:e.jsx(r,{message:"Google analytics property ID"})}),e.jsx(j,{className:"mb-30",onChange:()=>{s()},invalid:t,name:"client.analytics.tracking_code",placeholder:"G-******",min:"1",max:"20",description:e.jsx(r,{message:"Google analytics measurement ID only, not the whole javascript snippet."}),label:e.jsx(r,{message:"Google tag manager measurement ID"})}),e.jsx(j,{name:"client.analytics.gchart_api_key",label:e.jsx(r,{message:"Google maps javascript API key"}),description:e.jsx(r,{message:"Only required in order to show world geochart on integrated analytics pages."})})]})})}function Ym(s){const t=Z();return F({mutationFn:a=>Xm(a),onSuccess:(a,n)=>{P(m("User updated")),k.invalidateQueries({queryKey:["users"]}),t("/admin/users")},onError:a=>te(a,s)})}function Xm({id:s,...t}){return t.roles&&(t.roles=t.roles.map(a=>a.id)),w.put(`users/${s}`,t).then(a=>a.data)}function ai(){const[s,t]=g.useState(!1),a=g.useRef(),n=g.useCallback(i=>{var l;if(i){const o=new IntersectionObserver(([c])=>t(c.intersectionRatio<1),{threshold:[1]});a.current=o,o.observe(i)}else a.current&&((l=a.current)==null||l.disconnect())},[]);return{isSticky:s,sentinelRef:n}}function os({onSubmit:s,form:t,title:a,subTitle:n,children:i,actions:l,backButton:o,isLoading:c=!1,disableSaveWhenNotDirty:d=!1,wrapInContainer:u=!0}){const{isSticky:h,sentinelRef:p}=ai(),b=d?Object.keys(t.formState.dirtyFields).length:!0;return e.jsxs(me,{onSubmit:s,onBeforeSubmit:()=>t.clearErrors(),form:t,children:[e.jsx("div",{ref:p}),e.jsx("div",{className:I("sticky top-0 z-10 my-12 transition-shadow md:my-24",h&&"bg shadow"),children:e.jsxs("div",{className:I("flex items-center gap-24 py-14 md:items-start",u&&"container mx-auto px-24"),children:[o,e.jsxs("div",{className:"overflow-hidden overflow-ellipsis md:mr-64",children:[e.jsx("h1",{className:"overflow-hidden overflow-ellipsis whitespace-nowrap text-xl md:text-3xl",children:a}),n&&e.jsx("div",{className:"mt-4",children:n})]}),e.jsx("div",{className:"mr-auto"}),l,e.jsx(f,{variant:"flat",color:"primary",type:"submit",disabled:c||!b,children:e.jsx(r,{message:"Save"})})]})}),e.jsx("div",{className:u?"container mx-auto px-24 pb-24":void 0,children:e.jsx("div",{className:"rounded",children:i})})]})}function ni({onSubmit:s,form:t,title:a,subTitle:n,isLoading:i,avatarManager:l,resendEmailButton:o,children:c}){const{require_email_confirmation:d}=Y(),{data:u}=we(["roles","permissions"]);return e.jsxs(os,{onSubmit:s,form:t,title:a,subTitle:n,isLoading:i,children:[e.jsxs("div",{className:"mb-40 flex items-start gap-40 md:gap-80",children:[l,e.jsxs("div",{className:"flex-auto",children:[c,e.jsx(j,{className:"mb-30",name:"first_name",label:e.jsx(r,{message:"First name"})}),e.jsx(j,{name:"last_name",label:e.jsx(r,{message:"Last name"})})]})]}),e.jsxs("div",{className:"mb-30 border-b border-t pb-30 pt-30",children:[e.jsx(A,{className:I(o&&"mb-30"),disabled:!d,name:"email_verified_at",description:e.jsx(r,{message:"Whether email address has been confirmed. User will not be able to login until address is confirmed, unless confirmation is disabled from settings page."}),children:e.jsx(r,{message:"Email confirmed"})}),o]}),e.jsx(Ts,{className:"mb-30",name:"available_space",label:e.jsx(r,{message:"Allowed storage space"}),description:e.jsx(r,{values:{a:h=>e.jsx(D,{className:Hs,target:"_blank",to:"/admin/settings/uploading",children:h})},message:"Total storage space all user uploads are allowed to take up. If left empty, this value will be inherited from any roles or subscriptions user has, or from 'Available space' setting in <a>Uploading</a> settings page."})}),e.jsx(rs,{className:"mb-30",name:"roles",label:e.jsx(r,{message:"Roles"}),suggestions:u==null?void 0:u.roles,children:h=>e.jsx(x,{value:h.id,children:h.name},h.id)}),e.jsxs("div",{className:"mt-30 border-t pt-30",children:[e.jsx("div",{className:"mb-10 text-sm",children:e.jsx(r,{message:"Permissions"})}),e.jsx(fa,{name:"permissions"})]})]})}const Zm=R([e.jsx("path",{d:"M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27L15.73 3zM19 14.9 14.9 19H9.1L5 14.9V9.1L9.1 5h5.8L19 9.1v5.8z"},"0"),e.jsx("circle",{cx:"12",cy:"16",r:"1"},"1"),e.jsx("path",{d:"M11 7h2v7h-2z"},"2")],"ReportOutlined");function eg(){var u,h,p;const s=q(),{require_email_confirmation:t}=Y(),{userId:a}=X(),n=Ym(s),i=jl(),{data:l,isLoading:o}=fl(a,{with:["subscriptions","roles","permissions","bans"]}),c=(h=(u=l==null?void 0:l.user.bans)==null?void 0:u[0])==null?void 0:h.comment;if(g.useEffect(()=>{l!=null&&l.user&&!s.getValues().id&&s.reset({first_name:l.user.first_name,last_name:l.user.last_name,roles:l.user.roles,permissions:l.user.permissions,id:l.user.id,email_verified_at:!!l.user.email_verified_at,available_space:l.user.available_space,avatar:l.user.avatar})},[l==null?void 0:l.user,s]),o)return e.jsx(Fe,{});const d=e.jsx(f,{size:"xs",variant:"outline",color:"primary",disabled:!t||i.isPending||((p=l==null?void 0:l.user)==null?void 0:p.email_verified_at)!=null,onClick:()=>{i.mutate({email:l.user.email})},children:e.jsx(r,{message:"Resend email"})});return e.jsx(ni,{onSubmit:b=>{n.mutate(b)},form:s,title:e.jsx(r,{values:{email:l==null?void 0:l.user.email},message:"Edit “:email“"}),subTitle:c&&e.jsxs("div",{className:"flex items-center gap-4 text-sm text-danger",children:[e.jsx(Zm,{}),e.jsx("div",{children:e.jsx(r,{message:"Suspended: :reason",values:{reason:c}})})]}),isLoading:n.isPending,avatarManager:e.jsx(sg,{user:l.user,onChange:()=>{k.invalidateQueries({queryKey:["users"]})}}),resendEmailButton:d,children:e.jsx(j,{className:"mb-30",name:"password",type:"password",label:e.jsx(r,{message:"New password"})})})}function sg({user:s,onChange:t}){const a=bl({user:s}),n=vl({user:s});return e.jsx(Le,{children:e.jsx(Ls,{name:"avatar",diskPrefix:"avatars",variant:"avatar",stretchPreview:!0,label:e.jsx(r,{message:"Profile image"}),previewSize:"w-90 h-90",showRemoveButton:!0,onChange:i=>{i?a.mutate({url:i}):n.mutate(),t()}})})}function tg(s){const t=Z();return F({mutationFn:a=>ag(a),onSuccess:()=>{P(m("User created")),k.invalidateQueries({queryKey:K("users")}),t("/admin/users")},onError:a=>te(a,s)})}function ag(s){return s.roles&&(s.roles=s.roles.map(t=>t.id)),w.post("users",s).then(t=>t.data)}function ng(){const s=q(),t=tg(s),a=e.jsx(Le,{children:e.jsx(Ls,{name:"avatar",diskPrefix:"avatars",variant:"avatar",stretchPreview:!0,label:e.jsx(r,{message:"Profile image"}),previewSize:"w-90 h-90",showRemoveButton:!0})});return e.jsxs(ni,{onSubmit:n=>{t.mutate(n)},form:s,title:e.jsx(r,{message:"Add new user"}),isLoading:t.isPending,avatarManager:a,children:[e.jsx(j,{className:"mb-30",name:"email",type:"email",label:e.jsx(r,{message:"Email"})}),e.jsx(j,{className:"mb-30",name:"password",type:"password",label:e.jsx(r,{message:"Password"})})]})}const rg=R(e.jsx("path",{d:"m12.87 15.07-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7 1.62-4.33L19.12 17h-3.24z"}),"TranslateOutlined"),ka=s=>{const t=["getLocaleWithLines"];return s!=null&&t.push(s),t};function ig(s){return ne({queryKey:ka(s),queryFn:()=>lg(s),staleTime:1/0})}function lg(s){return w.get(`localizations/${s}`).then(t=>t.data)}function og({id:s,...t}){return w.put(`localizations/${s}`,t).then(a=>a.data)}function ri(s){return F({mutationFn:t=>og(t),onSuccess:()=>{P(m("Localization updated")),k.invalidateQueries({queryKey:K("localizations")}),k.invalidateQueries({queryKey:ka()})},onError:t=>s?te(t,s):B(t)})}function cg({localization:s}){const{trans:t}=T(),{formId:a,close:n}=H(),i=q({defaultValues:{id:s.id,name:s.name,language:s.language}}),{data:l}=we(["languages"]),o=(l==null?void 0:l.languages)||[],c=ri(i);return e.jsxs(U,{children:[e.jsx(Q,{children:e.jsx(r,{message:"Update localization"})}),e.jsx(W,{children:e.jsxs(me,{form:i,id:a,onSubmit:d=>{c.mutate(d,{onSuccess:n})},children:[e.jsx(j,{name:"name",label:e.jsx(r,{message:"Name"}),className:"mb-30",required:!0}),e.jsx(M,{required:!0,name:"language",label:e.jsx(r,{message:"Language"}),selectionMode:"single",showSearchField:!0,searchPlaceholder:t(m("Search languages")),children:o.map(d=>e.jsx(x,{value:d.code,children:d.name},d.code))})]})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:n,children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{variant:"flat",color:"primary",type:"submit",form:a,disabled:c.isPending,children:e.jsx(r,{message:"Save"})})]})]})}function dg(s){return w.post("localizations",s).then(t=>t.data)}function ug(s){const t=wn();return F({mutationFn:a=>dg(a),onSuccess:()=>{P(m("Localization created")),t.invalidateQueries({queryKey:K("localizations")})},onError:a=>te(a,s)})}function mg(){const{trans:s}=T(),{formId:t,close:a}=H(),n=q({defaultValues:{language:"en"}}),{data:i}=we(["languages"]),l=(i==null?void 0:i.languages)||[],o=ug(n);return e.jsxs(U,{children:[e.jsx(Q,{children:e.jsx(r,{message:"Create localization"})}),e.jsx(W,{children:e.jsxs(me,{form:n,id:t,onSubmit:c=>{o.mutate(c,{onSuccess:a})},children:[e.jsx(j,{autoFocus:!0,name:"name",label:e.jsx(r,{message:"Name"}),className:"mb-30",required:!0}),e.jsx(M,{required:!0,name:"language",label:e.jsx(r,{message:"Language"}),selectionMode:"single",showSearchField:!0,searchPlaceholder:s(m("Search languages")),children:l.map(c=>e.jsx(x,{value:c.code,children:c.name},c.code))})]})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:a,children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{variant:"flat",color:"primary",type:"submit",form:t,disabled:o.isPending,children:e.jsx(r,{message:"Save"})})]})]})}const gg=""+new URL("around-the-world-df9b11c5.svg",import.meta.url).href;function ii(){return F({mutationFn:s=>hg(s),onSuccess:async()=>{await k.invalidateQueries({queryKey:K("localizations")}),await k.invalidateQueries({queryKey:ka()}),P(m("Translation file uploaded"))},onError:s=>B(s)})}function hg({localeId:s,file:t}){const a=new FormData;return a.append("file",t.native),w.post(`localizations/${s}/upload`,a).then(n=>n.data)}const xg=[{key:"name",allowsSorting:!0,sortingKey:"name",visibleInMode:"all",width:"flex-3 min-w-200",header:()=>e.jsx(r,{message:"Name"}),body:s=>s.name},{key:"language",allowsSorting:!0,sortingKey:"language",header:()=>e.jsx(r,{message:"Language code"}),body:s=>s.language},{key:"updatedAt",allowsSorting:!0,width:"w-100",header:()=>e.jsx(r,{message:"Last updated"}),body:s=>e.jsx(ce,{date:s.updated_at})},{key:"actions",header:()=>e.jsx(r,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-84 flex-shrink-0",visibleInMode:"all",body:s=>e.jsxs("div",{className:"text-muted",children:[e.jsx(de,{label:e.jsx(r,{message:"Translate"}),children:e.jsx(_,{size:"md",elementType:D,to:`${s.id}/translate`,children:e.jsx(rg,{})})}),e.jsx(Le,{children:e.jsx(fg,{locale:s})})]})}];function pg(){return e.jsx(je,{endpoint:"localizations",title:e.jsx(r,{message:"Localizations"}),columns:xg,actions:e.jsx(jg,{}),selectedActions:e.jsx(De,{}),emptyStateMessage:e.jsx(ue,{image:gg,title:e.jsx(r,{message:"No localizations have been created yet"}),filteringTitle:e.jsx(r,{message:"No matching localizations"})})})}function jg(){return e.jsx(g.Fragment,{children:e.jsxs(z,{type:"modal",children:[e.jsx(Se,{children:e.jsx(r,{message:"Add new localization"})}),e.jsx(mg,{})]})})}function fg({locale:s}){const t=ii();return e.jsxs(Pe,{children:[e.jsx(_,{disabled:t.isPending,children:e.jsx(Ks,{})}),e.jsxs(ze,{children:[e.jsx(x,{value:"translate",elementType:D,to:`${s.id}/translate`,children:e.jsx(r,{message:"Translate"})}),e.jsx(x,{value:"rename",onSelected:()=>ps(cg,{localization:s}),children:e.jsx(r,{message:"Rename"})}),e.jsx(x,{value:"download",onSelected:()=>Ws(`api/v1/localizations/${s.id}/download`),children:e.jsx(r,{message:"Download"})}),e.jsx(x,{value:"upload",onSelected:async()=>{const a=await mt({types:[An.json]});a.length==1&&t.mutate({localeId:s.id,file:a[0]})},children:e.jsx(r,{message:"Upload"})})]})]})}function bg(){const{formId:s,close:t}=H(),a=q();return e.jsxs(U,{children:[e.jsx(Q,{children:e.jsx(r,{message:"Add translation"})}),e.jsx(W,{children:e.jsxs(me,{form:a,id:s,onSubmit:n=>{t(n)},children:[e.jsx(ve,{className:"mb-30",title:e.jsx(r,{message:"Add a new translation, if it does not exist already."}),description:e.jsx(r,{message:"This should only need to be done for things like custom menu items."})}),e.jsx(j,{inputElementType:"textarea",rows:2,autoFocus:!0,name:"key",label:e.jsx(r,{message:"Translation key"}),className:"mb-30",required:!0}),e.jsx(j,{inputElementType:"textarea",rows:2,name:"value",label:e.jsx(r,{message:"Translation value"}),required:!0})]})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:t,children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{variant:"flat",color:"primary",type:"submit",form:s,children:e.jsx(r,{message:"Add"})})]})]})}/**
 * react-virtual
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function nt(){return nt=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(s[n]=a[n])}return s},nt.apply(this,arguments)}/**
 * virtual-core
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function rt(){return rt=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(s[n]=a[n])}return s},rt.apply(this,arguments)}/**
 * virtual-core
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function us(s,t,a){var n,i=(n=a.initialDeps)!=null?n:[],l;return function(){var o;a.key&&a.debug!=null&&a.debug()&&(o=Date.now());var c=s(),d=c.length!==i.length||c.some(function(S,C){return i[C]!==S});if(!d)return l;i=c;var u;if(a.key&&a.debug!=null&&a.debug()&&(u=Date.now()),l=t.apply(void 0,c),a.key&&a.debug!=null&&a.debug()){var h=Math.round((Date.now()-o)*100)/100,p=Math.round((Date.now()-u)*100)/100,b=p/16,v=function(C,y){for(C=String(C);C.length<y;)C=" "+C;return C};console.info("%c⏱ "+v(p,5)+" /"+v(h,5)+" ms",`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(`+Math.max(0,Math.min(120-120*b,120))+"deg 100% 31%);",a==null?void 0:a.key)}return a==null||a.onChange==null||a.onChange(l),l}}function Ft(s,t){if(s===void 0)throw new Error("Unexpected undefined"+(t?": "+t:""));return s}var vg=function(t,a){return Math.abs(t-a)<1};/**
 * virtual-core
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var yg=function(t){return t},wg=function(t){for(var a=Math.max(t.startIndex-t.overscan,0),n=Math.min(t.endIndex+t.overscan,t.count-1),i=[],l=a;l<=n;l++)i.push(l);return i},Sg=function(t,a){var n=t.scrollElement;if(n){var i=function(c){var d=c.width,u=c.height;a({width:Math.round(d),height:Math.round(u)})};i(n.getBoundingClientRect());var l=new ResizeObserver(function(o){var c=o[0];if(c!=null&&c.borderBoxSize){var d=c.borderBoxSize[0];if(d){i({width:d.inlineSize,height:d.blockSize});return}}i(n.getBoundingClientRect())});return l.observe(n,{box:"border-box"}),function(){l.unobserve(n)}}},kg=function(t,a){var n=t.scrollElement;if(n){var i=function(){a(n[t.options.horizontal?"scrollLeft":"scrollTop"])};return i(),n.addEventListener("scroll",i,{passive:!0}),function(){n.removeEventListener("scroll",i)}}},Ng=function(t,a,n){if(a!=null&&a.borderBoxSize){var i=a.borderBoxSize[0];if(i){var l=Math.round(i[n.options.horizontal?"inlineSize":"blockSize"]);return l}}return Math.round(t.getBoundingClientRect()[n.options.horizontal?"width":"height"])},Cg=function(t,a,n){var i,l,o=a.adjustments,c=o===void 0?0:o,d=a.behavior,u=t+c;(i=n.scrollElement)==null||i.scrollTo==null||i.scrollTo((l={},l[n.options.horizontal?"left":"top"]=u,l.behavior=d,l))},_g=function(t){var a=this;this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.isScrollingTimeoutId=null,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=function(){var n=null,i=function(){return n||(typeof ResizeObserver<"u"?n=new ResizeObserver(function(o){o.forEach(function(c){a._measureElement(c.target,c)})}):null)};return{disconnect:function(){var o;return(o=i())==null?void 0:o.disconnect()},observe:function(o){var c;return(c=i())==null?void 0:c.observe(o,{box:"border-box"})},unobserve:function(o){var c;return(c=i())==null?void 0:c.unobserve(o)}}}(),this.range=null,this.setOptions=function(n){Object.entries(n).forEach(function(i){var l=i[0],o=i[1];typeof o>"u"&&delete n[l]}),a.options=rt({debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:yg,rangeExtractor:wg,onChange:function(){},measureElement:Ng,initialRect:{width:0,height:0},scrollMargin:0,scrollingDelay:150,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1},n)},this.notify=function(n){a.options.onChange==null||a.options.onChange(a,n)},this.maybeNotify=us(function(){return a.calculateRange(),[a.isScrolling,a.range?a.range.startIndex:null,a.range?a.range.endIndex:null]},function(n){a.notify(n)},{key:!1,debug:function(){return a.options.debug},initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=function(){a.unsubs.filter(Boolean).forEach(function(n){return n()}),a.unsubs=[],a.scrollElement=null},this._didMount=function(){return a.measureElementCache.forEach(a.observer.observe),function(){a.observer.disconnect(),a.cleanup()}},this._willUpdate=function(){var n=a.options.getScrollElement();a.scrollElement!==n&&(a.cleanup(),a.scrollElement=n,a._scrollToOffset(a.scrollOffset,{adjustments:void 0,behavior:void 0}),a.unsubs.push(a.options.observeElementRect(a,function(i){a.scrollRect=i,a.maybeNotify()})),a.unsubs.push(a.options.observeElementOffset(a,function(i){a.scrollAdjustments=0,a.scrollOffset!==i&&(a.isScrollingTimeoutId!==null&&(clearTimeout(a.isScrollingTimeoutId),a.isScrollingTimeoutId=null),a.isScrolling=!0,a.scrollDirection=a.scrollOffset<i?"forward":"backward",a.scrollOffset=i,a.maybeNotify(),a.isScrollingTimeoutId=setTimeout(function(){a.isScrollingTimeoutId=null,a.isScrolling=!1,a.scrollDirection=null,a.maybeNotify()},a.options.scrollingDelay))})))},this.getSize=function(){return a.scrollRect[a.options.horizontal?"width":"height"]},this.memoOptions=us(function(){return[a.options.count,a.options.paddingStart,a.options.scrollMargin,a.options.getItemKey]},function(n,i,l,o){return a.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:i,scrollMargin:l,getItemKey:o}},{key:!1}),this.getFurthestMeasurement=function(n,i){for(var l=new Map,o=new Map,c=i-1;c>=0;c--){var d=n[c];if(!l.has(d.lane)){var u=o.get(d.lane);if(u==null||d.end>u.end?o.set(d.lane,d):d.end<u.end&&l.set(d.lane,!0),l.size===a.options.lanes)break}}return o.size===a.options.lanes?Array.from(o.values()).sort(function(h,p){return h.end-p.end})[0]:void 0},this.getMeasurements=us(function(){return[a.memoOptions(),a.itemSizeCache]},function(n,i){var l=n.count,o=n.paddingStart,c=n.scrollMargin,d=n.getItemKey,u=a.pendingMeasuredCacheIndexes.length>0?Math.min.apply(Math,a.pendingMeasuredCacheIndexes):0;a.pendingMeasuredCacheIndexes=[];for(var h=a.measurementsCache.slice(0,u),p=u;p<l;p++){var b=d(p),v=a.options.lanes===1?h[p-1]:a.getFurthestMeasurement(h,p),S=v?v.end:o+c,C=i.get(b),y=typeof C=="number"?C:a.options.estimateSize(p),E=S+y,$=v?v.lane:p%a.options.lanes;h[p]={index:p,start:S,size:y,end:E,key:b,lane:$}}return a.measurementsCache=h,h},{key:!1,debug:function(){return a.options.debug}}),this.calculateRange=us(function(){return[a.getMeasurements(),a.getSize(),a.scrollOffset]},function(n,i,l){return a.range=n.length>0&&i>0?Ag({measurements:n,outerSize:i,scrollOffset:l}):null},{key:!1,debug:function(){return a.options.debug}}),this.getIndexes=us(function(){return[a.options.rangeExtractor,a.calculateRange(),a.options.overscan,a.options.count]},function(n,i,l,o){return i===null?[]:n(rt({},i,{overscan:l,count:o}))},{key:!1,debug:function(){return a.options.debug}}),this.indexFromElement=function(n){var i=a.options.indexAttribute,l=n.getAttribute(i);return l?parseInt(l,10):(console.warn("Missing attribute name '"+i+"={index}' on measured element."),-1)},this._measureElement=function(n,i){var l=a.measurementsCache[a.indexFromElement(n)];if(!l||!n.isConnected){a.measureElementCache.forEach(function(d,u){d===n&&(a.observer.unobserve(n),a.measureElementCache.delete(u))});return}var o=a.measureElementCache.get(l.key);o!==n&&(o&&a.observer.unobserve(o),a.observer.observe(n),a.measureElementCache.set(l.key,n));var c=a.options.measureElement(n,i,a);a.resizeItem(l,c)},this.resizeItem=function(n,i){var l,o=(l=a.itemSizeCache.get(n.key))!=null?l:n.size,c=i-o;c!==0&&(n.start<a.scrollOffset&&a._scrollToOffset(a.scrollOffset,{adjustments:a.scrollAdjustments+=c,behavior:void 0}),a.pendingMeasuredCacheIndexes.push(n.index),a.itemSizeCache=new Map(a.itemSizeCache.set(n.key,i)),a.notify(!1))},this.measureElement=function(n){n&&a._measureElement(n,void 0)},this.getVirtualItems=us(function(){return[a.getIndexes(),a.getMeasurements()]},function(n,i){for(var l=[],o=0,c=n.length;o<c;o++){var d=n[o],u=i[d];l.push(u)}return l},{key:!1,debug:function(){return a.options.debug}}),this.getVirtualItemForOffset=function(n){var i=a.getMeasurements();return Ft(i[li(0,i.length-1,function(l){return Ft(i[l]).start},n)])},this.getOffsetForAlignment=function(n,i){var l=a.getSize();i==="auto"&&(n<=a.scrollOffset?i="start":n>=a.scrollOffset+l?i="end":i="start"),i==="start"?n=n:i==="end"?n=n-l:i==="center"&&(n=n-l/2);var o=a.options.horizontal?"scrollWidth":"scrollHeight",c=a.scrollElement?"document"in a.scrollElement?a.scrollElement.document.documentElement[o]:a.scrollElement[o]:0,d=c-a.getSize();return Math.max(Math.min(d,n),0)},this.getOffsetForIndex=function(n,i){i===void 0&&(i="auto"),n=Math.max(0,Math.min(n,a.options.count-1));var l=Ft(a.getMeasurements()[n]);if(i==="auto")if(l.end>=a.scrollOffset+a.getSize()-a.options.scrollPaddingEnd)i="end";else if(l.start<=a.scrollOffset+a.options.scrollPaddingStart)i="start";else return[a.scrollOffset,i];var o=i==="end"?l.end+a.options.scrollPaddingEnd:l.start-a.options.scrollPaddingStart;return[a.getOffsetForAlignment(o,i),i]},this.isDynamicMode=function(){return a.measureElementCache.size>0},this.cancelScrollToIndex=function(){a.scrollToIndexTimeoutId!==null&&(clearTimeout(a.scrollToIndexTimeoutId),a.scrollToIndexTimeoutId=null)},this.scrollToOffset=function(n,i){var l=i===void 0?{}:i,o=l.align,c=o===void 0?"start":o,d=l.behavior;a.cancelScrollToIndex(),d==="smooth"&&a.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),a._scrollToOffset(a.getOffsetForAlignment(n,c),{adjustments:void 0,behavior:d})},this.scrollToIndex=function(n,i){var l=i===void 0?{}:i,o=l.align,c=o===void 0?"auto":o,d=l.behavior;n=Math.max(0,Math.min(n,a.options.count-1)),a.cancelScrollToIndex(),d==="smooth"&&a.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");var u=a.getOffsetForIndex(n,c),h=u[0],p=u[1];a._scrollToOffset(h,{adjustments:void 0,behavior:d}),d!=="smooth"&&a.isDynamicMode()&&(a.scrollToIndexTimeoutId=setTimeout(function(){a.scrollToIndexTimeoutId=null;var b=a.measureElementCache.has(a.options.getItemKey(n));if(b){var v=a.getOffsetForIndex(n,p),S=v[0];vg(S,a.scrollOffset)||a.scrollToIndex(n,{align:p,behavior:d})}else a.scrollToIndex(n,{align:p,behavior:d})}))},this.scrollBy=function(n,i){var l=i===void 0?{}:i,o=l.behavior;a.cancelScrollToIndex(),o==="smooth"&&a.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),a._scrollToOffset(a.scrollOffset+n,{adjustments:void 0,behavior:o})},this.getTotalSize=function(){var n;return(((n=a.getMeasurements()[a.options.count-1])==null?void 0:n.end)||a.options.paddingStart)-a.options.scrollMargin+a.options.paddingEnd},this._scrollToOffset=function(n,i){var l=i.adjustments,o=i.behavior;a.options.scrollToFn(n,{behavior:o,adjustments:l},a)},this.measure=function(){a.itemSizeCache=new Map,a.notify(!1)},this.setOptions(t),this.scrollRect=this.options.initialRect,this.scrollOffset=this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(function(n){a.itemSizeCache.set(n.key,n.size)}),this.maybeNotify()},li=function(t,a,n,i){for(;t<=a;){var l=(t+a)/2|0,o=n(l);if(o<i)t=l+1;else if(o>i)a=l-1;else return l}return t>0?t-1:0};function Ag(s){for(var t=s.measurements,a=s.outerSize,n=s.scrollOffset,i=t.length-1,l=function(u){return t[u].start},o=li(0,i,l,n),c=o;c<i&&t[c].end<n+a;)c++;return{startIndex:o,endIndex:c}}/**
 * react-virtual
 *
 * Copyright (c) TanStack
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Eg=typeof document<"u"?g.useLayoutEffect:g.useEffect;function Ig(s){var t=g.useReducer(function(){return{}},{})[1],a=nt({},s,{onChange:function(o,c){c?Rt.flushSync(t):t(),s.onChange==null||s.onChange(o,c)}}),n=g.useState(function(){return new _g(a)}),i=n[0];return i.setOptions(a),g.useEffect(function(){return i._didMount()},[]),Eg(function(){return i._willUpdate()}),i}function Tg(s){return Ig(nt({observeElementRect:Sg,observeElementOffset:kg,scrollToFn:Cg},s))}function Fg(){const{localeId:s}=X(),{data:t,isLoading:a}=ig(s),n=t==null?void 0:t.localization;return a||!n?e.jsx(Fe,{}):e.jsx(Pg,{localization:n})}function Pg({localization:s}){const[t,a]=g.useState(s.lines||{}),n=Z(),i=ri(),[l,o]=g.useState("");return e.jsxs("form",{className:"flex h-full flex-col p-14 md:p-24",onSubmit:c=>{c.preventDefault(),i.mutate({id:s.id,lines:t},{onSuccess:()=>{n("/admin/localizations")}})},children:[e.jsx(zg,{localization:s,setLines:a,lines:t,searchQuery:l,setSearchQuery:o,isLoading:i.isPending}),e.jsx(Dg,{lines:t,setLines:a,searchQuery:l})]})}function zg({localization:s,searchQuery:t,setSearchQuery:a,isLoading:n,lines:i,setLines:l}){const o=Z(),c=as(),{trans:d}=T();return e.jsxs("div",{className:"flex-shrink-0",children:[e.jsxs(Wn,{size:"lg",className:"mb-16",children:[e.jsx(Es,{onSelected:()=>{o("/admin/localizations")},children:e.jsx(r,{message:"Localizations"})}),e.jsx(Es,{children:e.jsx(r,{message:":locale translations",values:{locale:s.name}})})]}),e.jsxs("div",{className:"mb-24 flex items-center gap-32 md:gap-12",children:[e.jsx("div",{className:"max-w-440 flex-auto",children:e.jsx(es,{value:t,onChange:u=>a(u.target.value),startAdornment:e.jsx(ra,{}),placeholder:d({message:"Type to search..."})})}),e.jsxs(z,{type:"modal",onClose:u=>{if(u){const h={...i};h[u.key]=u.value,l(h)}},children:[!c&&e.jsx(f,{className:"ml-auto",variant:"outline",color:"primary",startIcon:e.jsx(Ce,{}),children:e.jsx(r,{message:"Add new"})}),e.jsx(bg,{})]}),e.jsx(Mg,{locale:s}),e.jsx(f,{variant:"flat",color:"primary",type:"submit",disabled:n,children:c?e.jsx(r,{message:"Save"}):e.jsx(r,{message:"Save translations"})})]})]})}function Dg({searchQuery:s,lines:t,setLines:a}){const n=g.useMemo(()=>Object.entries(t).filter(([o,c])=>{const d=s==null?void 0:s.toLowerCase();return!d||(o==null?void 0:o.toLowerCase().includes(d))||(c==null?void 0:c.toLowerCase().includes(d))}),[t,s]),i=g.useRef(null),l=Tg({count:n.length,getScrollElement:()=>i.current,estimateSize:()=>123});return e.jsx("div",{className:"flex-auto overflow-y-auto",ref:i,children:e.jsx("div",{className:"relative w-full",style:{height:`${l.getTotalSize()}px`},children:l.getVirtualItems().map(o=>{const[c,d]=n[o.index];return e.jsx("div",{className:"absolute left-0 top-0 w-full",style:{height:`${o.size}px`,transform:`translateY(${o.start}px)`},children:e.jsxs("div",{className:"mb-10 rounded border md:mr-10",children:[e.jsxs("div",{className:"flex items-center justify-between gap-24 border-b px-10 py-2",children:[e.jsx("label",{className:"flex-auto text-xs font-semibold",htmlFor:c,children:c}),e.jsx(_,{size:"xs",className:"text-muted",onClick:()=>{const u={...t};delete u[c],a(u)},children:e.jsx(ye,{})})]}),e.jsx("div",{children:e.jsx("textarea",{id:c,name:c,defaultValue:d,className:"block w-full resize-none rounded bg-inherit p-10 text-sm outline-none focus-visible:ring-2",rows:2,onChange:u=>{const h={...t};h[c]=u.target.value,a(h)}})})]})},c)})})})}function Mg({locale:s}){const t=ii();return e.jsxs(Pe,{children:[e.jsx(_,{variant:"outline",size:"sm",color:"primary",disabled:t.isPending,children:e.jsx(Ks,{})}),e.jsxs(ze,{children:[e.jsx(x,{value:"download",onSelected:()=>Ws(`api/v1/localizations/${s.id}/download`),children:e.jsx(r,{message:"Download"})}),e.jsx(x,{value:"upload",onSelected:async()=>{const a=await mt({types:[An.json]});a.length==1&&t.mutate({localeId:s.id,file:a[0]})},children:e.jsx(r,{message:"Upload"})})]})]})}function $g(s){const{close:t}=H(),{image:a,images:n}=s,[i,l]=vn(s.activeIndex,s.defaultActiveIndex,s.onActiveIndexChange),o=a||(n==null?void 0:n[i]);return e.jsx(U,{size:"fullscreenTakeover",background:"bg-black/80",children:e.jsxs(W,{padding:"p-0",className:"h-full w-full",children:[e.jsx(_,{size:"lg",color:"paper",className:"absolute right-0 top-0 z-20 text-white",onClick:()=>{t()},children:e.jsx(ye,{})}),e.jsxs("div",{className:"relative flex h-full w-full items-center justify-center p-40",children:[n!=null&&n.length?e.jsx(_,{size:"lg",color:"white",variant:"flat",className:"absolute bottom-0 left-20 top-0 my-auto",disabled:i<1,onClick:()=>{l(i-1)},children:e.jsx(Zt,{})}):null,e.jsx("img",{src:o,alt:"",className:"max-h-full w-auto object-contain shadow"}),n!=null&&n.length?e.jsx(_,{size:"lg",color:"white",variant:"flat",className:"absolute bottom-0 right-20 top-0 my-auto",disabled:i+1===(n==null?void 0:n.length),onClick:()=>{l(i+1)},children:e.jsx(ot,{})}):null]})]})})}function Rg(){var t;const s=Gs();return e.jsxs("div",{className:"container mx-auto p-12 md:p-24",children:[e.jsx(fs,{children:e.jsx(r,{message:"Ads"})}),e.jsx("h1",{className:"mb-20 text-2xl font-light md:mb-40 md:text-3xl",children:e.jsx(r,{message:"Predefined Ad slots"})}),s.isLoading?e.jsx(bs,{isIndeterminate:!0}):e.jsx(Lg,{defaultValues:((t=s.data)==null?void 0:t.client.ads)||{}})]})}function Lg({defaultValues:s}){const{admin:{ads:t}}=g.useContext(ts),a=q({defaultValues:{client:{ads:s}}}),n=mr(a);return e.jsxs(me,{form:a,onSubmit:i=>{n.mutate(i)},children:[t.map(i=>e.jsx(Og,{adConfig:i},i.slot)),e.jsx(A,{name:"client.ads.disable",className:"mb-30",description:e.jsx(r,{message:"Disable all add related functionality across the site."}),children:e.jsx(r,{message:"Disable ads"})}),e.jsx(f,{type:"submit",variant:"flat",color:"primary",disabled:n.isPending,children:e.jsx(r,{message:"Save"})})]})}function Og({adConfig:s}){return e.jsxs("div",{className:"flex items-center gap-24",children:[e.jsx(j,{className:"mb-30 flex-auto",name:`client.${s.slot}`,inputElementType:"textarea",rows:8,label:e.jsx(r,{...s.description})}),e.jsxs(z,{type:"modal",children:[e.jsx("button",{type:"button",className:"cursor-zoom-in overflow-hidden rounded outline-none transition hover:scale-105 focus-visible:ring max-md:hidden",children:e.jsx("img",{src:s.image,className:"h-[186px] w-auto border",alt:"Ad slot example"})}),e.jsx($g,{image:s.image})]})]})}function qg(){const s=pt(a=>{var n;return(n=a.config)==null?void 0:n.sections}),t=g.useMemo(()=>s?Object.entries(s||[]).map(([a,n])=>({...n,key:a})).sort((a,n)=>((a==null?void 0:a.position)||1)-((n==null?void 0:n.position)||1)):[],[s]);return e.jsx(g.Fragment,{children:t.map(a=>e.jsx(Ee,{to:a.key,elementType:ta,children:e.jsx(r,{...a.label})},a.key))})}const Vg=[{key:"type",label:m("Type"),description:m("Type of the role"),defaultOperator:G.ne,control:{type:he.Select,defaultValue:"01",options:[{key:"01",label:m("Sitewide"),value:"sitewide"},{key:"02",label:m("Workspace"),value:"workspace"}]}},Oe({description:m("Date role was created")}),Qe({description:m("Date role was last updated")})],Bg=[{key:"name",allowsSorting:!0,visibleInMode:"all",header:()=>e.jsx(r,{message:"Role"}),body:s=>e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(r,{message:s.name})}),e.jsx("div",{className:"text-muted text-xs overflow-x-hidden overflow-ellipsis",children:s.description?e.jsx(r,{message:s.description}):void 0})]})},{key:"type",maxWidth:"max-w-100",allowsSorting:!0,header:()=>e.jsx(r,{message:"Type"}),body:s=>e.jsx(r,{message:s.type})},{key:"updated_at",maxWidth:"max-w-100",allowsSorting:!0,header:()=>e.jsx(r,{message:"Last updated"}),body:s=>e.jsx(ce,{date:s.updated_at})},{key:"actions",header:()=>e.jsx(r,{message:"Actions"}),hideHeader:!0,visibleInMode:"all",align:"end",width:"w-42 flex-shrink-0",body:s=>e.jsx(D,{to:`${s.id}/edit`,children:e.jsx(_,{size:"md",className:"text-muted",children:e.jsx(_e,{})})})}];function Hg(){return e.jsx(je,{endpoint:"roles",title:e.jsx(r,{message:"Roles"}),columns:Bg,filters:Vg,actions:e.jsx(Ug,{}),selectedActions:e.jsx(De,{}),emptyStateMessage:e.jsx(ue,{image:Ps,title:e.jsx(r,{message:"No roles have been created yet"}),filteringTitle:e.jsx(r,{message:"No matching roles"})})})}function Ug(){return e.jsxs(g.Fragment,{children:[e.jsx(Qn,{endpoint:"roles/csv/export"}),e.jsx(Se,{elementType:D,to:"new",children:e.jsx(r,{message:"Add new role"})})]})}const oi=s=>`roles/${s}`;function Kg(){const{roleId:s}=X();return ne({queryKey:[oi(s)],queryFn:()=>Wg(s)})}function Wg(s){return w.get(oi(s)).then(t=>t.data)}const ci=s=>`roles/${s}`;function Gg(){const{trans:s}=T(),t=Z();return F({mutationFn:a=>Qg(a),onSuccess:a=>{P(s(m("Role updated"))),k.invalidateQueries({queryKey:[ci(a.role.id)]}),k.invalidateQueries({queryKey:K("roles")}),t("/admin/roles")},onError:a=>B(a)})}function Qg({id:s,...t}){return w.put(ci(s),t).then(a=>a.data)}function di({isInternal:s=!1}){const{trans:t}=T(),{workspaces:a}=Y(),{watch:n}=N(),i=n("type");return e.jsxs(e.Fragment,{children:[e.jsx(j,{label:e.jsx(r,{message:"Name"}),name:"name",className:"mb-20",required:!0}),e.jsx(j,{label:e.jsx(r,{message:"Description"}),name:"description",inputElementType:"textarea",placeholder:t(m("Role description...")),rows:4,className:"mb-20"}),a.integrated&&e.jsxs(M,{label:e.jsx(r,{message:"Type"}),name:"type",selectionMode:"single",className:"mb-20",description:e.jsx(r,{message:"Whether this role will be assigned to users globally on the site or only within workspaces."}),children:[e.jsx(x,{value:"sitewide",children:e.jsx(r,{message:"Sitewide"})}),e.jsx(x,{value:"workspace",children:e.jsx(r,{message:"Workspace"})})]}),!s&&e.jsxs(e.Fragment,{children:[e.jsx(A,{name:"default",className:"mb-20",description:e.jsx(r,{message:"Assign this role to new users automatically."}),children:e.jsx(r,{message:"Default"})}),i==="sitewide"&&e.jsx(A,{name:"guests",description:e.jsx(r,{message:"Assign this role to guests (not logged in users)."}),children:e.jsx(r,{message:"Guests"})})]}),e.jsx("h2",{className:"mb-10 mt-30 text-lg",children:e.jsx(r,{message:"Permissions"})}),e.jsx(fa,{name:"permissions",valueListKey:i==="sitewide"?"permissions":"workspacePermissions"})]})}function Jg({onUserSelected:s}){var u;const{close:t}=H(),[a,n]=g.useState(""),{trans:i}=T(),l=Jl("normalized-models/user",{query:a,perPage:14}),o=((u=l.data)==null?void 0:u.results)||[],c=e.jsx(Vs,{className:"pt-20",size:"sm",title:e.jsx(r,{message:"No matching users"}),description:e.jsx(r,{message:"Try another search query"}),image:e.jsx(ct,{src:Ps})}),d=h=>{t(),s(h)};return e.jsxs(U,{children:[e.jsx(Q,{children:e.jsx(r,{message:"Select a user"})}),e.jsxs(W,{children:[e.jsx(es,{autoFocus:!0,className:"mb-20",startAdornment:e.jsx(ra,{}),placeholder:i(m("Search for user by name or email")),value:a,onChange:h=>{n(h.target.value)}}),!l.isLoading&&!o.length&&c,e.jsx("div",{className:"grid grid-cols-2 gap-x-10",children:o.map(h=>e.jsx(Yg,{user:h,onUserSelected:d},h.id))})]})]})}function Yg({user:s,onUserSelected:t}){return e.jsxs("div",{className:"flex items-center gap-10 rounded p-10 outline-none ring-offset-4 hover:bg-hover focus-visible:ring",role:"button",tabIndex:0,onClick:()=>{t(s)},onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),t(s))},children:[e.jsx(Un,{src:s.image}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("div",{className:"overflow-hidden text-ellipsis",children:s.name}),e.jsx("div",{className:"overflow-hidden text-ellipsis text-muted",children:s.description})]})]},s.id)}function Xg(s){return F({mutationFn:({userIds:t})=>Zg({userIds:t,roleId:s.id}),onSuccess:(t,a)=>{P(m("Removed [one 1 user|other :count users] from “{role}“",{values:{count:a.userIds.length,role:s.name}}))},onError:t=>B(t)})}function Zg({roleId:s,userIds:t}){return w.post(`roles/${s}/remove-users`,{userIds:t}).then(a=>a.data)}function eh(s){return F({mutationFn:({userIds:t})=>sh({userIds:t,roleId:s.id}),onSuccess:(t,a)=>{P(m("Assigned [one 1 user|other :count users] to {role}",{values:{count:a.userIds.length,role:s.name}}))},onError:t=>B(t)})}function sh({roleId:s,userIds:t}){return w.post(`roles/${s}/add-users`,{userIds:t}).then(a=>a.data)}const ui={key:"name",allowsSorting:!0,sortingKey:"email",header:()=>e.jsx(r,{message:"User"}),body:s=>e.jsx(qe,{image:s.avatar,label:s.display_name,description:s.email}),width:"col-w-3"},th=[ui,{key:"first_name",allowsSorting:!0,header:()=>e.jsx(r,{message:"First name"}),body:s=>s.first_name},{key:"last_name",allowsSorting:!0,header:()=>e.jsx(r,{message:"Last name"}),body:s=>s.last_name},{key:"created_at",allowsSorting:!0,header:()=>e.jsx(r,{message:"Assigned at"}),body:s=>e.jsx(ce,{date:s.created_at})}],ah=[ui];function nh({role:s}){const t=as();return s.guests||s.type==="workspace"?e.jsx("div",{className:"pt-30 pb-10",children:e.jsx(ue,{image:Ps,title:e.jsx(r,{message:"Users can't be assigned to this role"})})}):e.jsx(Yl,{endpoint:"users",columns:t?ah:th,queryParams:{roleId:`${s.id}`},actions:e.jsx(rh,{role:s}),selectedActions:e.jsx(ih,{role:s}),emptyStateMessage:e.jsx(ue,{image:Ps,title:e.jsx(r,{message:"No users have been assigned to this role yet"}),filteringTitle:e.jsx(r,{message:"No matching users"})})})}function rh({role:s}){const t=eh(s);return e.jsxs(z,{type:"modal",children:[e.jsx(f,{variant:"flat",color:"primary",disabled:t.isPending,children:e.jsx(r,{message:"Assign user"})}),e.jsx(Jg,{onUserSelected:a=>{t.mutate({userIds:[a.id]},{onSuccess:()=>{k.invalidateQueries({queryKey:K("users",{roleId:`${s.id}`})})}})}})]})}function ih({role:s}){const t=Xg(s),{selectedRows:a}=Rn();return e.jsxs(z,{type:"modal",onClose:n=>{n&&t.mutate({userIds:a},{onSuccess:()=>{k.invalidateQueries({queryKey:K("users",{roleId:`${s.id}`})})}})},children:[e.jsx(f,{variant:"flat",color:"danger",disabled:t.isPending,children:e.jsx(r,{message:"Remove users"})}),e.jsx(xe,{title:e.jsx(r,{message:"Remove [one 1 user|other :count users] from “:name“ role?",values:{count:a.length,name:s.name}}),body:e.jsx(r,{message:"This will permanently remove the users."}),confirm:e.jsx(r,{message:"Remove"}),isDanger:!0})]})}function lh(){const s=Kg();return s.status!=="success"?e.jsx(Fe,{}):e.jsx(oh,{role:s.data.role})}function oh({role:s}){const t=q({defaultValues:s}),a=Gg();return e.jsx(os,{form:t,onSubmit:n=>{a.mutate(n)},title:e.jsx(r,{message:"Edit “:name“ role",values:{name:s.name}}),isLoading:a.isPending,children:e.jsxs(ht,{isLazy:!0,children:[e.jsxs(xt,{children:[e.jsx(Ue,{children:e.jsx(r,{message:"Settings"})}),e.jsx(Ue,{children:e.jsx(r,{message:"Users"})})]}),e.jsxs(ti,{className:"pt-20",children:[e.jsx(at,{children:e.jsx(di,{isInternal:s.internal})}),e.jsx(at,{children:e.jsx(nh,{role:s})})]})]})})}const ch="roles";function dh(s){const{trans:t}=T();return F({mutationFn:a=>uh(a),onSuccess:()=>{P(t(m("Created new role"))),k.invalidateQueries({queryKey:K("roles")})},onError:a=>te(a,s)})}function uh({id:s,...t}){return w.post(ch,t).then(a=>a.data)}function mh(){const s=q({defaultValues:{type:"sitewide"}}),t=dh(s),a=Z();return e.jsx(os,{form:s,onSubmit:n=>{t.mutate(n,{onSuccess:i=>{a(`/admin/roles/${i.role.id}/edit`)}})},title:e.jsx(r,{message:"Add new role"}),isLoading:t.isPending,children:e.jsx(di,{})})}const gh=s=>[{key:"type",label:m("Type"),description:m("Type of the tag"),defaultOperator:G.ne,control:{type:he.Select,defaultValue:s[0].name,options:s.map(t=>({key:t.name,label:m(t.name),value:t.name}))}},Oe({description:m("Date tag was created")}),Qe({description:m("Date tag was last updated")})],mi=""+new URL("software-engineer-ba026106.svg",import.meta.url).href;function gi({form:s,onSubmit:t,formId:a}){const{tags:{types:n}}=g.useContext(ts),i=s.watch("type"),l=!!n.find(o=>o.name===i&&o.system);return e.jsxs(me,{id:a,form:s,onSubmit:t,children:[e.jsx(j,{name:"name",label:e.jsx(r,{message:"Name"}),description:e.jsx(r,{message:"Unique tag identifier."}),className:"mb-20",required:!0,autoFocus:!0}),e.jsx(j,{name:"display_name",label:e.jsx(r,{message:"Display name"}),description:e.jsx(r,{message:"User friendly tag name."}),className:"mb-20"}),e.jsx(M,{label:e.jsx(r,{message:"Type"}),name:"type",selectionMode:"single",disabled:l,children:n.filter(o=>!o.system).map(o=>e.jsx(x,{value:o.name,children:e.jsx(r,{message:o.name})},o.name))})]})}function hh(s){const{trans:t}=T();return F({mutationFn:a=>xh(a),onSuccess:()=>{P(t(m("Tag created"))),k.invalidateQueries({queryKey:K("tags")})},onError:a=>te(a,s)})}function xh(s){return s.name=ia(s.name),w.post("tags",s).then(t=>t.data)}function ph(){const{close:s,formId:t}=H(),{tags:{types:a}}=g.useContext(ts),n=q({defaultValues:{type:a[0].name}}),i=hh(n);return e.jsxs(U,{children:[e.jsx(Q,{children:e.jsx(r,{message:"Add new tag"})}),e.jsx(W,{children:e.jsx(gi,{formId:t,form:n,onSubmit:l=>{i.mutate(l,{onSuccess:()=>{s()}})}})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:()=>{s()},children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{form:t,disabled:i.isPending,variant:"flat",color:"primary",type:"submit",children:e.jsx(r,{message:"Save"})})]})]})}function jh(s){const{trans:t}=T();return F({mutationFn:a=>fh(a),onSuccess:()=>{P(t(m("Tag updated"))),k.invalidateQueries({queryKey:K("tags")})},onError:a=>te(a,s)})}function fh({id:s,...t}){return t.name&&(t.name=ia(t.name)),w.put(`tags/${s}`,t).then(a=>a.data)}function bh({tag:s}){const{close:t,formId:a}=H(),n=q({defaultValues:{id:s.id,name:s.name,display_name:s.display_name,type:s.type}}),i=jh(n);return e.jsxs(U,{children:[e.jsx(Q,{children:e.jsx(r,{message:"Update “:name“ tag",values:{name:s.name}})}),e.jsx(W,{children:e.jsx(gi,{formId:a,form:n,onSubmit:l=>{i.mutate(l,{onSuccess:()=>{t()}})}})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:()=>{t()},children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{form:a,disabled:i.isPending,variant:"flat",color:"primary",type:"submit",children:e.jsx(r,{message:"Save"})})]})]})}const vh=[{key:"name",allowsSorting:!0,visibleInMode:"all",width:"flex-3 min-w-200",header:()=>e.jsx(r,{message:"Name"}),body:s=>s.name},{key:"type",allowsSorting:!0,header:()=>e.jsx(r,{message:"Type"}),body:s=>s.type},{key:"display_name",allowsSorting:!0,header:()=>e.jsx(r,{message:"Display name"}),body:s=>s.display_name},{key:"updated_at",allowsSorting:!0,width:"w-100",header:()=>e.jsx(r,{message:"Last updated"}),body:s=>e.jsx(ce,{date:s.updated_at})},{key:"actions",header:()=>e.jsx(r,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-42 flex-shrink-0",visibleInMode:"all",body:s=>e.jsxs(z,{type:"modal",children:[e.jsx(_,{size:"md",className:"text-muted",children:e.jsx(_e,{})}),e.jsx(bh,{tag:s})]})}];function yh(){const{tags:s}=g.useContext(ts),t=g.useMemo(()=>gh(s.types),[s.types]);return e.jsx(je,{endpoint:"tags",title:e.jsx(r,{message:"Tags"}),columns:vh,filters:t,actions:e.jsx(wh,{}),selectedActions:e.jsx(De,{}),emptyStateMessage:e.jsx(ue,{image:mi,title:e.jsx(r,{message:"No tags have been created yet"}),filteringTitle:e.jsx(r,{message:"No matching tags"})})})}function wh(){return e.jsx(e.Fragment,{children:e.jsxs(z,{type:"modal",children:[e.jsx(Se,{children:e.jsx(r,{message:"Add new tag"})}),e.jsx(ph,{})]})})}const hi=R(e.jsx("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5C19.17 14.87 15.79 17 12 17s-7.17-2.13-8.82-5.5C4.83 8.13 8.21 6 12 6m0-2C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4zm0 5c1.38 0 2.5 1.12 2.5 2.5S13.38 14 12 14s-2.5-1.12-2.5-2.5S10.62 9 12 9m0-2c-2.48 0-4.5 2.02-4.5 4.5S9.52 16 12 16s4.5-2.02 4.5-4.5S14.48 7 12 7z"}),"VisibilityOutlined"),Sh=""+new URL("upload-cabfc914.svg",import.meta.url).href,kh={key:"type",label:m("Type"),description:m("Type of the file"),defaultOperator:G.eq,control:{type:he.Select,defaultValue:"05",options:[{key:"02",label:m("Text"),value:"text"},{key:"03",label:m("Audio"),value:"audio"},{key:"04",label:m("Video"),value:"video"},{key:"05",label:m("Image"),value:"image"},{key:"06",label:m("PDF"),value:"pdf"},{key:"07",label:m("Spreadsheet"),value:"spreadsheet"},{key:"08",label:m("Word Document"),value:"word"},{key:"09",label:m("Photoshop"),value:"photoshop"},{key:"10",label:m("Archive"),value:"archive"},{key:"11",label:m("Folder"),value:"folder"}]}},Nh=[kh,{key:"public",label:m("Visibility"),description:m("Whether file is publicly accessible"),defaultOperator:G.eq,control:{type:he.Select,defaultValue:"01",options:[{key:"01",label:m("Private"),value:!1},{key:"02",label:m("Public"),value:!0}]}},Oe({description:m("Date file was uploaded")}),Qe({description:m("Date file was last changed")}),{key:"owner_id",label:m("Uploader"),description:m("User that this file was uploaded by"),defaultOperator:G.eq,control:{type:he.SelectModel,model:ha}}],Ch=[{key:"name",allowsSorting:!0,visibleInMode:"all",width:"flex-3 min-w-200",header:()=>e.jsx(r,{message:"Name"}),body:s=>e.jsxs(g.Fragment,{children:[e.jsx("div",{className:"overflow-x-hidden overflow-ellipsis",children:s.name}),e.jsx("div",{className:"text-muted text-xs overflow-x-hidden overflow-ellipsis",children:s.file_name})]})},{key:"owner_id",allowsSorting:!0,width:"flex-3 min-w-200",header:()=>e.jsx(r,{message:"Uploader"}),body:s=>{var a;const t=(a=s.users)==null?void 0:a[0];return t?e.jsx(qe,{image:t.avatar,label:t.display_name,description:t.email}):null}},{key:"type",width:"w-100 flex-shrink-0",allowsSorting:!0,header:()=>e.jsx(r,{message:"Type"}),body:s=>e.jsxs("div",{className:"flex items-center gap-12",children:[e.jsx(Kn,{type:s.type,className:"w-24 h-24 overflow-hidden"}),e.jsx("div",{className:"capitalize",children:s.type})]})},{key:"public",allowsSorting:!0,width:"w-60 flex-shrink-0",header:()=>e.jsx(r,{message:"Public"}),body:s=>s.public?e.jsx(Rs,{className:"icon-md text-positive"}):e.jsx(ye,{className:"icon-md text-danger"})},{key:"file_size",allowsSorting:!0,maxWidth:"max-w-100",header:()=>e.jsx(r,{message:"File size"}),body:s=>e.jsx(ga,{bytes:s.file_size})},{key:"updated_at",allowsSorting:!0,width:"w-100",header:()=>e.jsx(r,{message:"Last updated"}),body:s=>e.jsx(ce,{date:s.updated_at})},{key:"actions",header:()=>e.jsx(r,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-42 flex-shrink-0",visibleInMode:"all",body:s=>e.jsxs(z,{type:"modal",children:[e.jsx(_,{size:"md",className:"text-muted",children:e.jsx(hi,{})}),e.jsx(ho,{entries:[s]})]})}];function _h(){return e.jsx(je,{endpoint:"file-entries",title:e.jsx(r,{message:"Uploaded files and folders"}),columns:Ch,filters:Nh,selectedActions:e.jsx(De,{}),emptyStateMessage:e.jsx(ue,{image:Sh,title:e.jsx(r,{message:"Nothing has been uploaded yet"}),filteringTitle:e.jsx(r,{message:"No matching files or folders"})})})}const Ah=[{key:"ends_at",label:m("Status"),description:m("Whether subscription is active or cancelled"),defaultOperator:G.eq,control:{type:he.Select,defaultValue:"active",options:[{key:"active",label:m("Active"),value:{value:null,operator:G.eq}},{key:"cancelled",label:m("Cancelled"),value:{value:null,operator:G.ne}}]}},{control:{type:he.Select,defaultValue:"stripe",options:[{key:"stripe",label:m("Stripe"),value:"stripe"},{key:"paypal",label:m("PayPal"),value:"paypal"},{key:"none",label:m("None"),value:"none"}]},key:"gateway_name",label:m("Gateway"),description:m("With which payment provider was subscription created"),defaultOperator:G.eq},Xl({key:"renews_at",label:m("Renew date"),description:m("Date subscription will renew")}),Oe({description:m("Date subscription was created")}),Qe({description:m("Date subscription was last updated")})],Eh=""+new URL("subscriptions-7eacea42.svg",import.meta.url).href;function Ih(s){const{trans:t}=T();return F({mutationFn:a=>Th(a),onSuccess:()=>{P(t(m("Subscription updated"))),k.invalidateQueries({queryKey:K("billing/subscriptions")})},onError:a=>te(a,s)})}function Th({id:s,...t}){return w.put(`billing/subscriptions/${s}`,t).then(a=>a.data)}function xi({form:s,onSubmit:t,formId:a}){var o,c;const n=yl(),i=s.watch("product_id"),l=(o=n.data)==null?void 0:o.products.find(d=>d.id===i);return e.jsxs(me,{id:a,form:s,onSubmit:t,children:[e.jsx(Ln,{name:"user_id",className:"mb-20",endpoint:"normalized-models/user",label:e.jsx(r,{message:"User"})}),e.jsx(M,{name:"product_id",selectionMode:"single",className:"mb-20",label:e.jsx(r,{message:"Plan"}),children:(c=n.data)==null?void 0:c.products.filter(d=>!d.free).map(d=>e.jsx(x,{value:d.id,children:e.jsx(r,{message:d.name})},d.id))}),!(l!=null&&l.free)&&e.jsx(M,{name:"price_id",selectionMode:"single",className:"mb-20",label:e.jsx(r,{message:"Price"}),children:l==null?void 0:l.prices.map(d=>e.jsx(x,{value:d.id,children:e.jsx(la,{price:d})},d.id))}),e.jsx(j,{inputElementType:"textarea",rows:3,name:"description",label:e.jsx(r,{message:"Description"}),className:"mb-20"}),e.jsx(Da,{className:"mb-20",name:"renews_at",granularity:"day",label:e.jsx(r,{message:"Renews at"}),description:e.jsx(r,{message:"This will only change local records. User will continue to be billed on their original cycle on the payment gateway."})}),e.jsx(Da,{className:"mb-20",name:"ends_at",granularity:"day",label:e.jsx(r,{message:"Ends at"}),description:e.jsx(r,{message:"This will only change local records. User will continue to be billed on their original cycle on the payment gateway."})})]})}function Fh({subscription:s}){const{close:t,formId:a}=H(),n=q({defaultValues:{id:s.id,product_id:s.product_id,price_id:s.price_id,description:s.description,renews_at:s.renews_at,ends_at:s.ends_at,user_id:s.user_id}}),i=Ih(n);return e.jsxs(U,{size:"md",children:[e.jsx(Q,{children:e.jsx(r,{message:"Update subscription"})}),e.jsx(W,{children:e.jsx(xi,{formId:a,form:n,onSubmit:l=>{i.mutate(l,{onSuccess:()=>{t()}})}})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:()=>{t()},children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{form:a,disabled:i.isPending,variant:"flat",color:"primary",type:"submit",children:e.jsx(r,{message:"Save"})})]})]})}const pi="billing/subscriptions";function Ph(s){const{trans:t}=T();return F({mutationFn:a=>zh(a),onSuccess:()=>{P(t(m("Subscription created"))),k.invalidateQueries({queryKey:K(pi)})},onError:a=>te(a,s)})}function zh(s){return w.post(pi,s).then(t=>t.data)}function Dh(){const{close:s,formId:t}=H(),a=q({}),n=Ph(a);return e.jsxs(U,{children:[e.jsx(Q,{children:e.jsx(r,{message:"Add new subscription"})}),e.jsx(W,{children:e.jsx(xi,{formId:t,form:a,onSubmit:i=>{n.mutate(i,{onSuccess:()=>{s()}})}})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:()=>{s()},children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{form:t,disabled:n.isPending,variant:"flat",color:"primary",type:"submit",children:e.jsx(r,{message:"Save"})})]})]})}const Mh=R(e.jsx("path",{d:"M6 19h4V5H6v14zm8-14v14h4V5h-4z"}),"PauseOutlined"),$h=R(e.jsx("path",{d:"M10 8.64 15.27 12 10 15.36V8.64M8 5v14l11-7L8 5z"}),"PlayArrowOutlined"),vt="billing/subscriptions",Rh=[{key:"user_id",allowsSorting:!0,width:"flex-3 min-w-200",visibleInMode:"all",header:()=>e.jsx(r,{message:"Customer"}),body:s=>s.user&&e.jsx(qe,{image:s.user.avatar,label:s.user.display_name,description:s.user.email})},{key:"status",width:"w-100 flex-shrink-0",header:()=>e.jsx(r,{message:"Status"}),body:s=>e.jsx(Xt,{size:"xs",color:s.valid?"positive":void 0,radius:"rounded",className:"w-max",children:s.gateway_status})},{key:"product_id",allowsSorting:!0,header:()=>e.jsx(r,{message:"Plan"}),body:s=>{var t;return(t=s.product)==null?void 0:t.name}},{key:"gateway_name",allowsSorting:!0,header:()=>e.jsx(r,{message:"Gateway"}),body:s=>e.jsx("span",{className:"capitalize",children:s.gateway_name})},{key:"renews_at",allowsSorting:!0,header:()=>e.jsx(r,{message:"Renews at"}),body:s=>e.jsx(ce,{date:s.renews_at})},{key:"ends_at",allowsSorting:!0,header:()=>e.jsx(r,{message:"Ends at"}),body:s=>e.jsx(ce,{date:s.ends_at})},{key:"created_at",allowsSorting:!0,header:()=>e.jsx(r,{message:"Created at"}),body:s=>e.jsx(ce,{date:s.created_at})},{key:"actions",header:()=>e.jsx(r,{message:"Actions"}),hideHeader:!0,align:"end",visibleInMode:"all",width:"w-128 flex-shrink-0",body:s=>e.jsx(qh,{subscription:s})}];function Lh(){return e.jsx(je,{endpoint:vt,title:e.jsx(r,{message:"Subscriptions"}),columns:Rh,filters:Ah,actions:e.jsx(Oh,{}),enableSelection:!1,selectedActions:e.jsx(De,{}),queryParams:{with:"product"},emptyStateMessage:e.jsx(ue,{image:Eh,title:e.jsx(r,{message:"No subscriptions have been created yet"}),filteringTitle:e.jsx(r,{message:"No matching subscriptions"})})})}function Oh(){return e.jsx(e.Fragment,{children:e.jsxs(z,{type:"modal",children:[e.jsx(Se,{children:e.jsx(r,{message:"Add new subscription"})}),e.jsx(Dh,{})]})})}function qh({subscription:s}){return e.jsxs(g.Fragment,{children:[e.jsxs(z,{type:"modal",children:[e.jsx(_,{size:"md",className:"text-muted",children:e.jsx(_e,{})}),e.jsx(Fh,{subscription:s})]}),s.cancelled&&s.on_grace_period?e.jsx(Bh,{subscription:s}):null,s.active?e.jsx(Vh,{subscription:s}):null,e.jsx(Hh,{subscription:s})]})}function Vh({subscription:s}){const t=Gn(),a=()=>{t.mutate({subscriptionId:s.id},{onSuccess:()=>{k.invalidateQueries({queryKey:K(vt)})}})};return e.jsxs(z,{type:"modal",onClose:n=>{n&&a()},children:[e.jsx(de,{label:e.jsx(r,{message:"Cancel subscription"}),children:e.jsx(_,{size:"md",className:"text-muted",disabled:t.isPending,children:e.jsx(Mh,{})})}),e.jsx(xe,{title:e.jsx(r,{message:"Cancel subscription"}),body:e.jsxs("div",{children:[e.jsx(r,{message:"Are you sure you want to cancel this subscription?"}),e.jsx("div",{className:"mt-10 text-sm font-semibold",children:e.jsx(r,{message:"This will put user on grace period until their next scheduled renewal date. Subscription can be renewed until that date by user or from admin area."})})]}),confirm:e.jsx(r,{message:"Confirm"})})]})}function Bh({subscription:s}){const t=Co(),a=()=>{t.mutate({subscriptionId:s.id},{onSuccess:()=>{k.invalidateQueries({queryKey:K(vt)})}})};return e.jsxs(z,{type:"modal",onClose:n=>{n&&a()},children:[e.jsx(de,{label:e.jsx(r,{message:"Renew subscription"}),children:e.jsx(_,{size:"md",className:"text-muted",onClick:a,disabled:t.isPending,children:e.jsx($h,{})})}),e.jsx(xe,{title:e.jsx(r,{message:"Resume subscription"}),body:e.jsxs("div",{children:[e.jsx(r,{message:"Are you sure you want to resume this subscription?"}),e.jsx("div",{className:"mt-10 text-sm font-semibold",children:e.jsx(r,{message:"This will put user on their original plan and billing cycle."})})]}),confirm:e.jsx(r,{message:"Confirm"})})]})}function Hh({subscription:s}){const t=Gn(),a=()=>{t.mutate({subscriptionId:s.id,delete:!0},{onSuccess:()=>{k.invalidateQueries({queryKey:K(vt)})}})};return e.jsxs(z,{type:"modal",onClose:n=>{n&&a()},children:[e.jsx(de,{label:e.jsx(r,{message:"Delete subscription"}),children:e.jsx(_,{size:"md",className:"text-muted",disabled:t.isPending,children:e.jsx(ye,{})})}),e.jsx(xe,{isDanger:!0,title:e.jsx(r,{message:"Delete subscription"}),body:e.jsxs("div",{children:[e.jsx(r,{message:"Are you sure you want to delete this subscription?"}),e.jsx("div",{className:"mt-10 text-sm font-semibold",children:e.jsx(r,{message:"This will permanently delete the subscription and immediately cancel it on billing gateway. Subscription will not be renewable anymore."})})]}),confirm:e.jsx(r,{message:"Confirm"})})]})}const Uh=R(e.jsx("path",{d:"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"}),"SyncOutlined");function Kh(){const{trans:s}=T();return F({mutationFn:()=>Wh(),onSuccess:()=>{P(s(m("Plans synced")))},onError:t=>B(t,m("Could not sync plans"))})}function Wh(){return w.post("billing/products/sync").then(s=>s.data)}const Gh=s=>`billing/products/${s}`;function Qh(){const{trans:s}=T();return F({mutationFn:t=>Jh(t),onSuccess:()=>{P(s(m("Plan deleted"))),k.invalidateQueries({queryKey:K("billing/products")})},onError:t=>B(t)})}function Jh({productId:s}){return w.delete(Gh(s)).then(t=>t.data)}const Yh=[{key:"subscriptions",label:m("Subscriptions"),description:m("Whether plan has any active subscriptions"),defaultOperator:G.eq,control:{type:he.Select,defaultValue:"01",options:[{key:"01",label:m("Has active subscriptions"),value:{value:"*",operator:G.has}},{key:"02",label:m("Does not have active subscriptions"),value:{value:"*",operator:G.doesntHave}}]}},Oe({description:m("Date plan was created")}),Qe({description:m("Date plan was last updated")})],Xh=[{key:"name",allowsSorting:!0,visibleInMode:"all",header:()=>e.jsx(r,{message:"Name"}),body:s=>{const t=s.prices[0];return e.jsx(qe,{label:s.name,description:s.free?e.jsx(r,{message:"Free"}):e.jsx(la,{price:t})})}},{key:"created_at",allowsSorting:!0,maxWidth:"max-w-100",header:()=>e.jsx(r,{message:"Created"}),body:s=>e.jsx(ce,{date:s.created_at})},{key:"updated_at",allowsSorting:!0,maxWidth:"max-w-100",header:()=>e.jsx(r,{message:"Last updated"}),body:s=>e.jsx(ce,{date:s.updated_at})},{key:"actions",header:()=>e.jsx(r,{message:"Actions"}),visibleInMode:"all",hideHeader:!0,align:"end",maxWidth:"max-w-84",body:s=>e.jsxs(g.Fragment,{children:[e.jsx(_,{size:"md",className:"text-muted",elementType:D,to:`/admin/plans/${s.id}/edit`,children:e.jsx(_e,{})}),e.jsx(ex,{product:s})]})}];function Zh(){const s=Z();return e.jsx(je,{endpoint:"billing/products",title:e.jsx(r,{message:"Subscription plans"}),columns:Xh,actions:e.jsx(sx,{}),enableSelection:!1,filters:Yh,onRowAction:t=>{s(`/admin/plans/${t.id}/edit`)},emptyStateMessage:e.jsx(ue,{image:mi,title:e.jsx(r,{message:"No plans have been created yet"}),filteringTitle:e.jsx(r,{message:"No matching plans"})})})}function ex({product:s}){const t=Qh();return e.jsxs(z,{type:"modal",onClose:a=>{a&&t.mutate({productId:s.id})},children:[e.jsx(de,{label:e.jsx(r,{message:"Delete plan"}),children:e.jsx(_,{size:"md",className:"text-muted",disabled:t.isPending,children:e.jsx(ws,{})})}),e.jsx(xe,{title:e.jsx(r,{message:"Delete plan"}),body:e.jsx(r,{message:"Are you sure you want to delete this plan?"}),confirm:e.jsx(r,{message:"Delete"})})]})}function sx(){const s=Kh();return e.jsxs(g.Fragment,{children:[e.jsx(de,{label:e.jsx(r,{message:"Sync plans with Stripe & PayPal"}),children:e.jsx(_,{color:"primary",variant:"outline",size:"sm",disabled:s.isPending,onClick:()=>{s.mutate()},children:e.jsx(Uh,{})})}),e.jsx(Se,{elementType:D,to:"/admin/plans/new",children:e.jsx(r,{message:"Add new plan"})})]})}const ji=s=>`billing/products/${s}`;function tx(){const{productId:s}=X();return ne({queryKey:[ji(s)],queryFn:()=>ax(s)})}function ax(s){return w.get(ji(s)).then(t=>t.data)}const Wt=[{key:"day1",label:m("Daily"),interval:"day",interval_count:1},{key:"week1",label:m("Weekly"),interval:"week",interval_count:1},{key:"month1",label:m("Monthly"),interval:"month",interval_count:1},{key:"month3",label:m("Every 3 months"),interval:"month",interval_count:3},{key:"month6",label:m("Every 6 months"),interval:"month",interval_count:6},{key:"year1",label:m("Yearly"),interval:"year",interval_count:1},{key:"custom",label:m("Custom"),interval:null,interval_count:null}];function nx({index:s,onRemovePrice:t}){const{trans:a}=T(),n=we(["currencies"]),i=g.useMemo(()=>{var v;return(v=n.data)!=null&&v.currencies?Object.values(n.data.currencies):[]},[n.data]),{watch:l,getValues:o}=N(),c=!l("id"),d=l(`prices.${s}.id`)==null,u=l(`prices.${s}.subscriptions_count`)||0,[h,p]=g.useState(()=>{const v=o(`prices.${s}.interval`),S=o(`prices.${s}.interval_count`),C=Wt.find(y=>y.key===`${v}${S}`);return C?C.key:"custom"}),b=c||d||!u;return e.jsxs(g.Fragment,{children:[!b&&e.jsx("p",{className:"text-muted text-sm max-w-500 mb-20",children:e.jsx(r,{message:"This price can't modified or deleted, because it has [one 1 subscriber|other :count subscribers]. You can instead add a new price.",values:{count:u}})}),e.jsx(j,{required:!0,disabled:!b,label:e.jsx(r,{message:"Amount"}),type:"number",min:.1,step:.01,name:`prices.${s}.amount`,className:"mb-20"}),e.jsx(M,{required:!0,disabled:!b,label:e.jsx(r,{message:"Currency"}),name:`prices.${s}.currency`,items:i,showSearchField:!0,searchPlaceholder:a(m("Search currencies")),selectionMode:"single",className:"mb-20",children:v=>e.jsx(x,{value:v.code,children:`${v.code}: ${v.name}`},v.code)}),e.jsx(rx,{disabled:!b,index:s,value:h,onValueChange:p}),h==="custom"&&e.jsx(ix,{disabled:!b,index:s}),e.jsx("div",{className:"text-right",children:e.jsx(f,{size:"xs",variant:"outline",color:"danger",disabled:!b,onClick:()=>{t()},children:e.jsx(r,{message:"Delete price"})})})]})}function rx({index:s,value:t,onValueChange:a,disabled:n}){const{setValue:i}=N();return e.jsx(ys,{label:e.jsx(r,{message:"Billing period"}),disabled:n,className:"mb-20",selectionMode:"single",selectedValue:t,onSelectionChange:l=>{if(a(l),l!=="custom"){const o=Wt.find(c=>c.key===l);o&&(i(`prices.${s}.interval`,o.interval),i(`prices.${s}.interval_count`,o.interval_count))}},children:Wt.map(l=>e.jsx(x,{value:l.key,children:e.jsx(r,{...l.label})},l.key))})}function ix({index:s,disabled:t}){const{watch:a}=N(),n=a(`prices.${s}.interval`);let i;return n==="day"?i=365:n==="week"?i=52:i=12,e.jsxs("div",{className:"flex border rounded w-min",children:[e.jsx("div",{className:"px-18 flex items-center text-sm",children:e.jsx(r,{message:"Every"})}),e.jsx(j,{inputShadow:"shadow-none",inputBorder:"border-none",className:"border-l border-r w-80",name:`prices.${s}.interval_count`,type:"number",min:1,max:i,disabled:t,required:!0}),e.jsxs(M,{inputShadow:"shadow-none",inputBorder:"border-none",name:`prices.${s}.interval`,selectionMode:"single",disabled:t,children:[e.jsx(x,{value:"day",children:e.jsx(r,{message:"Days"})}),e.jsx(x,{value:"week",children:e.jsx(r,{message:"Weeks"})}),e.jsx(x,{value:"month",children:e.jsx(r,{message:"Months"})})]})]})}function fi(){return e.jsxs(g.Fragment,{children:[e.jsx(j,{name:"name",label:e.jsx(r,{message:"Name"}),className:"mb-20",required:!0,autoFocus:!0}),e.jsx(j,{name:"description",label:e.jsx(r,{message:"Description"}),className:"mb-20",inputElementType:"textarea",rows:4}),e.jsxs(M,{name:"position",selectionMode:"single",label:e.jsx(r,{message:"Position in pricing table"}),className:"mb-20",children:[e.jsx(x,{value:0,children:e.jsx(r,{message:"First"})}),e.jsx(x,{value:1,children:e.jsx(r,{message:"Second"})}),e.jsx(x,{value:2,children:e.jsx(r,{message:"Third"})}),e.jsx(x,{value:3,children:e.jsx(r,{message:"Fourth"})}),e.jsx(x,{value:4,children:e.jsx(r,{message:"Fifth"})})]}),e.jsx(Ts,{className:"mb-30",name:"available_space",label:e.jsx(r,{message:"Allowed storage space"}),description:e.jsx(r,{values:{a:s=>e.jsx(D,{className:Hs,target:"_blank",to:"/admin/settings/uploading",children:s})},message:"Total storage space all user uploads are allowed to take up."})}),e.jsx(A,{name:"recommended",className:"mb-20",description:e.jsx(r,{message:"Plan will be displayed more prominently on pricing page."}),children:e.jsx(r,{message:"Recommend"})}),e.jsx(A,{name:"hidden",className:"mb-20",description:e.jsx(r,{message:"Plan will not be shown on pricing or upgrade pages."}),children:e.jsx(r,{message:"Hidden"})}),e.jsx(A,{name:"free",className:"mb-20",description:e.jsx(r,{message:"Will be assigned to all users, if they are not subscribed already."}),children:e.jsx(r,{message:"Free"})}),e.jsx(Gt,{children:e.jsx(r,{message:"Feature list"})}),e.jsx(lx,{}),e.jsx(ox,{}),e.jsx(Gt,{children:e.jsx(r,{message:"Permissions"})}),e.jsx(fa,{name:"permissions"})]})}function Gt({children:s}){return e.jsx("h2",{className:"mt-40 mb-20 text-base font-semibold",children:s})}function lx(){const{fields:s,append:t,remove:a}=pe({name:"feature_list"});return e.jsxs("div",{children:[s.map((n,i)=>e.jsxs("div",{className:"flex gap-10 mb-10",children:[e.jsx(j,{name:`feature_list.${i}.value`,size:"sm",className:"flex-auto"}),e.jsx(_,{size:"sm",color:"primary",className:"flex-shrink-0",onClick:()=>{a(i)},children:e.jsx(ye,{})})]},n.id)),e.jsx(f,{variant:"text",color:"primary",startIcon:e.jsx(Ce,{}),size:"xs",onClick:()=>{t({value:""})},children:e.jsx(r,{message:"Add another line"})})]})}function ox(){var l;const{watch:s,formState:{errors:t}}=N(),{fields:a,append:n,remove:i}=pe({name:"prices",keyName:"key"});return s("free")?null:e.jsxs(g.Fragment,{children:[e.jsx(Gt,{children:e.jsx(r,{message:"Pricing"})}),((l=t.prices)==null?void 0:l.message)&&e.jsx("div",{className:"text-sm text-danger mb-20",children:t.prices.message}),e.jsx(ns,{variant:"outline",className:"mb-10",children:a.map((o,c)=>e.jsx(be,{label:e.jsx(la,{price:o}),children:e.jsx(nx,{index:c,onRemovePrice:()=>{i(c)}})},o.key))}),e.jsx(f,{variant:"text",color:"primary",startIcon:e.jsx(Ce,{}),size:"xs",onClick:()=>{n({currency:"USD",amount:1,interval_count:1,interval:"month"})},children:e.jsx(r,{message:"Add another price"})})]})}const bi=s=>`billing/products/${s}`;function cx(s){const{trans:t}=T(),a=Z();return F({mutationFn:n=>dx(n),onSuccess:n=>{P(t(m("Plan updated"))),k.invalidateQueries({queryKey:[bi(n.product.id)]}),k.invalidateQueries({queryKey:K("billing/products")}),a("/admin/plans")},onError:n=>te(n,s)})}function dx({id:s,...t}){const a={...t,feature_list:t.feature_list.map(n=>n.value)};return w.put(bi(s),a).then(n=>n.data)}function ux(){const s=tx();return s.status!=="success"?e.jsx(Fe,{}):e.jsx(mx,{product:s.data.product})}function mx({product:s}){const t=q({defaultValues:{...s,feature_list:s.feature_list.map(n=>({value:n}))}}),a=cx(t);return e.jsx(os,{form:t,onSubmit:n=>{a.mutate(n)},title:e.jsx(r,{message:"Edit “:name“ plan",values:{name:s.name}}),isLoading:a.isPending,children:e.jsx(fi,{})})}const vi="billing/products";function gx(s){const{trans:t}=T(),a=Z();return F({mutationFn:n=>hx(n),onSuccess:()=>{P(t(m("Plan created"))),k.invalidateQueries({queryKey:[vi]}),k.invalidateQueries({queryKey:K("billing/products")}),a("/admin/plans")},onError:n=>te(n,s)})}function hx(s){const t={...s,feature_list:s.feature_list.map(a=>a.value)};return w.post(vi,t).then(a=>a.data)}function xx(){const s=q({defaultValues:{free:!1,recommended:!1}}),t=gx(s);return e.jsx(os,{form:s,onSubmit:a=>{t.mutate(a)},title:e.jsx(r,{message:"Create new plan"}),isLoading:t.isPending,children:e.jsx(fi,{})})}function px(){return e.jsxs(ge,{title:e.jsx(r,{message:"GDPR"}),description:e.jsx(r,{message:"Configure settings related to EU General Data Protection Regulation."}),children:[e.jsx(jx,{}),e.jsx(Re,{}),e.jsx(fx,{})]})}function jx(){const{watch:s}=N(),t=s("client.cookie_notice.enable");return e.jsxs("div",{children:[e.jsx(A,{name:"client.cookie_notice.enable",className:"mb-20",description:e.jsx(r,{message:"Whether cookie notice should be shown automatically to users from EU until it is accepted."}),children:e.jsx(r,{message:"Enable cookie notice"})}),t&&e.jsxs(g.Fragment,{children:[e.jsxs("div",{className:"mb-20 border-b pb-6",children:[e.jsx("div",{className:"mb-20 border-b pb-10 text-sm font-medium",children:e.jsx(r,{message:"Information button"})}),e.jsx(ba,{hideRoleAndPermissionFields:!0,formPathPrefix:"client.cookie_notice.button"})]}),e.jsxs(M,{name:"client.cookie_notice.position",selectionMode:"single",label:e.jsx(r,{message:"Cookie notice position"}),className:"mb-20",children:[e.jsx(x,{value:"top",children:e.jsx(r,{message:"Top"})}),e.jsx(x,{value:"bottom",children:e.jsx(r,{message:"Bottom"})})]})]})]})}function fx(){const{fields:s,append:t,remove:a}=pe({name:"client.registration.policies"});return e.jsxs(g.Fragment,{children:[e.jsx("div",{className:"mb-6 text-sm",children:e.jsx(r,{message:"Registration policies"})}),e.jsx("div",{className:"text-xs text-muted",children:e.jsx(r,{message:"Create policies that will be shown on registration page. User will be required to accept them by toggling a checkbox."})}),e.jsx(ns,{className:"mt-16",variant:"outline",children:s.map((n,i)=>e.jsx(be,{label:n.label,chevronPosition:"left",endAppend:e.jsx(_,{variant:"text",color:"danger",size:"sm",onClick:()=>{a(i)},children:e.jsx(ye,{})}),children:e.jsx(ba,{hideRoleAndPermissionFields:!0,formPathPrefix:`client.register_policies.${i}`})},n.id))}),e.jsxs(z,{type:"modal",onClose:n=>{n&&t(n)},children:[e.jsx(f,{className:"mt-12",variant:"link",color:"primary",startIcon:e.jsx(Ce,{}),size:"xs",children:e.jsx(r,{message:"Add another policy"})}),e.jsx(sr,{title:e.jsx(r,{message:"Add policy"})})]})]})}const yi=s=>["hc","categories","admin",s];function Qs(s){return ne({queryKey:yi(s),queryFn:()=>bx(s)})}function bx(s){return w.get("hc/categories",{params:{paginate:"simple",perPage:30,...s}}).then(t=>t.data)}function yt(){const{categoryId:s}=X();return s?{type:"section",parentId:s}:{type:"category"}}function vx(s){const{trans:t}=T(),a=Z();return F({mutationFn:n=>yx(n),onSuccess:async n=>{await k.invalidateQueries({queryKey:["hc","categories"]});const i=n.category.is_section?"sections":"categories";a(`/admin/hc/arrange/${i}/${n.category.id}`),P(t(n.category.is_section?m("Category created"):m("Section created")))},onError:n=>te(n,s)})}function yx(s){return w.post("hc/categories",s).then(t=>t.data)}function wi({name:s,label:t,description:a,className:n,defaultItem:i}){const{data:l}=we(["roles"]),o=(l==null?void 0:l.roles)||[];return o.length?e.jsxs(M,{background:"bg",label:t,name:s,description:a,className:n,valueClassName:"first:capitalize",selectionMode:"single",children:[i,o.map(c=>e.jsx(x,{value:c.id,capitalizeFirst:!0,children:e.jsx(r,{message:c.name})},c.id))]}):e.jsx("div",{className:I(n,"h-92")})}function Si({className:s,description:t}){return e.jsx(wi,{className:s,name:"visible_to_role",label:e.jsx(r,{message:"Visible to"}),description:t,defaultItem:e.jsx(x,{value:null,children:e.jsx(r,{message:"Everyone"})},"everyone-default")})}function ki({className:s,description:t}){return e.jsx(wi,{className:s,name:"managed_by_role",label:e.jsx(r,{message:"Managed by"}),description:t,defaultItem:e.jsx(x,{value:void 0,children:e.jsx(r,{message:"Admins"})},"admins-default")})}function Ni({form:s,onSubmit:t,formId:a,hideParentId:n}){const{data:i}=Qs({type:"category",compact:!0});return e.jsxs(me,{id:a,form:s,onSubmit:t,children:[e.jsx(j,{name:"name",label:e.jsx(r,{message:"Name"}),className:"mb-24",required:!0,autoFocus:!0}),e.jsx(Le,{children:e.jsx(Ls,{label:e.jsx(r,{message:"Image"}),name:"image",diskPrefix:"category_images",className:"mb-24"})}),e.jsx(j,{name:"description",label:e.jsx(r,{message:"Description"}),inputElementType:"textarea",rows:4,className:"mb-24"}),n&&e.jsx(M,{name:"parent_id",selectionMode:"single",label:"Parent category",className:"mb-24",children:i==null?void 0:i.pagination.data.map(l=>e.jsx(x,{value:l.id,children:e.jsx(r,{message:l.name})},l.id))}),e.jsx(Si,{className:"mb-24",description:e.jsx(r,{message:"Control who can see this category in help center"})}),e.jsx(ki,{description:e.jsx(r,{message:"Control who can edit this category"})})]})}function wx({parentId:s}){const{close:t,formId:a}=H(),n=q({defaultValues:{parent_id:s?parseInt(s):void 0}}),i=vx(n);return e.jsxs(U,{children:[e.jsx(Q,{children:s?e.jsx(r,{message:"Add new section"}):e.jsx(r,{message:"Add new category"})}),e.jsx(W,{children:e.jsx(Ni,{hideParentId:!!s,formId:a,form:n,onSubmit:l=>{i.mutate(l,{onSuccess:()=>t()})}})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:()=>{t()},children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{form:a,disabled:i.isPending,variant:"flat",color:"primary",type:"submit",children:e.jsx(r,{message:"Create"})})]})]})}function Ci({actionButton:s,query:t,children:a}){return e.jsxs("div",{className:"p-12 md:p-24",children:[e.jsxs("div",{className:"mb-18",children:[e.jsx(fs,{children:e.jsx(r,{message:"Help center"})}),e.jsxs("div",{className:"items-end justify-between gap-24 md:flex",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-light",children:e.jsx(r,{message:"Help center"})}),e.jsx("p",{className:"mt-2 text-sm text-muted",children:e.jsx(r,{message:"Arrange help center categories, sections and articles."})})]}),e.jsx("div",{className:"max-md:mt-12",children:s})]})]}),e.jsx("main",{children:t.data?a(t.data):e.jsx(oa,{query:t,loaderClassName:"absolute inset-0 m-auto"})})]})}function _i({category:s,section:t}){const a=Z();return!s&&!t?null:e.jsxs(Wn,{size:"sm",className:"-mx-8",children:[e.jsx(Es,{onSelected:()=>a("/admin/hc/arrange"),children:e.jsx(r,{message:"Categories"})}),s&&e.jsx(Es,{className:t?void 0:"text-primary",onSelected:()=>a(`/admin/hc/arrange/categories/${s.id}`),children:e.jsx(r,{message:s.name})}),t&&e.jsx(Es,{className:"text-primary",children:e.jsx(r,{message:t.name})})]})}function Ai({children:s}){return e.jsx("h2",{className:"mb-10 mt-20 text-sm font-semibold text-muted",children:s})}function Sx(){return En("((pointer: coarse))")}function Ei(s){const t=yi(yt());return F({mutationFn:a=>{const n=k.getQueryData(t).pagination.data.map(i=>i.id);return kx({parentId:a.parentId,ids:n})},onMutate:async({oldIndex:a,newIndex:n})=>{await k.cancelQueries({queryKey:t});const i=k.getQueryData(t);return k.setQueryData(t,l=>{const o={...l,pagination:{...l.pagination}};return o.pagination.data=ja(o.pagination.data,a,n),o}),{previousResponse:i}},onSuccess:async()=>{await k.invalidateQueries({queryKey:["hc","categories"]})},onError:(a,n,i)=>{B(a),k.setQueryData(t,i==null?void 0:i.previousResponse)}})}function kx(s){return w.post("hc/categories/reorder",s).then(t=>t.data)}const Nx=O.forwardRef((s,t)=>{const a=s.children,[n,i]=g.useState(null),l=g.useRef(null);return g.useImperativeHandle(t,()=>(o,c)=>{Rt.flushSync(()=>{i(a(o))}),c(l.current),requestAnimationFrame(()=>{i(null)})},[a]),n?Rt.createPortal(e.jsx("div",{style:{zIndex:-100,position:"absolute",top:0,left:-1e5},ref:l,children:n}),wl):null});function Ii({item:s,items:t,onSortEnd:a,onClick:n,onView:i,onEdit:l,onDelete:o,children:c,description:d}){const u=g.useRef(null),h=g.useRef(null),p=Sx(),b=Ei(),{sortableProps:v,dragHandleRef:S}=ir({ref:u,disabled:p??!1,item:s,items:t,type:"hcManagerSort",preview:h,onSortEnd:a});return e.jsxs("div",{className:"cursor:pointer mb-12 flex items-center gap-6 rounded-panel border p-12 transition-colors hover:border-primary",onClick:Sl(()=>n()),ref:u,...v,children:[!p&&e.jsx(_,{className:"text-muted",ref:S,disabled:b.isPending,onClick:C=>{C.preventDefault(),C.stopPropagation()},children:e.jsx(tr,{})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold",children:c}),d&&e.jsx("div",{className:"text-sm text-muted",children:d})]}),e.jsxs(Pe,{children:[e.jsx(_,{className:"ml-auto text-muted",onClick:C=>{C.preventDefault(),C.stopPropagation()},children:e.jsx(Ks,{})}),e.jsxs(ze,{children:[e.jsx(x,{value:"edit",onSelected:()=>l(),children:e.jsx(r,{message:"Edit"})}),e.jsx(x,{value:"sendToTop",onSelected:()=>{a(t.indexOf(s),0),document.documentElement.scrollTop=0},children:e.jsx(r,{message:"Send to top"})}),e.jsx(x,{value:"viewInHc",onSelected:()=>i(),children:e.jsx(r,{message:"View in help center"})}),e.jsx(x,{value:"delete",onSelected:()=>o(),children:e.jsx(r,{message:"Delete"})})]})]}),e.jsx(Cx,{name:c,ref:h})]})}const Cx=O.forwardRef(({name:s},t)=>e.jsx(Nx,{ref:t,children:()=>e.jsx("div",{className:"rounded bg-chip p-6 text-sm shadow",children:s})}));function Qt({title:s,description:t}){return e.jsx(Vs,{className:"mx-auto mt-40 max-w-450",image:e.jsx("div",{children:e.jsx(Yt,{size:"lg"})}),size:"sm",imageHeight:"h-auto",imageMargin:"mb-12",title:s,description:t})}function _x(){return F({mutationFn:s=>Ax(s),onSuccess:async()=>{await k.invalidateQueries({queryKey:["hc","categories"]}),P(m("Category deleted"))},onError:s=>B(s)})}function Ax({id:s}){return w.delete(`hc/categories/${s}`).then(t=>t.data)}function Ex(s){const{trans:t}=T();return F({mutationFn:a=>Ix(a),onSuccess:async a=>{await k.invalidateQueries({queryKey:["hc","categories"]}),a.category.is_section,P(t(a.category.is_section?m("Category updated"):m("Section updated")))},onError:a=>te(a,s)})}function Ix({id:s,...t}){return w.put(`hc/categories/${s}`,t).then(a=>a.data)}function Tx({category:s}){const{close:t,formId:a}=H(),n=q({defaultValues:{name:s.name,parent_id:s.is_section?s.parent_id:void 0,description:s.description,image:s.image,visible_to_role:s.visible_to_role,managed_by_role:s.managed_by_role}}),i=Ex(n);return e.jsxs(U,{children:[e.jsx(Q,{children:s.is_section?e.jsx(r,{message:"Update section"}):e.jsx(r,{message:"Update category"})}),e.jsx(W,{children:e.jsx(Ni,{hideParentId:s.is_section,formId:a,form:n,onSubmit:l=>{i.mutate({...l,id:s.id},{onSuccess:()=>t()})}})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:()=>{t()},children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{form:a,disabled:i.isPending,variant:"flat",color:"primary",type:"submit",children:e.jsx(r,{message:"Update"})})]})]})}function en(){const s=yt(),t=Qs(s);return e.jsx(Ci,{query:t,actionButton:e.jsxs(z,{type:"modal",children:[e.jsx(f,{variant:"flat",color:"primary",className:"max-md:mt-12",children:s.type==="category"?e.jsx(r,{message:"New category"}):e.jsx(r,{message:"New section"})}),e.jsx(wx,{parentId:s.parentId})]}),children:a=>e.jsx(Fx,{data:a})})}function Fx({data:s}){const t=yt(),a=s.pagination.data,n=a.length;return e.jsxs(g.Fragment,{children:[e.jsx(_i,{category:s.category}),n?e.jsx(Ai,{children:t.type==="category"?e.jsx(r,{message:"Categories (:count)",values:{count:n}}):e.jsx(r,{message:"Sections (:count)",values:{count:n}})}):null,a.map(i=>e.jsx(Px,{category:i,data:s},i.id)),!a.length&&e.jsx(zx,{})]})}function Px({category:s,data:{pagination:{data:t},category:a}}){const n=Z(),i=_x(),l=Ei(),o=()=>{s.is_section?n(`/admin/hc/arrange/sections/${s.id}`):n(`/admin/hc/arrange/categories/${s.id}`)};return e.jsx(Ii,{item:s,items:t,onSortEnd:(c,d)=>{l.mutate({oldIndex:c,newIndex:d,parentId:a==null?void 0:a.id})},onClick:()=>o(),onView:()=>n(kl(s)),onEdit:()=>ps(Tx,{category:s}),onDelete:()=>{ps(xe,{title:e.jsx(r,{message:"Delete category"}),body:e.jsx(r,{message:"Are you sure you want to delete this category?"}),confirm:e.jsx(r,{message:"Delete"}),isDanger:!0,isLoading:i.isPending,onConfirm:()=>i.mutate({id:s.id},{onSuccess:()=>ca()})})},description:e.jsxs(Ao,{children:[s.sections_count?e.jsx(r,{message:"[one 1 section|other :count sections]",values:{count:s.sections_count}}):null,e.jsx(r,{message:"[one 1 article|other :count articles]",values:{count:s.articles_count}})]}),children:s.name})}function zx(){const{parentId:s}=yt();return s?e.jsx(Qt,{title:e.jsx(r,{message:"This category is empty"}),description:e.jsx(r,{message:"Empty categories aren't visible in the Help Center. You can make them visible by adding a section."})}):e.jsx(Qt,{title:e.jsx(r,{message:"There are no categories yet"})})}const Ti=s=>["hc","articles","admin",s];function Dx(s){return ne({queryKey:Ti(s),queryFn:()=>Mx(s)})}function Mx(s){return w.get("hc/articles",{params:{paginate:"simple",perPage:30,...s}}).then(t=>t.data)}function Fi(){return F({mutationFn:s=>$x(s),onSuccess:async()=>{await Promise.allSettled([k.invalidateQueries({queryKey:["hc","categories"]}),k.invalidateQueries({queryKey:["hc","articles"]}),k.invalidateQueries({queryKey:["articles"]})]),P(m("Article deleted"))},onError:s=>B(s)})}function $x({ids:s}){return w.delete(`hc/articles/${s.join(",")}`).then(t=>t.data)}function Na(){const{sectionId:s}=X();return{sectionId:s,order:"position|desc"}}function Rx(){const s=Ti(Na());return F({mutationFn:t=>{const a=k.getQueryData(s).pagination.data.map(n=>n.id);return Lx({sectionId:t.sectionId,ids:a})},onMutate:async({oldIndex:t,newIndex:a})=>{await k.cancelQueries({queryKey:s});const n=k.getQueryData(s);return k.setQueryData(s,i=>{const l={...i,pagination:{...i.pagination}};return l.pagination.data=ja(l.pagination.data,t,a),l}),{previousResponse:n}},onSuccess:async()=>{await k.invalidateQueries({queryKey:["hc","articles"]})},onError:(t,a,n)=>{B(t),k.setQueryData(s,n==null?void 0:n.previousResponse)}})}function Lx(s){return w.post(`hc/categories/${s.sectionId}/articles/reorder`,s).then(t=>t.data)}function Ox(){const s=Dx(Na());return e.jsx(Ci,{query:s,actionButton:e.jsx(f,{variant:"flat",color:"primary",elementType:D,to:"articles/new",children:e.jsx(r,{message:"New article"})}),children:t=>e.jsx(qx,{data:t})})}function qx({data:s}){var c;const{sectionId:t}=Na(),a=Z(),n=Fi(),i=s.pagination.data,l=i.length,o=Rx();return e.jsxs(g.Fragment,{children:[e.jsx(_i,{category:(c=s.section)==null?void 0:c.parent,section:s.section}),l?e.jsx(Ai,{children:e.jsx(r,{message:"Articles (:count)",values:{count:l}})}):null,i.map(d=>e.jsx(Ii,{item:d,items:i,onSortEnd:(u,h)=>{o.mutate({sectionId:t,oldIndex:u,newIndex:h})},onEdit:()=>a(`articles/${d.id}/edit`),onClick:()=>a(`articles/${d.id}/edit`),onView:()=>a(da(d,{section:s.section})),onDelete:()=>{ps(xe,{title:e.jsx(r,{message:"Delete article"}),body:e.jsx(r,{message:"Are you sure you want to delete this article?"}),confirm:e.jsx(r,{message:"Delete"}),isDanger:!0,isLoading:n.isPending,onConfirm:()=>n.mutate({ids:[d.id]},{onSuccess:()=>ca()})})},children:d.title},d.id)),!i.length&&e.jsx(Qt,{title:e.jsx(r,{message:"This section is empty"}),description:e.jsx(r,{message:"Empty sections aren't visible in the Help Center. You can make them visible by adding an article."})})]})}function Vx(s){const{trans:t}=T();return F({mutationFn:a=>Bx(a),onSuccess:async()=>{await Promise.allSettled([k.invalidateQueries({queryKey:["hc","categories"]}),k.invalidateQueries({queryKey:["hc","articles"]})]),P(t(m("Article created")))},onError:a=>te(a,s)})}function Pi(s){var t,a;return{...s,attachments:(t=s.attachments)==null?void 0:t.map(n=>n.id),tags:(a=s.tags)==null?void 0:a.map(n=>n.name)}}function Bx(s){return w.post("hc/articles",Pi(s)).then(t=>t.data)}function zi(s){return F({mutationFn:t=>Hx(t),onSuccess:async()=>{await Promise.allSettled([k.invalidateQueries({queryKey:["hc","categories"]}),k.invalidateQueries({queryKey:["hc","articles"]})])},onError:t=>s?te(t,s):B(t)})}function Hx({id:s,...t}){return w.put(`hc/articles/${s}`,Pi(t)).then(a=>a.data)}function Ux({article:s}){const t=zi();return e.jsx(f,{variant:"link",color:"primary",disabled:t.isPending,onClick:()=>{t.mutate({id:s.id,draft:!s.draft})},children:s.draft?e.jsx(r,{message:"Publish"}):e.jsx(r,{message:"Unpublish"})})}function Ca(){const[s,t]=g.useState(!1),{trans:a}=T(),i=N().watch("title"),l=a({message:"Title"});return s?e.jsx(j,{placeholder:l,autoFocus:!0,className:"mb-30",onBlur:()=>{t(!1)},name:"title",required:!0}):e.jsxs("h1",{tabIndex:0,onClick:()=>{t(!0)},onFocus:()=>{t(!0)},className:I("hover:bg-primary/focus rounded cursor-pointer",!i&&"text-muted"),children:[i||l,e.jsx(_e,{className:"icon-sm mx-8 mt-8 align-top text-muted"})]})}function Kx({host:s,value:t="",placeholder:a,onChange:n,className:i,inputRef:l,onInputBlur:o,showLinkIcon:c=!0,pattern:d,minLength:u,maxLength:h,hideButton:p,...b}){const{base_url:v}=Y(),S=b.prefix?`/${b.prefix}`:"",C=b.suffix?`/${b.suffix}`:"",[y,E]=g.useState(!1),[$,oe]=g.useState(t);s=s||v,g.useEffect(()=>{oe(t)},[t]);const fe=()=>{y?(E(!1),$&&(n==null||n($))):E(!0)};let re="";return $?re=$:a&&(re=ia(a)),e.jsxs("div",{className:I("flex items-center",i),children:[c&&e.jsx(Bn,{className:"icon-md text-muted"}),e.jsxs("div",{className:"text-primary ml-6 mr-14",children:[s,S,!y&&re&&e.jsxs(g.Fragment,{children:[e.jsx("span",{children:"/"}),e.jsx("span",{className:"font-medium",children:re})]}),y?null:C]}),y&&e.jsx(es,{pattern:d,minLength:u,maxLength:h,onKeyDown:ke=>{ke.key==="Enter"&&fe()},ref:l,"aria-label":"slug",autoFocus:!0,className:"mr-14",size:"2xs",value:$,onBlur:o,onChange:ke=>{oe(ke.target.value)}}),!p&&e.jsx(f,{type:"button",color:"chip",variant:"outline",size:"2xs",onClick:()=>{fe()},children:y?e.jsx(r,{message:"Save"}):e.jsx(r,{message:"Edit"})})]})}const wt=R(e.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}),"ArrowBackOutlined"),Wx=R(e.jsx("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"}),"UndoOutlined"),Gx=R(e.jsx("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"}),"RedoOutlined");function Qx({editor:s}){return e.jsxs("span",{children:[e.jsx(_,{size:"md",disabled:!s.can().undo(),onClick:()=>{s.commands.focus(),s.commands.undo()},children:e.jsx(Wx,{})}),e.jsx(_,{size:"md",disabled:!s.can().redo(),onClick:()=>{s.commands.focus(),s.commands.redo()},children:e.jsx(Gx,{})})]})}function Jx({editor:s}){return e.jsxs(z,{type:"modal",onClose:t=>{t!=null&&(s==null||s.commands.setContent(t))},children:[e.jsx(f,{variant:"text",startIcon:e.jsx(xo,{}),children:e.jsx(r,{message:"Source"})}),e.jsx(va,{title:e.jsx(r,{message:"Source code"}),defaultValue:s.getHTML()})]})}const Yx=R(e.jsx("path",{fillRule:"evenodd",d:"M4 11h16v2H4z"}),"HorizontalRuleOutlined"),Xx=R([e.jsx("circle",{cx:"12",cy:"19",r:"2"},"0"),e.jsx("path",{d:"M10 3h4v12h-4z"},"1")],"PriorityHighOutlined"),Zx=R(e.jsx("path",{d:"M16 4H4c-1.1 0-2 .9-2 2v12.01c0 1.1.9 1.99 2 1.99h16c1.1 0 2-.9 2-2v-8l-6-6zM4 18.01V6h11v5h5v7.01H4z"}),"NoteOutlined"),ep=R([e.jsx("path",{d:"M9.5 7.5v9l7-4.5z"},"0"),e.jsx("path",{d:"M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14.01H4V5.99h16v12.02z"},"1")],"SmartDisplayOutlined");function sp({editor:s,size:t}){const[a,n]=g.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(Pe,{onItemSelected:i=>{i==="hr"?(s.commands.focus(),s.commands.setHorizontalRule()):i==="embed"?n("embed"):(s.commands.focus(),s.commands.addInfo({type:i}))},children:[e.jsx(_,{variant:"text",size:t,className:I("flex-shrink-0"),children:e.jsx(Ks,{})}),e.jsxs(ze,{children:[e.jsx(x,{value:"hr",startIcon:e.jsx(Yx,{}),children:e.jsx(r,{message:"Horizontal rule"})}),e.jsx(x,{value:"embed",startIcon:e.jsx(ep,{}),children:e.jsx(r,{message:"Embed"})}),e.jsx(x,{value:"important",startIcon:e.jsx(Xx,{}),children:e.jsx(r,{message:"Important"})}),e.jsx(x,{value:"warning",startIcon:e.jsx(Nl,{}),children:e.jsx(r,{message:"Warning"})}),e.jsx(x,{value:"success",startIcon:e.jsx(Zx,{}),children:e.jsx(r,{message:"Note"})})]})]}),e.jsx(z,{type:"modal",isOpen:!!a,onClose:()=>{n(!1)},children:e.jsx(tp,{editor:s})})]})}function tp({editor:s}){const t=s.getAttributes("embed").src,a=q({defaultValues:{src:t}}),{formId:n,close:i}=H();return e.jsxs(U,{children:[e.jsx(Q,{children:e.jsx(r,{message:"Insert link"})}),e.jsx(W,{children:e.jsx(me,{form:a,id:n,onSubmit:l=>{s.commands.setEmbed(l),i()},children:e.jsx(j,{name:"src",label:e.jsx(r,{message:"Embed URL"}),autoFocus:!0,type:"url",required:!0})})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:i,variant:"text",children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{type:"submit",form:n,disabled:!a.formState.isValid,variant:"flat",color:"primary",children:e.jsx(r,{message:"Add"})})]})]})}function Te({children:s,modifier:t,separator:a="+"}){const n=Cl()?e.jsx("span",{className:"text-base align-middle",children:"⌘"}):"Ctrl";return e.jsxs("kbd",{className:"text-xs text-muted",children:[t&&e.jsxs(e.Fragment,{children:[n,a]}),s]})}function ap({editor:s,size:t}){return e.jsxs(Pe,{floatingMinWidth:"w-256",onItemSelected:a=>{s.commands.focus(),typeof a=="string"&&a.startsWith("h")?s.commands.toggleHeading({level:parseInt(a.replace("h",""))}):a==="code"?s.commands.toggleCode():a==="strike"?s.commands.toggleStrike():a==="super"?s.commands.toggleSuperscript():a==="sub"?s.commands.toggleSubscript():a==="blockquote"?s.commands.toggleBlockquote():a==="paragraph"&&s.commands.setParagraph()},children:[e.jsx(f,{className:I("flex-shrink-0"),variant:"text",size:t,endIcon:e.jsx(_l,{}),children:e.jsx(r,{message:"Format"})}),e.jsxs(ze,{children:[e.jsx(x,{value:"h1",endSection:e.jsx(Te,{modifier:!0,children:"Alt+1"}),children:e.jsx(r,{message:"Heading :number",values:{number:1}})}),e.jsx(x,{value:"h2",endSection:e.jsx(Te,{modifier:!0,children:"Alt+2"}),children:e.jsx(r,{message:"Heading :number",values:{number:2}})}),e.jsx(x,{value:"h3",endSection:e.jsx(Te,{modifier:!0,children:"Alt+3"}),children:e.jsx(r,{message:"Heading :number",values:{number:3}})}),e.jsx(x,{value:"h4",endSection:e.jsx(Te,{modifier:!0,children:"Alt+4"}),children:e.jsx(r,{message:"Heading :number",values:{number:4}})}),e.jsx(x,{value:"code",endSection:e.jsx(Te,{modifier:!0,children:"E"}),children:e.jsx(r,{message:"Code"})}),e.jsx(x,{value:"strike",endSection:e.jsx(Te,{modifier:!0,children:"Shift+X"}),children:e.jsx(r,{message:"Strikethrough"})}),e.jsx(x,{value:"super",endSection:e.jsx(Te,{modifier:!0,separator:" ",children:"."}),children:e.jsx(r,{message:"Superscript"})}),e.jsx(x,{value:"sub",endSection:e.jsx(Te,{modifier:!0,separator:" ",children:","}),children:e.jsx(r,{message:"Subscript"})}),e.jsx(x,{value:"blockquote",endSection:e.jsx(Te,{modifier:!0,children:"Shift+B"}),children:e.jsx(r,{message:"Blockquote"})}),e.jsx(x,{value:"paragraph",endSection:e.jsx(Te,{modifier:!0,children:"Alt+0"}),children:e.jsx(r,{message:"Paragraph"})})]})]})}const np=R(e.jsx("path",{d:"M2 20h20v4H2v-4zm3.49-3h2.42l1.27-3.58h5.65L16.09 17h2.42L13.25 3h-2.5L5.49 17zm4.42-5.61 2.03-5.79h.12l2.03 5.79H9.91z"}),"FormatColorTextOutlined"),rp=R(e.jsx("path",{d:"M16.56 8.94 7.62 0 6.21 1.41l2.38 2.38-5.15 5.15c-.59.59-.59 1.54 0 2.12l5.5 5.5c.29.29.68.44 1.06.44s.77-.15 1.06-.44l5.5-5.5c.59-.58.59-1.53 0-2.12zM5.21 10 10 5.21 14.79 10H5.21zM19 11.5s-2 2.17-2 3.5c0 1.1.9 2 2 2s2-.9 2-2c0-1.33-2-3.5-2-3.5zM2 20h20v4H2v-4z"}),"FormatColorFillOutlined");function ip({editor:s,size:t}){const[a,n]=g.useState(!1),i=s.getAttributes("textStyle").color,l=s.getAttributes("textStyle").backgroundColor;return e.jsxs(g.Fragment,{children:[e.jsxs("span",{className:I("flex-shrink-0 whitespace-nowrap"),children:[e.jsx(_,{size:t,color:i?"primary":null,onClick:()=>{n("text")},children:e.jsx(np,{})}),e.jsx(_,{size:t,color:l?"primary":null,onClick:()=>{n("bg")},children:e.jsx(rp,{})})]}),e.jsx(z,{defaultValue:a==="text"?"#000000":"#FFFFFF",type:"modal",isOpen:!!a,onClose:o=>{o&&(a==="text"?s.commands.setColor(o):s.commands.setBackgroundColor(o)),n(!1)},children:e.jsx(Zr,{})})]})}const lp=R(e.jsx("path",{d:"M15 15H3v2h12v-2zm0-8H3v2h12V7zM3 13h18v-2H3v2zm0 8h18v-2H3v2zM3 3v2h18V3H3z"}),"FormatAlignLeftOutlined"),op=R(e.jsx("path",{d:"M7 15v2h10v-2H7zm-4 6h18v-2H3v2zm0-8h18v-2H3v2zm4-6v2h10V7H7zM3 3v2h18V3H3z"}),"FormatAlignCenterOutlined"),cp=R(e.jsx("path",{d:"M3 21h18v-2H3v2zm6-4h12v-2H9v2zm-6-4h18v-2H3v2zm6-4h12V7H9v2zM3 3v2h18V3H3z"}),"FormatAlignRightOutlined"),dp=R(e.jsx("path",{d:"M3 21h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18V7H3v2zm0-6v2h18V3H3z"}),"FormatAlignJustifyOutlined"),Xs={left:{icon:lp,label:m("Align left")},center:{icon:op,label:m("Align center")},right:{icon:cp,label:m("Align right")},justify:{icon:dp,label:m("Justify")}};function up({editor:s,size:t}){const a=Object.keys(Xs).find(i=>s.isActive({textAlign:i}))||"left",n=a?Xs[a].icon:Xs.left.icon;return e.jsxs(Pe,{floatingWidth:"auto",selectionMode:"single",selectedValue:a,onSelectionChange:i=>{s.commands.focus(),s.commands.setTextAlign(i)},children:[e.jsx(_,{size:t,color:a?"primary":null,className:I("flex-shrink-0"),children:e.jsx(n,{})}),e.jsx(ze,{children:Object.entries(Xs).map(([i,l])=>{const o=l.icon;return e.jsx(x,{value:i,startIcon:e.jsx(o,{size:"md"}),capitalizeFirst:!0,children:e.jsx(r,{message:l.label.message})},i)})})]})}const sn="flex items-center px-4 h-42 text-muted border-b overflow-hidden";function mp({editor:s,size:t="md",justify:a="justify-center",hideInsertButton:n=!1,imageDiskPrefix:i}){const l=as(),[o,c]=g.useState(!1);return e.jsxs("div",{className:I(o?"h-84":"h-42"),children:[e.jsxs("div",{className:I(sn,a,"relative z-20"),children:[e.jsx(ap,{editor:s,size:t}),e.jsx(gs,{}),e.jsx(po,{editor:s,size:t}),e.jsx(gs,{}),e.jsx(up,{editor:s,size:t}),e.jsx(jo,{editor:s,size:t}),e.jsx(gs,{}),l?e.jsx(_,{className:"flex-shrink-0",color:o?"primary":null,size:t,onClick:()=>{c(!o)},children:o?e.jsx(Al,{}):e.jsx(El,{})}):e.jsx(tn,{editor:s,size:t,hideInsertButton:n,imageDiskPrefix:i})]}),e.jsx(dt,{children:o&&e.jsx(Xe.div,{className:I(sn,a,"absolute flex h-full w-full"),initial:{y:"-100%"},animate:{y:0},exit:{y:"-100%"},children:e.jsx(tn,{editor:s,size:t,imageDiskPrefix:i})})})]})}function tn({editor:s,size:t="md",hideInsertButton:a,imageDiskPrefix:n}){return e.jsxs(g.Fragment,{children:[e.jsx(fo,{editor:s,size:t}),e.jsx(gs,{}),e.jsx(bo,{editor:s,size:t}),e.jsx(vo,{editor:s,size:t,diskPrefix:n}),!a&&e.jsx(sp,{editor:s,size:t}),e.jsx(gs,{}),e.jsx(ip,{editor:s,size:t}),e.jsx(gs,{}),e.jsx(yo,{editor:s,size:t}),e.jsx(wo,{editor:s,size:t})]})}function _a({editor:s,allowSlugEditing:t=!0,onSave:a,saveButton:n,isLoading:i=!1,backLink:l,slugPrefix:o="pages",imageDiskPrefix:c}){const{isSticky:d,sentinelRef:u}=ai(),h=as();return e.jsxs(g.Fragment,{children:[e.jsx("div",{ref:u}),e.jsxs("div",{className:I("sticky top-0 z-10 mb-20 bg",d&&"shadow"),children:[e.jsxs("div",{className:"flex items-center justify-between gap-20 border-b px-20 py-10 text-muted sm:justify-start",children:[!h&&e.jsxs(g.Fragment,{children:[e.jsx(f,{variant:"text",size:"sm",elementType:D,to:l,relative:"path",startIcon:e.jsx(wt,{}),children:e.jsx(r,{message:"Back"})}),e.jsx("div",{className:"mr-auto",children:t&&e.jsx(hp,{name:"slug",showLinkIcon:!1,prefix:o})})]}),s&&e.jsx(Qx,{editor:s}),!h&&e.jsx(Jx,{editor:s}),a&&e.jsx(gp,{onSave:()=>{a(s.getHTML())},isLoading:i}),n]}),e.jsx(mp,{editor:s,size:"sm",imageDiskPrefix:c})]})]})}function gp({onSave:s,isLoading:t}){const n=N().watch("title");return e.jsx(f,{variant:"flat",size:"sm",color:"primary",className:"min-w-90",disabled:t||!n,onClick:()=>s(),children:e.jsx(r,{message:"Save"})})}function hp({name:s,...t}){const{field:{onChange:a,onBlur:n,value:i="",ref:l}}=Bs({name:s}),o=g.useRef(!1),{watch:c,setValue:d}=N();return g.useEffect(()=>{const u=c((h,{name:p})=>{p==="title"&&!o.current&&d("slug",h.title)});return()=>u.unsubscribe()},[c,d]),e.jsx(Kx,{className:I(!i&&"invisible"),onChange:u=>{o.current=!0,a(u)},onInputBlur:n,value:i,inputRef:l,...t})}function xp(){const{categoryId:s,sectionId:t,articleId:a}=X();let n=s||t?"../../":"../";return a&&(n+="../"),n}const pp=O.lazy(()=>ss(()=>import("./article-body-editor-ea08f5f9.js"),["./article-body-editor-ea08f5f9.js","./main-0be1d019.js","./main-5e25457c.css","./c-c3cc3e41.js","./article-body-editor-c0ff5600.css"],import.meta.url));function Di({initialContent:s,onLoad:t,mobileSaveButton:a}){const n=xp();return e.jsx(g.Suspense,{children:e.jsx(pp,{initialContent:s,onLoad:t,children:(i,l)=>e.jsxs(Le,{children:[e.jsx(_a,{allowSlugEditing:!1,editor:l,backLink:n,isLoading:!1,saveButton:a,imageDiskPrefix:"article_images"}),e.jsx("div",{className:"mx-20",children:e.jsxs("div",{className:"prose mx-auto flex-auto dark:prose-invert",children:[e.jsx(Ca,{}),i]})})]})})})}function Aa({children:s,aside:t}){const a=En("(max-width: 1024px)"),n=a?e.jsx(jp,{aside:t}):void 0;return e.jsxs("div",{className:"min-h-full items-stretch lg:flex",children:[e.jsx("div",{className:"flex-auto",children:s&&g.cloneElement(s,{mobileSaveButton:n})}),!a&&e.jsx("div",{className:"w-320 border-l bg-alt xl:w-400",children:e.jsx("aside",{className:"sticky top-0 px-24 py-14 xl:px-48 xl:py-28",children:t})})]})}function jp({aside:s}){return e.jsxs(z,{type:"modal",children:[e.jsx(f,{variant:"outline",color:"primary",size:"xs",children:e.jsx(r,{message:"Save"})}),e.jsx(U,{children:e.jsx(W,{children:s})})]})}function fp({onSave:s}){var v;const{data:t}=Qs({type:"category",compact:!0,load:["sections"]}),a=(t==null?void 0:t.pagination.data)||[],n=a.map(S=>S.sections).flat()||[],{watch:i,clearErrors:l}=N(),o=i("sections")||[],{getFieldState:c}=N(),d=(v=c("sections").error)==null?void 0:v.message,u=na({errorMessage:d});if(!n.length)return null;const h=n.find(S=>S.id===o[0]),p=a.find(S=>S.id===(h==null?void 0:h.parent_id)),b=o.length;return e.jsxs("div",{children:[e.jsx("div",{className:u.label,children:e.jsx(r,{message:"Publish in sections"})}),e.jsxs(z,{type:"modal",onClose:S=>{S&&(s(S),l("sections"))},children:[e.jsxs("div",{className:"relative cursor-pointer rounded border bg py-12 pl-12 pr-30 text-sm",children:[!h||!p?e.jsx(r,{message:"Select a section"}):e.jsxs(g.Fragment,{children:[e.jsx("div",{className:"mb-2 overflow-hidden overflow-ellipsis whitespace-nowrap font-semibold",children:p.name}),e.jsx("div",{className:"overflow-hidden overflow-ellipsis whitespace-nowrap text-xs text-muted",children:b>1?e.jsx(r,{message:":name + :count more sections",values:{name:h.name,count:b-1}}):h.name})]}),e.jsx(_e,{className:"absolute right-8 top-8 text-muted",size:"sm"})]}),e.jsx(bp,{})]}),d&&e.jsx("div",{className:u.error,children:d})]})}function bp(){const{data:s}=Qs({type:"category",load:["sections"]}),{close:t}=H(),{getValues:a}=N(),[n,i]=g.useState(()=>a("sections")||[]),l=(o,c)=>{o.target.checked?i([...n,c.id]):i(n.filter(d=>d!==c.id))};return e.jsxs(U,{size:"lg",children:[e.jsx(Q,{children:e.jsx(r,{message:"Select sections"})}),e.jsx(W,{children:e.jsx(ns,{children:s==null?void 0:s.pagination.data.map(o=>{var u,h;const d=(((u=o.sections)==null?void 0:u.map(p=>p.id))||[]).filter(p=>n.includes(p)).length;return e.jsx(be,{description:d?e.jsx(r,{message:"[one 1 section|other :count sections] selected",values:{count:d}}):null,label:o.name,children:(h=o.sections)==null?void 0:h.map(p=>e.jsx(Il,{className:"mb-8 block",checked:n.includes(p.id),onChange:b=>l(b,p),children:p.name},p.id))},o.id)})})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:()=>t(),children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{variant:"flat",color:"primary",onClick:()=>t(n),children:e.jsx(r,{message:"Select"})})]})]})}const vp=20*1024*1024;function yp(){const s=Ct(c=>c.fileUploads),t=Ct(c=>c.abortUpload),a=Ct(c=>c.uploadMultiple),{fields:n,append:i,remove:l}=pe({name:"attachments"}),o=async()=>{const c=await mt({multiple:!0});c.length&&a(c,{restrictions:{maxFileSize:vp},onSuccess:d=>{i(d)},onError:d=>{d&&P.danger(d)}})};return e.jsxs("div",{children:[e.jsx("div",{className:"mb-8 mt-34 text-sm",children:e.jsx(r,{message:"Attachments"})}),e.jsxs("div",{children:[n.map((c,d)=>{const u=c;return e.jsx(an,{name:u.name,mime:u.mime,onRemove:()=>l(d),downloadLink:`file-entries/download/${u.hash}`},u.id)}),[...s.entries()].filter(([c,d])=>d.status==="inProgress").map(([c,d])=>e.jsx(an,{name:d.file.name,mime:d.file.mime,progress:d.percentage,onRemove:()=>t(c)},c))]}),e.jsx("div",{className:"mt-6",children:e.jsx(f,{variant:"link",color:"primary",onClick:()=>o(),children:e.jsx(r,{message:"Upload attachment (max 20MB)"})})})]})}function an({name:s,mime:t,progress:a,onRemove:n,downloadLink:i}){return e.jsxs("div",{className:"py-2",children:[e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsx(Kn,{mime:t,size:"xs"}),e.jsx(wp,{name:s,className:"overflow-hidden overflow-ellipsis whitespace-nowrap",downloadLink:i}),e.jsx(_,{onClick:()=>n(),size:"xs",children:e.jsx(ye,{})})]}),a?e.jsx(kn,{value:a,className:"mt-4 max-w-224",size:"xs"}):null]})}function wp({name:s,downloadLink:t,className:a}){return t?e.jsx("a",{href:t,download:!0,className:I(a,"hover:underline"),children:s}):e.jsx("div",{className:a,children:s})}const Sp=m("Select author..."),kp=m("Find a user");function Np(){return e.jsx(Ln,{endpoint:"autocomplete/article-authors",name:"author_id",background:"bg",className:"mb-24",label:e.jsx(r,{message:"Author"}),placeholder:Sp,searchPlaceholder:kp})}function Mi({children:s,onSave:t,isSaving:a}){const n=N();return e.jsxs(g.Fragment,{children:[e.jsx(f,{variant:"flat",color:"primary",className:"min-h-46 w-full",onClick:()=>t(),disabled:a,children:e.jsx(r,{message:"Save"})}),e.jsxs("div",{className:"mt-34",children:[s,e.jsx(Si,{className:"mb-24",description:e.jsx(r,{message:"Control who can see this article in help center"})}),e.jsx(Np,{}),e.jsx(ki,{className:"mb-24",description:e.jsx(r,{message:"Control who can edit and publish this article"})}),e.jsx(fp,{onSave:i=>{n.setValue("sections",i)}}),e.jsx(Cp,{}),e.jsx(Le,{children:e.jsx(yp,{})})]})]})}function Cp(){const{data:s}=On({type:"custom",perPage:10}),t=(s==null?void 0:s.pagination.data)||[],{trans:a}=T();return t.length?e.jsx(rs,{className:"mt-24",placeholder:a({message:"Add tag..."}),background:"bg",label:e.jsx(r,{message:"Tags"}),name:"tags",chipSize:"sm",suggestions:t,description:e.jsx(r,{message:"Add content tags to help users find articles easier"}),children:n=>e.jsx(x,{value:n.id,capitalizeFirst:!0,children:e.jsx(r,{message:n.display_name||n.name})},n.id)}):null}function Zs(){const s=Eo("updateArticle");return s.data?e.jsxs(g.Fragment,{children:[e.jsx(In,{query:s}),e.jsx(_p,{article:s.data.article})]}):e.jsx(Aa,{aside:e.jsx(xs,{variant:"rect",size:"w-full h-46"}),children:e.jsx(oa,{query:s})})}function _p({article:s}){var o,c;const{trans:t}=T(),a=g.useRef(),n=q({defaultValues:{title:s.title,slug:s.slug,visible_to_role:s.visible_to_role,author_id:s.author_id,managed_by_role:s.managed_by_role,sections:(o=s.sections)==null?void 0:o.map(d=>d.id),tags:(c=s.tags)==null?void 0:c.map(d=>({name:d.name,id:d.id,description:d.display_name})),attachments:s.attachments}}),i=zi(n),l=()=>{if(!a.current)return null;i.mutate({...n.getValues(),body:a.current.getHTML(),id:s.id},{onSuccess:()=>{P(t(m("Article updated")))}})};return e.jsx(gt,{...n,children:e.jsx(Aa,{aside:e.jsx(Mi,{onSave:()=>l(),isSaving:i.isPending,children:e.jsx(Ap,{article:s})}),children:e.jsx(Di,{initialContent:s.body,onLoad:d=>a.current=d})})})}function Ap({article:s}){var t;return e.jsxs("div",{className:"mb-28 border-b pb-14 text-sm",children:[e.jsx("div",{className:"mb-8 font-semibold",children:e.jsx(r,{message:"Publication status"})}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"mr-10 flex items-center gap-8 border-r pr-10",children:[e.jsx("div",{className:I("h-12 w-12 rounded-full border",s.draft?"border-divider":"border-transparent bg-positive")}),s.draft?e.jsx(r,{message:"Draft"}):e.jsx(r,{message:"Published"})]}),e.jsx(Ux,{article:s})]}),e.jsx(f,{variant:"link",color:"primary",elementType:D,to:da(s,{section:(t=s.sections)==null?void 0:t[0]}),endIcon:e.jsx(_o,{}),target:"_blank",size:"xs",className:"mt-18",children:e.jsx(r,{message:"Preview in Help Center"})})]})}function et(){const{sectionId:s}=X(),t=Z(),{trans:a}=T(),n=g.useRef(),{user:i}=Tl(),l=q({defaultValues:{draft:!0,sections:s?[parseInt(s)]:[],author_id:i==null?void 0:i.id}}),o=Vx(l),c=()=>{if(!n.current)return null;o.mutate({...l.getValues(),body:n.current.getHTML()},{onSuccess:d=>{P(a(m("Article created"))),t(`../${d.article.id}/edit`,{relative:"path",replace:!0})}})};return e.jsxs(gt,{...l,children:[e.jsx(fs,{children:e.jsx(r,{message:"New article"})}),e.jsx(Aa,{aside:e.jsx(Mi,{onSave:()=>c(),isSaving:o.isPending,children:e.jsxs(M,{name:"draft",label:e.jsx(r,{message:"Publication status"}),selectionMode:"single",background:"bg",className:"mb-24",children:[e.jsx(x,{value:!1,children:e.jsx(r,{message:"Published"})}),e.jsx(x,{value:!0,children:e.jsx(r,{message:"Draft"})})]})}),children:e.jsx(Di,{onLoad:d=>n.current=d})})]})}function St(s){const{title:t,description:a,children:n,className:i,contentIsFlex:l=!0,contentClassName:o,contentRef:c,minHeight:d="min-h-440"}=s;return e.jsxs("div",{className:I("rounded-panel flex h-full flex-auto flex-col border bg",d,i),children:[e.jsxs("div",{className:"flex flex-shrink-0 items-center justify-between p-14 text-xs",children:[e.jsx("div",{className:"text-sm font-semibold",children:t}),a&&e.jsx("div",{className:"text-muted",children:a})]}),e.jsx("div",{ref:c,className:I("relative p-14",l&&"flex flex-auto items-center justify-center",o),children:n})]})}function Jt(){return e.jsxs("div",{className:"flex items-center gap-10 text-sm absolute mx-auto",children:[e.jsx(bs,{isIndeterminate:!0,size:"sm"}),e.jsx(r,{message:"Chart loading"})]})}const Ep=g.lazy(()=>ss(()=>import("./lazy-chart-a62c330a.js"),["./lazy-chart-a62c330a.js","./main-0be1d019.js","./main-5e25457c.css"],import.meta.url));function Ea(s){const{title:t,description:a,className:n,contentRef:i,isLoading:l}=s;return e.jsx(St,{title:t,description:a,className:n,contentRef:i,children:e.jsxs(g.Suspense,{fallback:e.jsx(Jt,{}),children:[e.jsx(Ep,{...s}),l&&e.jsx(Jt,{})]})})}function Ia(s,{localeCode:t="en",shareFirstDatasetLabels:a=!0}){if(!s)return{datasets:[]};const n=[];return{...s,datasets:s.datasets.map((i,l)=>{const o=i.data.map((c,d)=>{let u;return l===0||!a?(u=Ip(c,s.granularity,t),n[d]=u):u=n[d],{...u,value:c.value}});return{...i,data:o}})}}function Ip(s,t,a){return s.label?{label:s.label}:s.date?Tp(s,t,a):{label:""}}function Tp({date:s,endDate:t},a="day",n){const i=ms(s).toDate(),l=t?ms(t).toDate():null;switch(a){case"minute":return{label:Ne(n,{second:"2-digit"}).format(i),tooltipTitle:Ne(n,{day:"2-digit",hour:"numeric",minute:"numeric",second:"2-digit"}).format(i)};case"hour":return{label:Ne(n,{hour:"numeric",minute:"numeric"}).format(i),tooltipTitle:Ne(n,{month:"short",day:"2-digit",hour:"numeric",minute:"numeric"}).format(i)};case"day":return{label:Ne(n,{day:"2-digit",weekday:"short"}).format(i),tooltipTitle:Ne(n,{day:"2-digit",weekday:"short",month:"short"}).format(i)};case"week":return{label:Ne(n,{month:"short",day:"2-digit"}).format(i),tooltipTitle:Ne(n,{day:"2-digit",month:"long",year:"numeric"}).formatRange(i,l)};case"month":return{label:Ne(n,{month:"short",year:"numeric"}).format(i),tooltipTitle:Ne(n,{month:"long",year:"numeric"}).format(i)};case"year":return{label:Ne(n,{year:"numeric"}).format(i),tooltipTitle:Ne(n,{year:"numeric"}).format(i)}}}const Ne=_n((s,t)=>new Fl(s,t),{equals:(s,t)=>Pl(s,t),callTimeout:void 0}),nn=Sn().themes.all[0].values["--be-primary"],$e=[[`rgb(${nn.replaceAll(" ",",")})`,`rgba(${nn.replaceAll(" ",",")},0.2)`],["rgb(255,112,67)","rgb(255,112,67,0.2)"],["rgb(255,167,38)","rgb(255,167,38,0.2)"],["rgb(141,110,99)","rgb(141,110,99,0.2)"],["rgb(102,187,106)","rgba(102,187,106,0.2)"],["rgb(92,107,192)","rgb(92,107,192,0.2)"]],Fp={parsing:{xAxisKey:"label",yAxisKey:"value"},datasets:{line:{fill:"origin",tension:.1,pointBorderWidth:4,pointHitRadius:10}},plugins:{tooltip:{intersect:!1,mode:"index"}}};function it({data:s,className:t,...a}){const{localeCode:n}=Us(),i=g.useMemo(()=>{const l=Ia(s,{localeCode:n});return l.datasets=l.datasets.map((o,c)=>({...o,backgroundColor:$e[c][1],borderColor:$e[c][0],pointBackgroundColor:$e[c][0]})),l},[s,n]);return e.jsx(Ea,{...a,className:I(t,"min-w-500"),data:i,type:"line",options:Fp})}const rn="reports/tickets";function Pp(s){return ne({queryKey:[rn,s],queryFn:()=>zp(rn,s),placeholderData:Tn})}function zp(s,t){return w.get(s,{params:xa(t)}).then(a=>a.data)}function Ms({data:s,direction:t="vertical",individualBarColors:a=!1,className:n,...i}){const{localeCode:l}=Us(),o=g.useMemo(()=>{const u=Ia(s,{localeCode:l});return u.datasets=u.datasets.map((h,p)=>({...h,backgroundColor:a?$e.map(b=>b[1]):$e[p][1],borderColor:a?$e.map(b=>b[0]):$e[p][0],borderWidth:2})),u},[s,l,a]),c=t==="horizontal",d=g.useMemo(()=>({indexAxis:c?"y":"x",parsing:{xAxisKey:c?"value":"label",yAxisKey:c?"label":"value"}}),[c]);return e.jsx(Ea,{type:"bar",className:I(n,"min-w-500"),data:o,options:d,...i})}const Dp=[0,1,2,3,4,5,6],ln=["0-2","2-4","4-6","6-8","8-10","10-12","12-14","14-16","16-18","18-20","20-22","22-24"];function Mp({report:s}){const t=Us(),a=zl({weekday:"short"}),n=Dl(Hn(),t.localeCode);return e.jsx(St,{title:e.jsx(r,{message:"Busiest time of day"}),children:e.jsxs("div",{className:"grid w-full grid-cols-[max-content,repeat(12,minmax(66px,1fr))] gap-1",children:[e.jsx("div",{className:"spacer"}),ln.map(i=>e.jsx("div",{className:"py-6 text-center text-xs font-semibold",children:i},i)),Dp.map(i=>e.jsxs(g.Fragment,{children:[e.jsx("div",{className:"flex h-44 items-center pr-10 text-xs font-semibold",children:a.format(n.add({days:i}).toDate())}),ln.map(l=>{const o=s?s.datasets[0].data[i].value[l]:0;return e.jsx(de,{label:e.jsx(r,{message:":count new tickets",values:{count:o}}),children:e.jsx("div",{className:"h-44 bg-primary opacity-10 transition-opacity",style:{opacity:s?$p(o,s.datasets[0].max):.1}})},l)})]},i))]})})}function $p(s,t){return s===0?.1:Math.max(.1,Math.min(1,s/t))}function Rp({report:s}){var n;const t=s==null?void 0:s.datasets[0].data,a=(n=s==null?void 0:s.datasets[1])==null?void 0:n.data;return e.jsx(St,{title:e.jsx(r,{message:"Agent performance"}),contentIsFlex:!1,minHeight:"min-h-0",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"text-xs font-medium text-muted",children:e.jsxs("tr",{className:"h-40",children:[e.jsx("th",{className:"border-b text-left",children:e.jsx(r,{message:"Agent"})}),e.jsx("th",{className:"border-b text-left",children:e.jsx(r,{message:"Reply count"})}),e.jsx("th",{className:"border-b text-left",children:e.jsx(r,{message:"Tickets solved"})}),e.jsx("th",{className:"border-b text-left",children:e.jsx(r,{message:"Avg response time"})})]})}),e.jsx("tbody",{children:t==null?void 0:t.map((i,l)=>{const o=l===t.length-1;return e.jsxs("tr",{className:"h-40 text-sm",children:[e.jsx("td",{className:o?void 0:"border-b",children:i.email}),e.jsxs("td",{className:o?void 0:"border-b",children:[i.replyCount,a&&e.jsx(Pt,{currentValue:i.replyCount,previousValue:a[l].replyCount})]}),e.jsxs("td",{className:o?void 0:"border-b",children:[i.ticketsSolved,a&&e.jsx(Pt,{currentValue:i.ticketsSolved,previousValue:a[l].ticketsSolved})]}),e.jsxs("td",{className:o?void 0:"border-b",children:[i.averageResponseTime,"h",a&&e.jsx(Pt,{currentValue:i.averageResponseTime,previousValue:a[l].averageResponseTime})]})]},l)})})]})})}function Pt({currentValue:s,previousValue:t}){const a=Lp(s,t);return e.jsxs("span",{className:I("pl-6",a>0?"text-positive":"text-danger"),children:[a,"%"]})}function Lp(s,t){return t==null||s==null?0:t===0?100:Math.round((s-t)/t*100)}const $i=R(e.jsx("path",{d:"m16 6 2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6h-6z"}),"TrendingUpOutlined"),Op=R(e.jsx("path",{d:"m16 18 2.29-2.29-4.88-4.88-4 4L2 7.41 3.41 6l6 6 4-4 6.3 6.29L22 12v6h-6z"}),"TrendingDownOutlined"),qp={parsing:{key:"value"},plugins:{tooltip:{intersect:!0}}};function Vp({data:s,className:t,...a}){const{localeCode:n}=Us(),i=g.useMemo(()=>{var o;const l=Ia(s,{localeCode:n});return l.labels=(o=l.datasets[0])==null?void 0:o.data.map(c=>c.label),l.datasets=l.datasets.map((c,d)=>({...c,backgroundColor:$e.map(u=>u[1]),borderColor:$e.map(u=>u[0]),borderWidth:2})),l},[s,n]);return e.jsx(Ea,{type:"polarArea",data:i,options:qp,className:I(t,"min-w-500"),...a})}const on="https://www.gstatic.com/charts/loader.js";function Bp({placeholderRef:s,data:t,country:a,onCountrySelected:n}){const{trans:i}=T(),{analytics:l}=Y(),o=l==null?void 0:l.gchart_api_key,{selectedTheme:c}=Ml(),d=g.useRef(),u=!!n&&!a,h=g.useCallback(()=>{var y,E;if(typeof google>"u")return;const b=t.map($=>[$.label,$.value]);b.unshift([i(a?m("City"):m("Country")),i(m("Clicks"))]);const v=`${Ut(c.values["--be-paper"])}`,C={colorAxis:{colors:[`${Ut(c.values["--be-primary"])}`]},backgroundColor:v,region:a?a.toUpperCase():void 0,resolution:a?"provinces":"countries",displayMode:a?"markers":"regions",enableRegionInteractivity:u};!d.current&&s.current&&((y=google==null?void 0:google.visualization)!=null&&y.GeoChart)&&(d.current=new google.visualization.GeoChart(s.current)),(E=d.current)==null||E.draw(google.visualization.arrayToDataTable(b),C)},[c,t,s,i,a,u]),p=g.useCallback(async()=>{za.isLoadingOrLoaded(on)||(await za.loadAsset(on,{type:"js",id:"google-charts-js"}),await google.charts.load("current",{packages:["geochart"],mapsApiKey:o}),h())},[o,h]);return g.useEffect(()=>(d.current&&n&&google.visualization.events.addListener(d.current,"regionClick",b=>n==null?void 0:n(b.region)),()=>{d.current&&google.visualization.events.removeAllListeners(d.current)}),[n,d.current]),g.useEffect(()=>{p()},[p]),g.useEffect(()=>{h()},[c,h,t]),{drawGoogleChart:h}}const Hp=g.memo(({code:s})=>{const{localeCode:t}=Us(),a=new Intl.DisplayNames([t],{type:"region"});let n;try{n=a.of(s.toUpperCase())}catch{}return e.jsx(g.Fragment,{children:n})});function Up({data:s,isLoading:t,onCountrySelected:a,country:n,...i}){const l=g.useRef(null),o=!!a,c=s==null?void 0:s.datasets[0].data,d=g.useMemo(()=>c||[],[c]);return Bp({placeholderRef:l,data:d,country:n,onCountrySelected:a}),e.jsxs(St,{...i,className:"min-w-500",title:e.jsxs("div",{className:"flex items-center",children:[e.jsx(r,{message:"Top Locations"}),n?e.jsxs("span",{className:"pl-4",children:["(",e.jsx(Hp,{code:n}),")"]}):null,o&&e.jsx(Kp,{})]}),contentIsFlex:t,children:[t&&e.jsx(Jt,{}),e.jsxs("div",{className:"flex gap-24",children:[e.jsx("div",{ref:l,className:"flex-auto w-[480px] min-h-[340px]"}),e.jsxs("div",{className:"w-[170px]",children:[e.jsx("div",{className:"text-sm max-h-[340px] w-full flex-initial overflow-y-auto",children:d.map(u=>e.jsxs("div",{className:I("flex items-center gap-4 mb-4",o&&"cursor-pointer hover:underline"),role:o?"button":void 0,onClick:()=>{a==null||a(u.code)},children:[e.jsx("div",{className:"max-w-110 whitespace-nowrap overflow-hidden overflow-ellipsis",children:u.label}),e.jsxs("div",{children:["(",u.percentage,")%"]})]},u.label))}),n&&e.jsx(f,{variant:"outline",size:"xs",className:"mt-14",startIcon:e.jsx(wt,{}),onClick:()=>{a==null||a(void 0)},children:e.jsx(r,{message:"Back to countries"})})]})]})]})}function Kp(){return e.jsx(Fs,{title:e.jsx(r,{message:"Zooming in"}),body:e.jsx(r,{message:"Click on a country inside the map or country list to zoom in and see city data for that country."})})}const Ri="gap-12 md:gap-24 mb-12 md:mb-24",cn=`flex flex-col md:flex-row md:items-center overflow-x-auto ${Ri}`;function Wp({report:s,isLoading:t}){const a=s==null?void 0:s.pageViews.total;return e.jsxs(g.Fragment,{children:[e.jsxs("div",{className:cn,children:[e.jsx(it,{isLoading:t,className:"flex-auto",data:s==null?void 0:s.pageViews,title:e.jsx(r,{message:"Pageviews"}),description:a?e.jsx(r,{message:":count total views",values:{count:e.jsx(Ae,{value:a})}}):null}),e.jsx(Vp,{isLoading:t,data:s==null?void 0:s.devices,title:e.jsx(r,{message:"Top devices"})})]}),e.jsxs("div",{className:cn,children:[e.jsx(Ms,{isLoading:t,data:s==null?void 0:s.browsers,className:"flex-auto md:w-1/3",direction:"horizontal",individualBarColors:!0,hideLegend:!0,title:e.jsx(r,{message:"Top browsers"})}),e.jsx(Up,{isLoading:t,className:"flex-auto",data:s==null?void 0:s.locations,title:e.jsx(r,{message:"Top locations"})})]})]})}const Gp=R(e.jsx("path",{d:"m22 12-4-4v3H3v2h15v3l4-4z"}),"TrendingFlatOutlined");function Li({report:s,isLoading:t}){return e.jsx("div",{className:`flex h-[97px] flex-shrink-0 items-center overflow-x-auto ${Ri}`,children:s==null?void 0:s.map(a=>e.jsx(Qp,{datum:a,isLoading:t},a.name))})}function Qp({datum:s,isLoading:t=!1}){let a;if(g.isValidElement(s.icon))a=g.cloneElement(s.icon,{size:"lg"});else{const n=ea(s.icon);a=e.jsx(n,{size:"lg"})}return e.jsxs("div",{className:"rounded-panel flex h-full flex-auto items-center gap-18 whitespace-nowrap border p-20",children:[e.jsx("div",{className:"flex-shrink-0 rounded-lg bg-primary-light/20 p-10 text-primary",children:a}),e.jsxs("div",{className:"flex-auto",children:[e.jsx("div",{className:"flex items-center justify-between gap-20",children:e.jsx("div",{className:"text-lg font-bold text-main",children:e.jsx(dt,{initial:!1,mode:"wait",children:t?e.jsx(Xe.div,{...hs,children:e.jsx(xs,{className:"min-w-24"})},"skeleton"):e.jsx(Xe.div,{...hs,children:e.jsx(Jp,{datum:s})},"value")})})}),e.jsxs("div",{className:"flex items-center justify-between gap-20",children:[e.jsx("h2",{className:"text-sm text-muted",children:s.name}),(s.percentageChange!=null||s.previousValue!=null)&&e.jsx("div",{className:"flex items-center gap-10",children:e.jsx(Yp,{datum:s})})]})]})]},s.name)}function Jp({datum:s}){switch(s.type){case"fileSize":return e.jsx(ga,{bytes:s.currentValue});case"percentage":return e.jsx(Ae,{value:s.currentValue,style:"percent",maximumFractionDigits:1});default:return e.jsx(Ae,{value:s.currentValue})}}function Yp({datum:s}){const t=Xp(s);let a;return t>0?a=e.jsx($i,{size:"md",className:"text-positive"}):t===0?a=e.jsx(Gp,{className:"text-muted"}):a=e.jsx(Op,{className:"text-danger"}),e.jsxs(g.Fragment,{children:[a,e.jsxs("div",{className:"text-sm font-semibold text-muted",children:[t,"%"]})]})}function Xp({percentageChange:s,previousValue:t,currentValue:a}){return s!=null||t==null||a==null?s??0:t===0?100:Math.round((a-t)/t*100)}const Zp=R(e.jsx("path",{d:"M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"}),"HelpOutlineOutlined"),ej=R(e.jsx("path",{d:"m4.01 6.03 7.51 3.22-7.52-1 .01-2.22m7.5 8.72L4 17.97v-2.22l7.51-1M2.01 3 2 10l15 2-15 2 .01 7L23 12 2.01 3z"}),"SendOutlined"),sj=R(e.jsx("path",{d:"M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94.63 1.5 1.98 2.63 3.61 2.96V19H7v2h10v-2h-4v-3.1c1.63-.33 2.98-1.46 3.61-2.96C19.08 12.63 21 10.55 21 8V7c0-1.1-.9-2-2-2zM5 8V7h2v3.82C5.84 10.4 5 9.3 5 8zm7 6c-1.65 0-3-1.35-3-3V5h6v6c0 1.65-1.35 3-3 3zm7-6c0 1.3-.84 2.4-2 2.82V7h2v1z"}),"EmojiEventsOutlined");function tj({data:s,isLoading:t}){const a=g.useMemo(()=>{var n,i,l,o;return[{name:"New tickets",currentValue:(s==null?void 0:s.newTickets.datasets[0].total)??0,previousValue:((n=s==null?void 0:s.newTickets.datasets[1])==null?void 0:n.total)??void 0,icon:e.jsx(ej,{})},{name:"Solved tickets",currentValue:(s==null?void 0:s.newTickets.datasets[0].solvedTotal)??0,previousValue:((i=s==null?void 0:s.newTickets.datasets[1])==null?void 0:i.solvedTotal)??void 0,icon:e.jsx(Rs,{})},{name:"Unsolved tickets",currentValue:(s==null?void 0:s.newTickets.datasets[0].unsolvedTotal)??0,previousValue:((l=s==null?void 0:s.newTickets.datasets[1])==null?void 0:l.unsolvedTotal)??void 0,icon:e.jsx(Zp,{})},{name:"Solved on first reply",currentValue:(s==null?void 0:s.newTickets.datasets[0].solvedOnFirstReplyPercentage)??0,previousValue:((o=s==null?void 0:s.newTickets.datasets[1])==null?void 0:o.solvedOnFirstReplyPercentage)??void 0,icon:e.jsx(sj,{}),type:"percentage"}]},[s]);return e.jsx(Li,{report:a,isLoading:t})}const aj={month:"short",day:"2-digit"};function nj({value:s,onChange:t,disabled:a,compactOnMobile:n=!0,enableCompare:i=!1,granularity:l="minute"}){const o=as();return e.jsxs(z,{type:"popover",onClose:c=>{c&&t(c)},children:[e.jsx(f,{variant:"outline",color:"chip",endIcon:e.jsx(Zl,{}),disabled:a,children:e.jsx(eo,{start:s.start,end:s.end,options:o&&n?aj:Cn.short})}),e.jsx(rj,{value:s,enableCompare:i,granularity:l})]})}function rj({value:s,enableCompare:t,granularity:a}){const n=as(),i=Ma({granularity:a,defaultValue:{start:s.start,end:s.end,preset:s.preset},closeDialogOnSelection:!1}),l=!!s.compareStart&&!!s.compareEnd,o=Ma({granularity:a,defaultValue:l?{start:s.compareStart,end:s.compareEnd,preset:s.comparePreset}:so[0].getRangeValue(i.selectedValue)});return e.jsx(to,{state:i,compareState:t?o:void 0,compareVisibleDefault:l,showInlineDatePickerField:!n})}const dn=[{name:"tickets",to:"/admin/tickets",label:m("Tickets")},{name:"search",to:"/admin/search/failed",label:m("Search")},{name:"envato",to:"/admin/envato",label:m("Envato")},{name:"visitors",to:"/admin/visitors",label:m("Visitors")}];function kt({title:s,name:t,children:a,dateRange:n,setDateRange:i,disableDateRange:l,enableCompare:o,granularity:c}){return e.jsxs("div",{className:"min-h-full overflow-x-hidden p-12 md:p-24",children:[e.jsxs("div",{className:"mb-24 items-center justify-between gap-24 md:flex",children:[e.jsx(fs,{children:s}),e.jsx("h1",{className:"mb-24 text-3xl font-light md:mb-0",children:s}),e.jsxs("div",{className:"flex flex-shrink-0 items-center justify-between gap-10 md:gap-24",children:[e.jsx(ij,{value:t}),e.jsx(nj,{disabled:l,value:n,onChange:i,enableCompare:o,granularity:c})]})]}),a]})}function ij({value:s}){const{envato:t}=Y(),a=dn.filter(i=>i.name!=="envato"||(t==null?void 0:t.enable)),n=dn.find(i=>i.name===s);return e.jsxs(g.Fragment,{children:[e.jsx(ao,{variant:"outline",value:s,className:"max-md:hidden",children:a.map(i=>e.jsx(f,{value:i.name,elementType:D,to:i.to,children:e.jsx(r,{...i.label})},i.name))}),e.jsxs(Pe,{children:[e.jsx(f,{variant:"outline",className:"md:hidden",startIcon:e.jsx($i,{}),children:e.jsx(r,{...n.label})}),e.jsx(ze,{children:a.map(i=>e.jsx(x,{value:i.name,elementType:D,to:i.to,children:e.jsx(r,{...i.label})},i.name))})]})]})}function Nt(s){const[t,a]=Fn(),[n,i]=g.useState(()=>{try{const o=t.get("startDate"),c=t.get("endDate"),d=t.get("compareStartDate"),u=t.get("compareEndDate");if(o&&c)return{start:ms(o),end:ms(c),compareStart:d?ms(d):void 0,compareEnd:u?ms(u):void 0}}catch{}return s||qn[2].getRangeValue()}),l=g.useCallback(o=>{i(o),a(c=>(o.start?c.set("startDate",o.start.toAbsoluteString()):c.delete("startDate"),o.end?c.set("endDate",o.end.toAbsoluteString()):c.delete("endDate"),o.compareStart?c.set("compareStartDate",o.compareStart.toAbsoluteString()):c.delete("compareStartDate"),o.compareEnd?c.set("compareEndDate",o.compareEnd.toAbsoluteString()):c.delete("compareEndDate"),c),{replace:!0})},[a]);return[n,l]}const lj="gap-12 md:gap-24 mb-12 md:mb-24",zt=`flex flex-col lg:flex-row lg:items-center overflow-x-auto ${lj}`;function oj(){var n,i,l,o,c,d,u,h,p,b;const[s,t]=Nt(),a=Pp({dateRange:s});return e.jsxs(kt,{name:"tickets",title:e.jsx(r,{message:"Ticket report"}),dateRange:s,setDateRange:t,enableCompare:!0,children:[e.jsx(tj,{data:a.data,isLoading:a.isLoading}),e.jsxs("div",{className:zt,children:[e.jsx(it,{data:(n=a.data)==null?void 0:n.newTickets,className:"flex-auto",isLoading:a.isLoading,title:e.jsx(r,{message:"New tickets"}),hideLegend:!0,description:e.jsx(r,{message:":count total tickets",values:{count:e.jsx(Ae,{value:((o=(l=(i=a.data)==null?void 0:i.newTickets)==null?void 0:l.datasets[0])==null?void 0:o.total)||0})}})}),e.jsx(Ms,{data:(c=a.data)==null?void 0:c.firstReplyTimes,className:"max-w-500",direction:"vertical",individualBarColors:!0,isLoading:a.isLoading,hideLegend:!0,title:e.jsx(r,{message:"Hours until first agent reply"}),description:e.jsx(r,{message:":hoursh average",values:{hours:e.jsx(Ae,{value:((u=(d=a.data)==null?void 0:d.firstReplyTimes.datasets[0])==null?void 0:u.average)||0})}})})]}),e.jsxs("div",{className:zt,children:[e.jsx(Mp,{report:(h=a.data)==null?void 0:h.busiestTimeOfDay}),e.jsx(Ms,{data:(p=a.data)==null?void 0:p.tags,className:"max-w-620",direction:"horizontal",isLoading:a.isLoading,individualBarColors:!0,hideLegend:!0,title:e.jsx(r,{message:"Tickets by tags"})})]}),e.jsx("div",{className:zt,children:e.jsx(Rp,{report:(b=a.data)==null?void 0:b.agents})})]})}const Oi="admin/reports";function qi(s={}){return ne({queryKey:[Oi,s],queryFn:()=>cj(s),placeholderData:Tn})}function cj({types:s,dateRange:t}){const a={};return s&&(a.types=s.join(",")),t&&(a.startDate=t.start.toAbsoluteString(),a.endDate=t.end.toAbsoluteString(),a.timezone=t.start.timeZone),w.get(Oi,{params:a}).then(n=>n.data)}function dj(){const[s,t]=Nt(),{data:a,isLoading:n,isPlaceholderData:i}=qi({types:["visitors"],dateRange:s});return e.jsxs(kt,{name:"visitors",title:e.jsx(r,{message:"Visitors report"}),dateRange:s,setDateRange:t,enableCompare:!0,children:[e.jsx(uj,{dateRange:s}),e.jsx(Wp,{isLoading:n||i,report:a==null?void 0:a.visitorsReport})]})}function uj({dateRange:s}){const{data:t,isLoading:a,isPlaceholderData:n}=qi({types:["header"],dateRange:s});return e.jsx(Li,{report:t==null?void 0:t.headerReport,isLoading:a})}const Dt=[{uri:"failed",label:m("Failed searches"),key:0},{uri:"popular",label:m("Popular searches"),key:1},{uri:"articles",label:m("Popular articles"),key:2}];function mj(){const[s,t]=Nt(qn[8].getRangeValue()),{pathname:a}=Os(),n=a.split("/").pop(),i=Dt.find(l=>l.uri===n)||Dt[0];return e.jsx(kt,{title:e.jsx(r,{...i.label}),name:"search",dateRange:s,setDateRange:t,disableDateRange:i.key===2,children:e.jsxs(ht,{selectedTab:i.key,children:[e.jsx(xt,{children:Dt.map(l=>e.jsx(Ue,{width:"min-w-132",elementType:D,to:`/admin/search/${l.uri}`,replace:!0,children:e.jsx(r,{...l.label})},l.key))}),e.jsx("div",{className:"pt-34",children:e.jsx($s,{context:{dateRange:s}})})]})})}function gj(){const{dateRange:s}=Pn();return e.jsx(Vn,{dateRange:s,failedSearches:!0,description:e.jsx(r,{message:"This report shows search terms people use that don't match any articles. Use this metric to improve your help center search and content."})})}function hj(){const{dateRange:s}=Pn();return e.jsx(Vn,{dateRange:s,description:e.jsx(r,{message:"Use the popular searches report to see what your customers are looking for, and learn what your customers are most interested in or struggling with the most."})})}function xj(s){return ne({queryKey:["reports","articles",s],queryFn:()=>pj(s)})}function pj(s){return w.get("reports/popular-articles",{params:xa(s)}).then(t=>t.data)}const jj=[{key:"article",header:()=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{children:e.jsx(r,{message:"Article"})}),e.jsx(Fs,{body:e.jsx(r,{message:"Use the popular articles report to see which articles are most popular, and which articles are the most or least helpful."})})]}),visibleInMode:"all",body:s=>e.jsx(D,{to:da(s),className:Hs,target:"_blank",children:s.title})},{key:"views",header:()=>e.jsx(r,{message:"Views"}),width:"w-144",body:s=>e.jsx(Ae,{value:s.views})},{key:"score",header:()=>e.jsx(r,{message:"Score"}),width:"w-144",body:s=>e.jsxs("span",{children:[s.score,"%"]})},{key:"likes",header:()=>e.jsx(r,{message:"Likes"}),width:"w-144",body:s=>e.jsx(Ae,{value:s.positive_votes})},{key:"dislikes",header:()=>e.jsx(r,{message:"Dislikes"}),width:"w-144",body:s=>e.jsx(Ae,{value:s.negative_votes})},{key:"category",header:()=>e.jsx(r,{message:"Category"}),visibleInMode:"all",body:s=>e.jsx(zn,{article:s})}];function fj(){const[s,t]=Fn(),a=xj({page:s.get("page")||1,perPage:s.get("perPage")||15}),{data:n,fetchStatus:i,isLoading:l,isPlaceholderData:o}=a,c=(n==null?void 0:n.pagination.data)||[],d=i==="idle"&&c.length===0||!l&&!o&&c.length===0;return e.jsxs("div",{className:"relative max-md:overflow-x-auto",children:[e.jsx(no,{query:a}),e.jsx(So,{columns:jj,data:c,enableSelection:!1,collapseOnMobile:!1,className:"max-md:w-min"}),d&&e.jsx(Vs,{className:"mt-48",image:e.jsx(ct,{src:Wl}),title:e.jsx(r,{message:"There are no articles to display"})}),e.jsx(ko,{query:a,onPageChange:u=>t(h=>(h.set("page",u.toString()),h)),onPerPageChange:u=>t(h=>(h.set("perPage",u.toString()),h))})]})}function bj(s){return ne({queryKey:["reports","envato",s],queryFn:()=>vj(s)})}function vj(s){return w.get("reports/envato",{params:xa(s)}).then(t=>t.data)}const yj="gap-12 md:gap-24 mb-12 md:mb-24",un=`flex flex-col lg:flex-row lg:items-center overflow-x-auto ${yj}`;function wj(){var n,i,l,o,c,d,u;const[s,t]=Nt(),a=bj({dateRange:s});return e.jsxs(kt,{name:"envato",title:e.jsx(r,{message:"Envato report"}),dateRange:s,setDateRange:t,enableCompare:!0,granularity:"day",children:[e.jsxs("div",{className:un,children:[e.jsx(it,{data:(n=a.data)==null?void 0:n.earnings,className:"flex-auto",isLoading:a.isLoading,title:e.jsx(r,{message:"Earnings"}),hideLegend:!0,description:e.jsx(r,{message:":count total",values:{count:e.jsx(Ae,{value:((o=(l=(i=a.data)==null?void 0:i.earnings)==null?void 0:l.datasets[0])==null?void 0:o.total)||0})}})}),e.jsx(Ms,{data:(c=a.data)==null?void 0:c.items,className:"max-w-620",direction:"horizontal",isLoading:a.isLoading,individualBarColors:!0,hideLegend:!0,title:e.jsx(r,{message:"Earnings by item"})})]}),e.jsxs("div",{className:un,children:[e.jsx(it,{data:(d=a.data)==null?void 0:d.earningsVsTickets,className:"flex-auto",isLoading:a.isLoading,title:e.jsx(r,{message:"Earnings vs tickets"})}),e.jsx(Ms,{data:(u=a.data)==null?void 0:u.countries,className:"max-w-620",direction:"horizontal",isLoading:a.isLoading,individualBarColors:!0,hideLegend:!0,title:e.jsx(r,{message:"Earnings by country"})})]})]})}const Sj=""+new URL("software-engineer-ba026106.svg",import.meta.url).href,kj=[{key:"name",allowsSorting:!0,visibleInMode:"all",width:"flex-3 min-w-200",header:()=>e.jsx(r,{message:"Name"}),body:s=>s.name},{key:"times_fired",allowsSorting:!0,header:()=>e.jsx(r,{message:"Times used"}),body:s=>e.jsx(Ae,{value:s.times_fired})},{key:"updated_at",allowsSorting:!0,width:"w-100",header:()=>e.jsx(r,{message:"Last updated"}),body:s=>e.jsx(ce,{date:s.updated_at})},{key:"actions",header:()=>e.jsx(r,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-42 flex-shrink-0",visibleInMode:"all",body:s=>e.jsx(_,{size:"md",className:"text-muted",elementType:D,to:`/admin/triggers/${s.id}/edit`,children:e.jsx(_e,{})})}];function Nj(){return e.jsx(je,{endpoint:"triggers",title:e.jsx(r,{message:"Triggers"}),columns:kj,actions:e.jsx(Cj,{}),selectedActions:e.jsx(De,{}),emptyStateMessage:e.jsx(ue,{image:Sj,title:e.jsx(r,{message:"No triggers have been created yet"}),filteringTitle:e.jsx(r,{message:"No matching triggers"})})})}function Cj(){return e.jsx(Se,{elementType:D,to:"/admin/triggers/new",children:e.jsx(r,{message:"Add new trigger"})})}function _j(){const{triggerId:s}=X();return ne({queryKey:["triggers",`${s}`],queryFn:()=>Aj(s)})}async function Aj(s){const t=await w.get(`triggers/${s}`).then(a=>a.data);return t.trigger.all_conditions=t.trigger.conditions.filter(a=>a.match_type==="all"),t.trigger.any_conditions=t.trigger.conditions.filter(a=>a.match_type==="any"),t}function Ej(s){const{trans:t}=T(),{triggerId:a}=X(),n=Z();return F({mutationFn:i=>Ij(a,i),onSuccess:()=>{k.invalidateQueries({queryKey:K("triggers")}),n("/admin/triggers"),P(t(m("Trigger updated")))},onError:i=>te(i,s)})}function Ij(s,t){const a={...t,conditions:mn(t.all_conditions.concat(t.any_conditions)),actions:mn(t.actions||[])};return w.put(`triggers/${s}`,a).then(n=>n.data)}function mn(s){return s.map(t=>{var a;return(a=t.id)!=null&&a.toString().startsWith("temp_")&&delete t.id,t})}function Vi({children:s}){return e.jsx("h2",{className:"border-b pb-8 text-sm font-bold",children:s})}function gn({matchType:s,className:t,config:a}){var h;const{fields:n,remove:i,append:l}=pe({name:s,keyName:"key"}),{getFieldState:o}=N(),c=(h=o("conditions").error)==null?void 0:h.message,d=s==="all_conditions"?m("Meet <b>all</b> the following conditions"):m("Meet <b>any</b> of the following conditions"),u=()=>{const p=a.conditions.find(b=>b.type==="event:type");l({id:`temp_${vs()}`,condition_id:p.id,operator_id:p.operators[0].id,value:"ticket_created",match_type:s==="all_conditions"?"all":"any"})};return e.jsxs("div",{className:t,children:[e.jsx(Vi,{children:e.jsx(r,{message:d.message,values:{b:p=>e.jsx("span",{className:"mx-4 rounded border bg-alt px-6 py-2 font-bold",children:p})}})}),n.map((p,b)=>e.jsx(Tj,{index:b,matchType:s,config:a,onRemove:v=>i(v),className:"mt-12"},p.key)),e.jsx(f,{variant:"outline",startIcon:e.jsx(Ce,{}),onClick:u,size:"xs",className:"mt-12",children:e.jsx(r,{message:"Add condition"})}),c&&s==="all_conditions"&&e.jsx("p",{className:"mt-12 text-sm text-danger",children:c})]})}function Tj({index:s,onRemove:t,matchType:a,config:n,className:i}){const l=n.groupedConditions,{setValue:o,watch:c}=N(),d=c(`${a}.${s}.condition_id`),u=n.conditions.find(p=>p.id===d),h=ma(u);return g.useEffect(()=>{var p;u&&h&&h.type!==u.type&&(o(`${a}.${s}.operator_id`,(p=u.operators[0])==null?void 0:p.id),u.type==="event:type"?o(`${a}.${s}.value`,"ticket_created"):o(`${a}.${s}.value`,""))},[h,u,s,o,a]),e.jsxs("div",{className:I("flex flex-col gap-12 md:flex-row",i),children:[e.jsx(M,{name:`${a}.${s}.condition_id`,selectionMode:"single",minWidth:"min-w-224",children:Object.entries(l).map(([p,b])=>e.jsx(sa,{label:jt(p),children:b.map(v=>e.jsx(x,{value:v.id,children:v.name},v.id))},p))}),e.jsx(M,{name:`${a}.${s}.operator_id`,selectionMode:"single",minWidth:"min-w-200",children:u==null?void 0:u.operators.map(p=>e.jsx(x,{value:p.id,children:p.display_name},p.id))}),(u==null?void 0:u.type)==="event:type"&&e.jsxs(M,{name:`${a}.${s}.value`,selectionMode:"single",children:[e.jsx(x,{value:"ticket_created",children:e.jsx(r,{message:"Ticket created"})}),e.jsx(x,{value:"ticket_updated",children:e.jsx(r,{message:"Ticket updated"})})]}),(u==null?void 0:u.type)!=="event:type"&&e.jsx(j,{name:`${a}.${s}.value`}),e.jsx(_,{color:"danger",onClick:()=>t(s),children:e.jsx(ye,{})})]})}function Fj({config:s}){var c;const{fields:t,remove:a,append:n}=pe({name:"actions",keyName:"key"}),{getFieldState:i}=N(),l=(c=i("actions").error)==null?void 0:c.message,o=()=>{const d=s.actions.find(u=>u.name==="change_ticket_status");n({id:`temp_${vs()}`,action_id:d.id,action_value:{status_name:"open"}})};return e.jsxs("div",{children:[e.jsx(Vi,{children:e.jsx(r,{message:"Perform these actions"})}),t.map((d,u)=>e.jsx(Pj,{actionIndex:u,config:s,onRemove:h=>a(h),className:u===0?"mt-12":void 0},d.key)),e.jsx(f,{variant:"outline",startIcon:e.jsx(Ce,{}),onClick:()=>o(),size:"xs",className:"mt-12",children:e.jsx(r,{message:"Add action"})}),l&&e.jsx("p",{className:"mt-12 text-sm text-danger",children:l})]})}function Pj({actionIndex:s,onRemove:t,config:a,className:n}){var u;const{watch:i,setValue:l}=N(),o=i(`actions.${s}.action_id`),c=a.actions.find(h=>h.id===o),d=ma(c);return g.useEffect(()=>{var h;c&&d&&c.name!==d.name&&(l(`actions.${s}.action_value`,{}),(h=c.input_config)==null||h.inputs.map(p=>{p.select_options&&l(`actions.${s}.action_value.${p.name}`,a.actionOptions[p.select_options][0].value)}))},[d,c,s,l,a]),e.jsxs("div",{className:I("mb-12 flex gap-12 border-b pb-12",n),children:[e.jsxs("div",{className:"flex-auto space-y-12 md:max-w-400",children:[e.jsx(M,{name:`actions.${s}.action_id`,selectionMode:"single",children:a.actions.map(h=>e.jsx(x,{value:h.id,children:h.display_name},h.id))}),(u=c==null?void 0:c.input_config)==null?void 0:u.inputs.map((h,p)=>e.jsx(zj,{actionIndex:s,input:h,config:a},p))]}),e.jsx(_,{color:"danger",onClick:()=>t(s),children:e.jsx(ye,{})})]})}function zj({input:s,actionIndex:t,config:a}){const n=`actions.${t}.action_value.${s.name}`;if(s.name==="tags_to_add"||s.name==="tags_to_remove")return e.jsx(Dj,{name:n});switch(s.type){case"text":case"textarea":return e.jsx(j,{name:n,label:s.display_name,placeholder:s.placeholder,inputElementType:s.type==="textarea"?"textarea":void 0,rows:s.type==="textarea"?3:void 0});case"select":return e.jsx(M,{name:n,selectionMode:"single",children:a.actionOptions[s.select_options].map(i=>e.jsx(x,{description:i.description,value:i.value,capitalizeFirst:!0,startIcon:i.image?e.jsx(Un,{src:i.image}):null,children:i.name},i.value))})}}function Dj({name:s}){const{trans:t}=T(),[a,n]=g.useState(""),{data:i,isFetching:l}=On({query:a,perPage:8,notType:"status"});return e.jsx(rs,{name:s,isAsync:!0,isLoading:l,inputValue:a,onInputValueChange:n,valueKey:"id",placeholder:t(m("Enter tag name...")),allowCustomValue:!0,children:i==null?void 0:i.pagination.data.map(o=>e.jsx(x,{value:o.name,textLabel:o.name,capitalizeFirst:!0,children:o.display_name},o.id))})}function Bi({config:s}){return e.jsxs("div",{children:[e.jsx(j,{name:"name",label:e.jsx(r,{message:"Name"}),className:"mb-24"}),e.jsx(j,{name:"description",label:e.jsx(r,{message:"Description"}),inputElementType:"textarea",rows:3,className:"mb-44"}),e.jsx(gn,{matchType:"all_conditions",className:"mb-44",config:s}),e.jsx(gn,{matchType:"any_conditions",config:s,className:"mb-44"}),e.jsx(Fj,{config:s})]})}function Mj(s,t,a){const n={};for(let i=0;i<s.length;i++){let l=s[i];const o=t(l),c=n[o];l=a!=null&&a.map?a.map(s[i]):s[i],Array.isArray(c)?n[o].push(l):n[o]=[l]}return n}function Hi(){return ne({queryKey:["triggers","config"],queryFn:()=>$j()})}async function $j(){const s=await w.get("triggers/config").then(t=>t.data);return{groupedConditions:Mj(s.conditions,t=>{const[a]=t.name.split(":");return a.trim()},{map:t=>(t.name=t.name.split(":")[1].trim(),t)}),conditions:s.conditions,operators:s.operators,actions:s.actions,actionOptions:s.actionOptions}}function Rj(){const s=_j(),t=Hi(),a=s.isPending||t.isPending,n=Dn(a,{delay:500,minDuration:200});return s.data&&t.data?e.jsx(Lj,{trigger:s.data.trigger,config:t.data}):a?n?e.jsx(Fe,{}):null:e.jsx(Mn,{})}function Lj({trigger:s,config:t}){const a=q({defaultValues:{name:s.name,description:s.description,all_conditions:s.all_conditions,any_conditions:s.any_conditions,actions:s.actions}}),n=Ej(a);return e.jsx(os,{onSubmit:i=>n.mutate(i),form:a,title:e.jsx(r,{message:"Edit “:name“ trigger",values:{name:s.name}}),isLoading:n.isPending,backButton:e.jsx(_,{elementType:D,to:"/admin/triggers",className:"max-md:hidden",children:e.jsx(wt,{})}),wrapInContainer:!0,children:e.jsx(Bi,{config:t})})}function Oj(s){const{trans:t}=T(),a=Z();return F({mutationFn:n=>qj(n),onSuccess:n=>{k.invalidateQueries({queryKey:K("triggers")}),a(`/admin/triggers/${n.trigger.id}/edit`),P(t(m("Trigger created")))},onError:n=>te(n,s)})}function qj(s){const t={...s,conditions:s.all_conditions.concat(s.any_conditions)};return w.post("triggers",t).then(a=>a.data)}function Vj(){const s=Hi(),t=Dn(s.isLoading,{delay:500,minDuration:200});return s.data?e.jsx(Bj,{config:s.data}):s.isLoading?t?e.jsx(Fe,{}):null:e.jsx(Mn,{})}function Bj({config:s}){const t=q(),a=Oj(t);return e.jsx(os,{onSubmit:n=>a.mutate(n),form:t,title:e.jsx(r,{message:"Create new trigger"}),isLoading:a.isPending,backButton:e.jsx(_,{elementType:D,to:"/admin/triggers",className:"max-md:hidden",children:e.jsx(wt,{})}),wrapInContainer:!0,children:e.jsx(Bi,{config:s})})}const Hj=[{key:"name",width:"flex-3 min-w-200",visibleInMode:"all",header:()=>e.jsx(r,{message:"Article"}),body:s=>e.jsx(Uj,{article:s})},{key:"author_id",allowsSorting:!0,width:"min-w-200",visibleInMode:"all",header:()=>e.jsx(r,{message:"Owner"}),body:s=>s.author?e.jsx(qe,{image:s.author.avatar,label:s.author.display_name,description:s.author.email}):null},{key:"draft",allowsSorting:!0,width:"w-100 flex-shrink-0",header:()=>e.jsx(r,{message:"Published"}),body:s=>s.draft?e.jsx(ye,{size:"md",className:"text-danger"}):e.jsx(Rs,{size:"md",className:"text-positive"})},{key:"updatedAt",allowsSorting:!0,width:"w-96",header:()=>e.jsx(r,{message:"Last updated"}),body:s=>e.jsx("time",{children:e.jsx(ce,{date:s.updated_at})})},{key:"actions",header:()=>e.jsx(r,{message:"Actions"}),width:"w-84 flex-shrink-0",hideHeader:!0,align:"end",visibleInMode:"all",body:s=>e.jsxs("div",{className:"text-muted",children:[e.jsx(_,{size:"md",elementType:D,to:$l(s),children:e.jsx(_e,{})}),e.jsxs(z,{type:"modal",children:[e.jsx(de,{label:e.jsx(r,{message:"Delete reply"}),children:e.jsx(_,{children:e.jsx(ws,{})})}),e.jsx(Kj,{article:s})]})]})}];function Uj({article:s}){const{isCollapsedMode:t}=g.useContext(No);return e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:I(t?"whitespace-normal":"overflow-hidden overflow-ellipsis whitespace-nowrap font-medium"),children:s.title}),!t&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-xs",children:e.jsx(zn,{article:s})}),e.jsx("p",{className:"mt-4 max-w-680 whitespace-normal text-xs text-muted",children:ro(io(s.body),230)})]})]})}function Kj({article:s}){const t=Fi(),{close:a}=H();return e.jsx(xe,{isDanger:!0,isLoading:t.isPending,title:e.jsx(r,{message:"Delete article"}),body:e.jsx(r,{message:"Are you sure you want to delete this article?"}),confirm:e.jsx(r,{message:"Delete"}),onConfirm:()=>{t.mutate({ids:[s.id]},{onSuccess:()=>a()})}})}const Wj=[{key:"draft",label:m("Published"),description:m("Whether article is published or draft"),defaultOperator:G.eq,control:{type:he.BooleanToggle,defaultValue:!0}},{key:"author_id",label:m("Author"),description:m("User this article was created by"),defaultOperator:G.eq,control:{type:he.SelectModel,model:ha}},Oe({description:m("Date article was created")}),Qe({description:m("Date article was last updated")})];function Gj(){return e.jsx(je,{endpoint:"hc/articles",queryParams:{with:"body,path,author",defaultOrder:"updated_at|desc"},title:e.jsx(r,{message:"Articles"}),columns:Hj,filters:Wj,actions:e.jsx(Qj,{}),selectedActions:e.jsx(De,{}),enableSelection:!1,cellHeight:"h-90",emptyStateMessage:e.jsx(ue,{image:lo,title:e.jsx(r,{message:"No articles have been created yet"}),filteringTitle:e.jsx(r,{message:"No matching articles"})})})}function Qj(){return e.jsx(Se,{elementType:D,to:"/admin/articles/new",children:e.jsx(r,{message:"Add article"})})}function Ui({form:s,onSubmit:t,formId:a}){return e.jsxs(me,{id:a,form:s,onSubmit:t,children:[e.jsx(j,{name:"name",label:e.jsx(r,{message:"Name"}),description:e.jsx(r,{message:"Unique category identifier."}),className:"mb-20",required:!0,autoFocus:!0}),e.jsx(j,{name:"display_name",label:e.jsx(r,{message:"Display name"}),description:e.jsx(r,{message:"User friendly category name."}),className:"mb-20"}),e.jsx(Jj,{})]})}function Jj(){const{trans:s}=T(),{data:t,isFetching:a}=Qs({type:"category",compact:!0}),[n,i]=g.useState(""),l=t==null?void 0:t.pagination.data;return e.jsx(rs,{name:"categories",label:e.jsx(r,{message:"Help center categories"}),isAsync:!0,isLoading:a,inputValue:n,onInputValueChange:i,placeholder:s(m("Select help center categories")),allowCustomValue:!1,suggestions:l,children:t==null?void 0:t.pagination.data.map(o=>e.jsx(x,{value:o.name,textLabel:o.name,children:o.name},o.id))})}function Yj(s,t){const{trans:a}=T();return F({mutationFn:n=>Xj(s,n),onSuccess:async()=>{await k.invalidateQueries({queryKey:K("ticket-categories")}),P(a(m("Category updated")))},onError:n=>te(n,t)})}function Xj(s,t){var n;const a={...t,categories:((n=t.categories)==null?void 0:n.map(i=>i.id))??[]};return w.put(`ticket-categories/${s}`,a).then(i=>i.data)}function Zj({tag:s}){const{close:t,formId:a}=H(),n=q({defaultValues:{name:s.name,display_name:s.display_name,categories:s.categories}}),i=Yj(s.id,n);return e.jsxs(U,{children:[e.jsx(Q,{children:e.jsx(r,{message:"Update ticket category"})}),e.jsx(W,{children:e.jsx(Ui,{formId:a,form:n,onSubmit:l=>{i.mutate(l,{onSuccess:()=>t()})}})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:()=>t(),children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{form:a,disabled:i.isPending,variant:"flat",color:"primary",type:"submit",children:e.jsx(r,{message:"Save"})})]})]})}const ef=""+new URL("software-engineer-ba026106.svg",import.meta.url).href;function sf(s){const{trans:t}=T();return F({mutationFn:a=>tf(a),onSuccess:async()=>{await k.invalidateQueries({queryKey:K("ticket-categories")}),P(t(m("Category created")))},onError:a=>te(a,s)})}function tf(s){var a;const t={...s,categories:((a=s.categories)==null?void 0:a.map(n=>n.id))??[]};return w.post("ticket-categories",t).then(n=>n.data)}function af(){const{close:s,formId:t}=H(),a=q(),n=sf(a);return e.jsxs(U,{children:[e.jsx(Q,{children:e.jsx(r,{message:"Add ticket category"})}),e.jsx(W,{children:e.jsx(Ui,{formId:t,form:a,onSubmit:i=>{n.mutate(i,{onSuccess:()=>s()})}})}),e.jsxs(ae,{children:[e.jsx(f,{onClick:()=>s(),children:e.jsx(r,{message:"Cancel"})}),e.jsx(f,{form:t,disabled:n.isPending,variant:"flat",color:"primary",type:"submit",children:e.jsx(r,{message:"Save"})})]})]})}const nf=[{key:"display_name",visibleInMode:"all",header:()=>e.jsx(r,{message:"Name"}),body:s=>s.display_name},{key:"name",allowsSorting:!0,header:()=>e.jsx(r,{message:"Identifier"}),body:s=>s.name},{key:"updated_at",allowsSorting:!0,width:"w-100",header:()=>e.jsx(r,{message:"Last updated"}),body:s=>e.jsx(ce,{date:s.updated_at})},{key:"actions",header:()=>e.jsx(r,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-42 flex-shrink-0",visibleInMode:"all",body:s=>e.jsxs(z,{type:"modal",children:[e.jsx(_,{size:"md",className:"text-muted",children:e.jsx(_e,{})}),e.jsx(Zj,{tag:s})]})}];function rf(){return e.jsx(je,{endpoint:"ticket-categories",title:e.jsx(r,{message:"Ticket categories"}),columns:nf,actions:e.jsx(lf,{}),queryParams:{with:"categories"},selectedActions:e.jsx(De,{}),emptyStateMessage:e.jsx(ue,{image:ef,title:e.jsx(r,{message:"No categories have been created yet"}),filteringTitle:e.jsx(r,{message:"No matching categories"})})})}function lf(){return e.jsx(e.Fragment,{children:e.jsxs(z,{type:"modal",children:[e.jsx(Se,{children:e.jsx(r,{message:"Add category"})}),e.jsx(af,{})]})})}const of=[{path:"/",children:[{path:"tickets",element:e.jsx(oj,{})},{path:"envato",element:e.jsx(wj,{})},{path:"search",element:e.jsx(mj,{}),children:[{index:!0,element:e.jsx(_s,{to:"failed",replace:!0})},{path:"failed",element:e.jsx(gj,{})},{path:"popular",element:e.jsx(hj,{})},{path:"articles",element:e.jsx(fj,{})}]},{path:"visitors",element:e.jsx(dj,{})},{index:!0,element:e.jsx(_s,{to:"tickets",replace:!0})}]},{path:"/hc",element:e.jsx(_s,{to:"/hc/arrange",replace:!0})},{path:"/hc/arrange",element:e.jsx(en,{})},{path:"/hc/arrange/categories/:categoryId",element:e.jsx(en,{})},{path:"/hc/arrange/sections/:sectionId",element:e.jsx(Ox,{})},{path:"articles",element:e.jsx(Gj,{})},{path:"articles/new",element:e.jsx(et,{})},{path:"articles/:articleId/edit",element:e.jsx(Zs,{})},{path:"/hc/arrange/sections/:sectionId/articles/:articleId/edit",element:e.jsx(Zs,{})},{path:"/hc/arrange/categories/:categoryId/articles/:articleId/edit",element:e.jsx(Zs,{})},{path:"/hc/articles/:articleId/edit",element:e.jsx(Zs,{})},{path:"/hc/arrange/sections/:sectionId/articles/new",element:e.jsx(et,{})},{path:"/hc/arrange/categories/:categoryId/articles/new",element:e.jsx(et,{})},{path:"/hc/articles/new",element:e.jsx(et,{})},{path:"/ticket-categories",element:e.jsx(rf,{})},{path:"/saved-replies",element:e.jsx(oo,{})},{path:"/triggers",element:e.jsx(Nj,{})},{path:"/triggers/new",element:e.jsx(Vj,{})},{path:"/triggers/:triggerId/edit",element:e.jsx(Rj,{})}];function cf(s){const{pageId:t}=X(),a=`${s||"custom-pages"}/${t}`;return F({mutationFn:n=>df(n,a),onError:n=>B(n),onSuccess:async()=>{await k.invalidateQueries({queryKey:["custom-pages"]}),await k.invalidateQueries({queryKey:K(a)}),P(m("Page updated"))}})}function df(s,t){return w.put(`${t}`,s).then(a=>a.data)}const uf=O.lazy(()=>ss(()=>import("./article-body-editor-ea08f5f9.js"),["./article-body-editor-ea08f5f9.js","./main-0be1d019.js","./main-5e25457c.css","./c-c3cc3e41.js","./article-body-editor-c0ff5600.css"],import.meta.url));function mf(){const s=Rl();return s.data?e.jsxs(g.Fragment,{children:[e.jsx(In,{query:s}),e.jsx(gf,{page:s.data.page})]}):e.jsx("div",{className:"relative w-full h-full",children:e.jsx(oa,{query:s})})}function gf({page:s}){const t=Z(),a=cf(),n=q({defaultValues:{title:s.title,slug:s.slug,body:s.body}}),i=l=>{a.mutate({...n.getValues(),body:l},{onSuccess:()=>t("../..",{relative:"path"})})};return e.jsx(g.Suspense,{fallback:e.jsx(Fe,{}),children:e.jsx(uf,{initialContent:s.body,children:(l,o)=>e.jsx(Le,{children:e.jsxs(gt,{...n,children:[e.jsx(_a,{editor:o,backLink:"../..",isLoading:a.isPending,onSave:i}),e.jsx("div",{className:"mx-20",children:e.jsxs("div",{className:"prose dark:prose-invert mx-auto flex-auto",children:[e.jsx(Ca,{}),l]})})]})})})})}function hf(s){const t=s||"custom-pages";return F({mutationFn:a=>xf(a,t),onError:a=>B(a),onSuccess:async()=>{await k.invalidateQueries({queryKey:["custom-pages"]}),await k.invalidateQueries({queryKey:K(t)}),P(m("Page created"))}})}function xf(s,t){return w.post(`${t}`,s).then(a=>a.data)}const pf=O.lazy(()=>ss(()=>import("./article-body-editor-ea08f5f9.js"),["./article-body-editor-ea08f5f9.js","./main-0be1d019.js","./main-5e25457c.css","./c-c3cc3e41.js","./article-body-editor-c0ff5600.css"],import.meta.url));function jf(){const s=Z(),t=hf(),a=q(),n=i=>{t.mutate({...a.getValues(),body:i},{onSuccess:()=>s("../",{relative:"path"})})};return e.jsx(g.Suspense,{fallback:e.jsx(Fe,{}),children:e.jsx(pf,{children:(i,l)=>e.jsx(Le,{children:e.jsxs(gt,{...a,children:[e.jsx(_a,{editor:l,isLoading:t.isPending,onSave:n,backLink:"../"}),e.jsx("div",{className:"mx-20",children:e.jsxs("div",{className:"prose dark:prose-invert mx-auto flex-auto",children:[e.jsx(Ca,{}),i]})})]})})})})}const ff=""+new URL("font-a5a81d1a.svg",import.meta.url).href;function bf({state:{filters:s,setFilters:t}}){const{trans:a}=T();return e.jsxs("div",{className:"mb-24 items-center gap-24 @xs:flex",children:[e.jsx(es,{className:"mb-12 flex-auto @xs:mb-0",value:s.query,onChange:n=>{t({...s,query:n.target.value})},startAdornment:e.jsx(ra,{}),placeholder:a(m("Search fonts"))}),e.jsxs(ys,{className:"flex-auto",selectionMode:"single",selectedValue:s.category,onSelectionChange:n=>{t({...s,category:n})},children:[e.jsx(x,{value:"",children:e.jsx(r,{message:"All categories"})}),e.jsx(x,{value:"serif",children:e.jsx(r,{message:"Serif"})}),e.jsx(x,{value:"sans-serif",children:e.jsx(r,{message:"Sans serif"})}),e.jsx(x,{value:"display",children:e.jsx(r,{message:"Display"})}),e.jsx(x,{value:"handwriting",children:e.jsx(r,{message:"Handwriting"})}),e.jsx(x,{value:"monospace",children:e.jsx(r,{message:"Monospace"})})]})]})}function vf(s){const t=Ll({usage:"search",...s});return{startsWith(a,n){return n.length===0?!0:(a=a.normalize("NFC"),n=n.normalize("NFC"),t.compare(a.slice(0,n.length),n)===0)},endsWith(a,n){return n.length===0?!0:(a=a.normalize("NFC"),n=n.normalize("NFC"),t.compare(a.slice(-n.length),n)===0)},contains(a,n){if(n.length===0)return!0;a=a.normalize("NFC"),n=n.normalize("NFC");let i=0;const l=n.length;for(;i+l<=a.length;i++){const o=a.slice(i,i+l);if(t.compare(n,o)===0)return!0}return!1}}}const yf=[{label:m("System"),family:'ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',category:"sans-serif"},{family:"Impact, Charcoal, sans-serif",category:"sans-serif"},{family:"Arial, Helvetica Neue, Helvetica, sans-serif",category:"serif"},{family:'"Comic Sans MS", cursive, sans-serif',category:"Handwriting"},{family:"Century Gothic, sans-serif",category:"sans-serif"},{family:'"Courier New", Courier, monospace',category:"monospace"},{family:'"Lucida Sans Unicode", "Lucida Grande", sans-serif',category:"sans-serif"},{family:'"Times New Roman", Times, serif',category:"serif"},{family:'"Lucida Console", Monaco, monospace',category:"monospace"},{family:'"Andele Mono", monospace, sans-serif',category:"sans-serif"},{family:"Verdana, Geneva, sans-serif",category:"sans-serif"},{family:'"Helvetica Neue", Helvetica, Arial, sans-serif',category:"sans-serif"}];function wf({value:s,onChange:t}){const{data:a,isLoading:n}=we(["googleFonts"]),[i,l]=g.useState(0),[o,c]=g.useState({query:"",category:(s==null?void 0:s.category)??""}),{contains:d}=vf({sensitivity:"base"}),u=g.useCallback(S=>{c(S),l(0)},[]),h=g.useMemo(()=>yf.concat((a==null?void 0:a.googleFonts)??[]),[a==null?void 0:a.googleFonts]),p=g.useMemo(()=>h.filter(S=>{var C;return d(S.family,o.query)&&(!o.category||((C=S.category)==null?void 0:C.toLowerCase())===o.category.toLowerCase())}),[h,o,d]),b=g.useMemo(()=>Yn(p,20),[p]),v=b[i];return g.useEffect(()=>{const S="font-selector";v!=null&&v.length&&Ol(v,{id:S})},[v,i]),{fonts:v||[],currentPage:i,filteredFonts:p||[],setCurrentPage:l,isLoading:n,filters:o,setFilters:u,value:s,onChange:t,pages:b}}function Sf({state:{currentPage:s=0,setCurrentPage:t,filteredFonts:a,pages:n}}){const i=(a==null?void 0:a.length)||0;return e.jsxs("div",{className:"flex items-center justify-end gap-24 text-sm mt-30 pt-14 border-t",children:[i>0&&e.jsx("div",{children:e.jsx(r,{message:":from - :to of :total",values:{from:s*20+1,to:Math.min((s+1)*20,i),total:i}})}),e.jsxs("div",{className:"text-muted",children:[e.jsx(_,{disabled:s<1,onClick:()=>{t(Math.max(0,s-1))},children:e.jsx(Zt,{})}),e.jsx(_,{disabled:s>=n.length-1,onClick:()=>{t(s+1)},children:e.jsx(ot,{})})]})]})}function kf(s){const t=wf(s);return e.jsxs("div",{className:s.className,children:[e.jsx(bf,{state:t}),e.jsx(dt,{initial:!1,mode:"wait",children:e.jsx(Nf,{state:t})}),e.jsx(Sf,{state:t})]})}function Nf({state:s}){const{isLoading:t,fonts:a}=s,n="grid gap-24 grid-cols-[repeat(auto-fill,minmax(90px,1fr))] items-start";return t?e.jsx(_f,{className:n}):a!=null&&a.length?e.jsx(Xe.div,{...hs,className:n,children:a==null?void 0:a.map(i=>e.jsx(Cf,{font:i,state:s},i.family))},"font-list"):e.jsx(Vs,{className:"mt-60",size:"sm",image:e.jsx(ct,{src:ff}),title:e.jsx(r,{message:"No matching fonts"}),description:e.jsx(r,{message:"Try another search query or different category"})})}function Cf({font:s,state:{value:t,onChange:a}}){const n=(t==null?void 0:t.family)===s.family,i=s.family.split(",")[0].replace(/"/g,"");return e.jsxs(lt,{display:"block",onClick:()=>{a(s)},children:[e.jsx("span",{className:I("flex aspect-square items-center justify-center rounded-panel border text-4xl transition-bg-color hover:bg-hover md:text-5xl",n&&"ring-2 ring-primary ring-offset-2"),children:e.jsx("span",{style:{fontFamily:s.family},children:"Aa"})}),e.jsx("span",{className:I("mt-6 block overflow-hidden overflow-ellipsis whitespace-nowrap text-sm",n&&"text-primary"),children:s.label?e.jsx(r,{...s.label}):i})]},s.family)}function _f({className:s}){const t=Array.from(Array(20).keys());return e.jsx(Xe.div,{...hs,className:s,children:t.map(a=>e.jsxs("div",{children:[e.jsx("div",{className:"aspect-square",children:e.jsx(xs,{display:"block",variant:"rect"})}),e.jsx(xs,{className:"mt-6 text-sm"})]},a))},"font-list-skeleton")}function Af(){const{setValue:s,watch:t}=N(),{themeIndex:a}=X(),n=`appearance.themes.all.${a}.font`;return e.jsx(kf,{value:t(n),onChange:i=>{s(n,i,{shouldDirty:!0}),J().preview.setThemeFont(i)}})}const Ef={"rounded-none":{label:m("Square"),value:"0px"},"rounded-sm":{label:m("Small"),value:"0.125rem"},"rounded-md":{label:m("Medium"),value:"0.25rem"},"rounded-lg":{label:m("Large"),value:"0.5rem"},"rounded-xl":{label:m("Larger"),value:"0.75rem"},"rounded-full":{label:m("Pill"),value:"9999px"}};function If(){return e.jsxs("div",{className:"space-y-24",children:[e.jsx(Mt,{label:e.jsx(r,{message:"Button rounding"}),name:"button-radius"}),e.jsx(Mt,{label:e.jsx(r,{message:"Input rounding"}),name:"input-radius"}),e.jsx(Mt,{label:e.jsx(r,{message:"Panel rounding"}),name:"panel-radius",hidePill:!0})]})}function Mt({label:s,name:t,hidePill:a}){const{themeIndex:n}=X(),{watch:i,setValue:l}=N(),o=`appearance.themes.all.${n}.values.--be-${t}`,c=i(o);return e.jsxs("div",{children:[e.jsx("div",{className:"mb-10 text-sm font-semibold",children:s}),e.jsx("div",{className:"grid grid-cols-3 gap-10 text-sm",children:Object.entries(Ef).filter(([d])=>!a||!d.includes("full")).map(([d,{label:u,value:h}])=>e.jsx(Tf,{radius:d,isActive:h===c,onClick:()=>{l(o,h,{shouldDirty:!0})},children:e.jsx(r,{...u})},d))})]})}function Tf({radius:s,children:t,isActive:a,onClick:n}){return e.jsx(lt,{display:"block",className:I("h-36 border-2 hover:bg-hover",s,a&&"border-primary"),onClick:n,children:t})}const hn=["schedule","error","outgoing-email"];function Ff(){const{pathname:s}=Os(),t=s.split("/").pop(),a=hn.includes(t)?hn.indexOf(t):0;return e.jsxs(ht,{className:"p-12 md:p-24",selectedTab:a,children:[e.jsxs(xt,{children:[e.jsx(Ue,{elementType:D,to:"/admin/logs/schedule",replace:!0,children:e.jsx(r,{message:"Schedule"})}),e.jsx(Ue,{elementType:D,to:"/admin/logs/error",replace:!0,children:e.jsx(r,{message:"Error"})}),e.jsx(Ue,{elementType:D,to:"/admin/logs/outgoing-email",replace:!0,children:e.jsx(r,{message:"Email"})})]}),e.jsx($s,{})]})}function Pf({value:s}){return s?e.jsx(Rs,{className:"icon-md text-positive"}):e.jsx(ye,{className:"icon-md text-danger"})}function Ki(){const{trans:s}=T();return F({mutationFn:t=>zf(t),onSuccess:async(t,a)=>{await k.invalidateQueries({queryKey:K("logs/schedule")}),P.positive(s(m("Command reran")))},onError:t=>B(t)})}function zf({id:s}){return w.post(`logs/schedule/rerun/${s}`).then(t=>t.data)}const Df=R(e.jsx("path",{d:"M21 12V6c0-1.1-.9-2-2-2h-1V2h-2v2H8V2H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h7v-2H5V10h14v2h2zm-2-4H5V6h14v2zm-3.36 12c.43 1.45 1.77 2.5 3.36 2.5 1.93 0 3.5-1.57 3.5-3.5s-1.57-3.5-3.5-3.5c-.95 0-1.82.38-2.45 1H18V18h-4v-4h1.5v1.43c.9-.88 2.14-1.43 3.5-1.43 2.76 0 5 2.24 5 5s-2.24 5-5 5c-2.42 0-4.44-1.72-4.9-4h1.54z"}),"EventRepeatOutlined"),Mf=[{key:"command",allowsSorting:!0,visibleInMode:"all",width:"flex-3 min-w-200",header:()=>e.jsx(r,{message:"Name"}),body:s=>e.jsx(qe,{label:s.command,description:s.output})},{key:"ran_at",allowsSorting:!0,header:()=>e.jsx(r,{message:"Ran at"}),body:s=>e.jsx(ua,{date:s.ran_at})},{key:"duration",allowsSorting:!0,header:()=>e.jsx(r,{message:"Duration"}),body:s=>`${s.duration}ms`},{key:"exit_code",allowsSorting:!0,header:()=>e.jsx(r,{message:"Completed"}),body:s=>e.jsx(Pf,{value:s.exit_code===0})},{key:"count_in_last_hour",allowsSorting:!0,header:()=>e.jsx(r,{message:"Runs recently"}),body:s=>e.jsx(Ae,{value:s.count_in_last_hour})},{key:"actions",header:()=>e.jsx(r,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-42 flex-shrink-0",visibleInMode:"all",body:s=>e.jsx($f,{item:s})}];function $f({item:s}){const t=Ki();return e.jsx(de,{label:e.jsx(r,{message:"Rerun now"}),children:e.jsx(_,{size:"md",className:"text-muted",disabled:t.isPending,onClick:()=>{t.mutate({id:s.id})},children:e.jsx(Df,{})})})}const Rf=""+new URL("timeline-172fbeee.svg",import.meta.url).href,Ta=R(e.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zm-8 2V5h2v6h1.17L12 13.17 9.83 11H11zm-6 7h14v2H5z"}),"DownloadOutlined");function xn(){return e.jsx(je,{padding:"pt-12 md:pt-24",endpoint:"logs/schedule",title:e.jsx(r,{message:"CRON schedule log"}),columns:Mf,actions:e.jsx(Lf,{}),enableSelection:!1,emptyStateMessage:e.jsx(ue,{image:Rf,title:e.jsx(r,{message:"No scheduled commands have ran yet"}),filteringTitle:e.jsx(r,{message:"No matching scheduled commands"})})})}function Lf(){return e.jsx(Se,{elementType:"a",href:"api/v1/logs/schedule/download",download:!0,icon:e.jsx(Ta,{}),children:e.jsx(r,{message:"Download log"})})}const Of=""+new URL("bug-fixing-bd601a66.svg",import.meta.url).href,qf=R(e.jsx("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"InfoOutlined"),Vf=[{key:"message",visibleInMode:"all",width:"flex-3 min-w-200",header:()=>e.jsx(r,{message:"Message"}),body:s=>s.message},{key:"datetime",header:()=>e.jsx(r,{message:"Date"}),body:s=>e.jsx(ua,{date:s.datetime})},{key:"severity",header:()=>e.jsx(r,{message:"Severity"}),body:s=>e.jsxs("span",{className:I("flex items-center gap-6 text-xs capitalize",s.level==="error"?"text-danger":"text-primary"),children:[s.level==="error"?e.jsx(Yt,{size:"sm"}):e.jsx(qf,{size:"sm"}),s.level]})}];function Bf({error:s}){return e.jsxs(U,{size:"fullscreen",children:[e.jsx(Q,{showDivider:!0,padding:"px-24 py-10",actions:e.jsx(f,{variant:"outline",size:"xs",onClick:()=>Hf(s),children:e.jsx(r,{message:"Download"})}),children:e.jsx(r,{message:"Error details"})}),e.jsx(W,{children:e.jsx("pre",{className:"whitespace-pre-wrap break-words text-xs leading-5",children:s.exception})})]})}function Hf(s){const t=document.createElement("a");t.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(s.exception)),t.setAttribute("download",`error-${s.id}.log`),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}function Uf(){const{trans:s}=T();return F({mutationFn:t=>Kf(t),onSuccess:async()=>{await k.invalidateQueries({queryKey:K("logs/error")}),P(s(m("Log file deleted")))},onError:t=>B(t)})}function Kf({identifier:s}){return w.delete(`logs/error/${s}`).then(t=>t.data)}function Wf(){return e.jsx(je,{padding:"pt-12 md:pt-24",endpoint:"logs/error",title:e.jsx(r,{message:"Error log"}),onRowAction:s=>{ps(Bf,{error:s})},columns:Vf,actions:e.jsx(Gf,{}),enableSelection:!1,emptyStateMessage:e.jsx(ue,{image:Of,title:e.jsx(r,{message:"No errors have been logged yet"}),filteringTitle:e.jsx(r,{message:"No matching error log entries"})})})}function Gf(){var l,o,c;const{query:s,setParams:t}=Rn(),a=g.useRef(!1),[n,i]=g.useState(null);return g.useEffect(()=>{var d,u;if((u=(d=s.data)==null?void 0:d.files)!=null&&u.length&&!a.current){a.current=!0;const h=s.data.files[0].identifier;i(s.data.files[0].identifier),h!==s.data.selectedFile&&t({file:s.data.files[0].identifier})}},[s.data,t,a]),e.jsxs(g.Fragment,{children:[e.jsx(Qf,{files:((l=s.data)==null?void 0:l.files)??null,selectedFile:n,onSelected:d=>{i(d.identifier),t({file:d.identifier})}}),e.jsx(f,{variant:"outline",color:"danger",disabled:!n,onClick:()=>ps(Jf,{identifier:n}),children:e.jsx(r,{message:"Delete"})}),n&&e.jsx(Se,{elementType:"a",download:(c=(o=s.data)==null?void 0:o.files.find(d=>d.identifier===n))==null?void 0:c.name,href:`api/v1/logs/error/${n}/download`,icon:e.jsx(Ta,{}),children:e.jsx(r,{message:"Download log"})})]})}function Qf({files:s,selectedFile:t,onSelected:a}){return s?s.length?e.jsx(ys,{selectionMode:"single",selectedValue:t,size:"sm",minWidth:"min-w-[210px]",children:s==null?void 0:s.map(n=>e.jsxs(x,{value:n.identifier,onSelected:()=>a(n),children:[n.name," (",e.jsx(ga,{bytes:n.size}),")"]},n.identifier))}):null:e.jsx(xs,{variant:"rect",className:"max-w-[210px]"})}function Jf({identifier:s}){const t=Uf();return e.jsx(xe,{title:e.jsx(r,{message:"Delete log file"}),body:e.jsx(r,{message:"Are you sure you want to delete this log file?"}),confirm:e.jsx(r,{message:"Delete"}),onConfirm:()=>t.mutate({identifier:s},{onSuccess:()=>ca()}),isLoading:t.isPending,isDanger:!0})}const Yf=""+new URL("opened-4dded9dc.svg",import.meta.url).href;function Xf(s){return ne({queryKey:["logs/outgoing-email",s],queryFn:()=>Zf(s)})}function Zf(s){return w.get(`logs/outgoing-email/${s}`).then(t=>t.data)}function eb({logItemId:s}){const{data:t}=Xf(s),{base_url:a}=Y();return e.jsxs(U,{size:"fullscreen",children:[e.jsx(Q,{showDivider:!0,padding:"px-24 py-10",actions:e.jsx(f,{variant:"outline",size:"xs",disabled:!t,type:"button",onClick:t?()=>Ws(`${a}/api/v1/logs/outgoing-email/${s}/download`):void 0,children:e.jsx(r,{message:"Download"})}),children:e.jsx(r,{message:"Email preview"})}),e.jsx(W,{children:t?e.jsx("iframe",{srcDoc:t.logItem.parsed_message.body.html,className:"h-max w-full border-none",onLoad:n=>{const i=n.target;i.style.height=i.contentWindow.document.body.scrollHeight+"px"}}):e.jsx("div",{className:"flex min-h-200 items-center justify-center",children:e.jsx(bs,{isIndeterminate:!0})})})]})}const sb=[{key:"message_id",allowsSorting:!0,visibleInMode:"all",width:"flex-3 min-w-200",header:()=>e.jsx(r,{message:"Subject"}),body:s=>e.jsx(qe,{label:s.subject,description:s.message_id})},{key:"status",allowsSorting:!0,header:()=>e.jsx(r,{message:"Status"}),body:s=>{switch(s.status){case"sent":return e.jsx($t,{color:"positive",children:e.jsx(r,{message:"Sent"})});case"not-sent":return e.jsx($t,{color:void 0,children:e.jsx(r,{message:"Not sent"})});case"error":return e.jsx($t,{color:"danger",children:e.jsx(r,{message:"Error"})})}}},{key:"from",allowsSorting:!0,header:()=>e.jsx(r,{message:"From"}),body:s=>s.from},{key:"to",allowsSorting:!0,header:()=>e.jsx(r,{message:"To"}),body:s=>s.to},{key:"created_at",allowsSorting:!0,header:()=>e.jsx(r,{message:"Date"}),body:s=>e.jsx(ua,{date:s.created_at})},{key:"actions",header:()=>e.jsx(r,{message:"Actions"}),hideHeader:!0,align:"end",width:"w-42 flex-shrink-0",visibleInMode:"all",body:s=>e.jsx(tb,{item:s})}];function tb({item:s}){const t=Ki();return e.jsxs(z,{type:"modal",children:[e.jsx(de,{label:e.jsx(r,{message:"Preview"}),children:e.jsx(_,{size:"md",className:"text-muted",disabled:t.isPending,onClick:()=>{t.mutate({id:s.id})},children:e.jsx(hi,{})})}),e.jsx(eb,{logItemId:s.id})]})}function $t({color:s,children:t}){return e.jsx(Xt,{color:s,size:"xs",className:"w-max min-w-50 text-center",children:t})}const ab=[{key:"status",label:m("Status"),description:m("Status of the outgoing email"),defaultOperator:G.eq,control:{type:he.Select,defaultValue:"01",options:[{key:"01",label:m("Not sent"),value:"no-sent"},{key:"02",label:m("Sent"),value:"sent"},{key:"03",label:m("Error"),value:"error"}]}},Oe({description:m("Date email send was attempted")})];function nb(){return e.jsx(je,{padding:"pt-12 md:pt-24",endpoint:"logs/outgoing-email",title:e.jsx(r,{message:"Outgoing email"}),columns:sb,filters:ab,actions:e.jsx(rb,{}),enableSelection:!1,emptyStateMessage:e.jsx(ue,{image:Yf,title:e.jsx(r,{message:"No outgoing emails have been logged yet"}),filteringTitle:e.jsx(r,{message:"No matching emails"})})})}function rb(){return e.jsx(Se,{elementType:"a",href:"api/v1/logs/outgoing-email/download",download:!0,icon:e.jsx(Ta,{}),children:e.jsx(r,{message:"Download log"})})}const ib=O.lazy(()=>ss(()=>import("./admin-report-page-29f1bdf2.js"),["./admin-report-page-29f1bdf2.js","./main-0be1d019.js","./main-5e25457c.css","./search-report-table-f0bbbc10.js","./reply-editor-b3f60ce1.js","./search-a322569b.js","./Edit-75236d4e.js","./section-helper-64d68e03.js","./breadcrumb-9f769b36.js","./OpenInNew-6a51e2d3.js","./bullet-seprated-items-25a8819d.js"],import.meta.url)),lb=[{path:"appearance",element:e.jsx(ee,{permission:"appearance.update",children:e.jsx(dc,{})}),children:[{index:!0,element:e.jsx(qg,{})},{path:"general",element:e.jsx(Kc,{})},{path:"seo-settings",element:e.jsx(td,{})},{path:"custom-code",element:e.jsx(rd,{})},{path:"themes",element:e.jsx(Jc,{})},{path:"themes/:themeIndex",element:e.jsx(fu,{})},{path:"themes/:themeIndex/font",element:e.jsx(Af,{})},{path:"themes/:themeIndex/radius",element:e.jsx(If,{})},{path:"menus",element:e.jsx(hc,{})},{path:"menus/:menuIndex",element:e.jsx(Nc,{})},{path:"menus/:menuIndex/items/:menuItemIndex",element:e.jsx(Bc,{})},...Object.values(Xn.sections).flatMap(s=>s.routes||[])]},{path:"/",element:e.jsx(Po,{}),children:[...of,{path:"/",element:e.jsx(O.Suspense,{fallback:e.jsx(Fe,{screen:!0}),children:e.jsx(ib,{})})},{path:"users",element:e.jsx(ee,{permission:"users.update",children:e.jsx(Ko,{})})},{path:"users/new",element:e.jsx(ee,{permission:"users.update",children:e.jsx(ng,{})})},{path:"users/:userId/edit",element:e.jsx(ee,{permission:"users.update",children:e.jsx(eg,{})})},{path:"roles",element:e.jsx(ee,{permission:"roles.update",children:e.jsx(Hg,{})})},{path:"roles/new",element:e.jsx(ee,{permission:"roles.update",children:e.jsx(mh,{})})},{path:"roles/:roleId/edit",element:e.jsx(ee,{permission:"roles.update",children:e.jsx(lh,{})})},{path:"subscriptions",element:e.jsx(ee,{permission:"subscriptions.update",children:e.jsx(Lh,{})})},{path:"plans",element:e.jsx(ee,{permission:"plans.update",children:e.jsx(Zh,{})})},{path:"plans/new",element:e.jsx(ee,{permission:"plans.update",children:e.jsx(xx,{})})},{path:"plans/:productId/edit",element:e.jsx(ee,{permission:"plans.update",children:e.jsx(ux,{})})},{path:"custom-pages",element:e.jsx(ee,{permission:"custom_pages.update",children:e.jsx(cd,{})})},{path:"custom-pages/new",element:e.jsx(ee,{permission:"custom_pages.update",children:e.jsx(jf,{})})},{path:"custom-pages/:pageId/edit",element:e.jsx(ee,{permission:"custom_pages.update",children:e.jsx(mf,{})})},{path:"tags",element:e.jsx(ee,{permission:"tags.update",children:e.jsx(yh,{})})},{path:"localizations",element:e.jsx(ee,{permission:"localizations.update",children:e.jsx(pg,{})})},{path:"localizations/:localeId/translate",element:e.jsx(Fg,{})},{path:"files",element:e.jsx(ee,{permission:"files.update",children:e.jsx(_h,{})})},{path:"ads",element:e.jsx(ee,{permission:"settings.update",children:e.jsx(Rg,{})})},{path:"settings",element:e.jsx(ee,{permission:"settings.update",children:e.jsx(gd,{})}),children:[{index:!0,element:e.jsx(_s,{to:"general",replace:!0})},{path:"general",element:e.jsx(Ad,{})},{path:"subscriptions",element:e.jsx(nm,{})},{path:"localization",element:e.jsx(lm,{})},{path:"authentication",element:e.jsx(Vu,{})},{path:"uploading",element:e.jsx(bm,{})},{path:"outgoing-email",element:e.jsx(Pm,{})},{path:"cache",element:e.jsx($m,{})},{path:"analytics",element:e.jsx(Qm,{})},{path:"logging",element:e.jsx(Om,{})},{path:"queue",element:e.jsx(Vm,{})},{path:"recaptcha",element:e.jsx(Um,{})},{path:"gdpr",element:e.jsx(px,{})},...am]},{path:"logs",element:e.jsx(ee,{permission:"logs.view",children:e.jsx(Ff,{})}),children:[{index:!0,element:e.jsx(xn,{})},{path:"schedule",element:e.jsx(xn,{})},{path:"error",element:e.jsx(Wf,{})},{path:"outgoing-email",element:e.jsx(nb,{})}]}]},{path:"*",element:e.jsx(Vl,{})}];function ob(){return ql(lb)}const fb=Object.freeze(Object.defineProperty({__proto__:null,default:ob},Symbol.toStringTag,{value:"Module"}));export{Li as A,fb as B,Ta as D,sj as E,op as F,Zp as H,qf as I,Zx as N,Mh as P,nj as R,ej as S,rg as T,Wx as U,Wp as V,wt as a,tr as b,Df as c,dp as d,lp as e,cp as f,rp as g,np as h,Yx as i,Jn as j,$h as k,Xx as l,Gx as m,Zm as n,Ud as o,ep as p,$u as q,Uh as r,Op as s,Gp as t,qi as u,$i as v,Vd as w,hi as x,vf as y,Et as z};
//# sourceMappingURL=admin-routes-9637954d.js.map
