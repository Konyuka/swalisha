import{j as t,bn as ut,O as be,v as K,a8 as se,Y as E,r as x,bc as re,c as v,c9 as oe,bv as mt,ca as Ke,a2 as xt,b4 as es,B as M,aa as _e,T as p,g as Y,aG as ft,n as Ie,D as Q,av as ge,f as _,d as J,ac as le,e as X,aw as Pe,ad as ie,ak as ht,aV as ts,bf as je,aE as Re,y as me,bl as ss,m as k,F as ae,G as $e,a7 as Oe,I as Z,M as W,bC as Ue,bD as pt,bE as bt,b9 as ne,cb as as,cc as ns,cd as gt,ce as ee,cf as Ae,cg as Te,ch as ue,ci as xe,cj as fe,ck as he,cl as jt,bk as ce,b_ as Fe,b$ as te,cm as rs,cn as os,co as ls,cp as is,cq as cs,cr as ds,cs as us,c0 as De,a$ as ms,aX as xs,b as fs,bz as hs,bY as yt,ct as ps,Q as He,aI as bs,cu as gs,cv as js,cw as et,cx as tt,b6 as vt,b7 as wt,bN as ys,af as vs,bZ as Se,aF as We,a4 as ws,cy as ks,cz as Cs,cA as Ds,b3 as Ss,cB as Ns,bP as Is,cC as Ps,C as Qe,aC as Rs,bU as $s,s as ye,a5 as ve,a6 as Ve,aH as Ze,an as Fs,ai as Vs,S as zs,b2 as As,t as kt,ae as Ct,w as Dt,al as Ts,z as Ls,J as Ms,a3 as Es,cD as Os,V as Hs,W as Bs}from"./main-0be1d019.js";import{k as we,j as Ge,C as qs,x as st,R as Ks,g as _s,T as St,D as Nt,w as Us,a as Ws}from"./reply-editor-b3f60ce1.js";import{E as It}from"./Edit-75236d4e.js";import{s as Qs}from"./search-a322569b.js";function Zs({query:e}){return e.fetchStatus==="fetching"?t.jsx(ut,{isIndeterminate:!0,size:"xs",className:"fixed left-0 right-0 top-0"}):null}function tr(e){return be({queryKey:["tags",e],queryFn:()=>Gs(e)})}function Gs(e){return K.get("tags",{params:{paginate:"simple",...e}}).then(s=>s.data)}const Ys=se(t.jsx("path",{d:"M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z"}),"DeleteOutlined"),Ye=E.createContext(null);function sr(e){const{size:s="md",children:a,className:n,isLazy:r,overflow:o="overflow-hidden"}=e,l=x.useRef([]),i=x.useId(),[c,u]=re(e.selectedTab,e.defaultSelectedTab||0,e.onTabChange),d=x.useMemo(()=>({selectedTab:c,setSelectedTab:u,tabsRef:l,size:s,isLazy:r,id:i}),[c,i,r,u,s]);return t.jsx(Ye.Provider,{value:d,children:t.jsx("div",{className:v(n,o,"max-w-full"),children:a})})}function ar({index:e,className:s,isDisabled:a,children:n,padding:r,elementType:o="button",to:l,relative:i,width:c="min-w-min"}){const{selectedTab:u,setSelectedTab:d,tabsRef:m,size:h="md",id:f}=x.useContext(Ye),g=e===u,j=oe(),R=r||(h==="sm"?"px-12":"px-18"),I=v("tracking-wide overflow-hidden capitalize text-sm flex items-center justify-center outline-none transition-colors","focus-visible:ring focus-visible:ring-2 ring-inset rounded whitespace-nowrap cursor-pointer",c,Js({isDisabled:a,isSelected:g}),s,h==="md"&&`${R} h-48`,h==="sm"&&`${R} h-32`,a&&"pointer-events-none"),P=$=>{switch($.key){case"ArrowLeft":j==null||j.focusPrevious();break;case"ArrowRight":j==null||j.focusNext();break;case"Home":j==null||j.focusFirst();break;case"End":j==null||j.focusLast();break}},C=g?0:-1,D=o;return t.jsx(D,{disabled:a,id:`${f}-${e}-tab`,"aria-controls":`${f}-${e}-tabpanel`,type:"button",role:"tab","aria-selected":g,tabIndex:a?void 0:C,onKeyDown:P,onClick:()=>{d(e)},to:l,relative:i,className:I,ref:$=>{m.current&&$&&(m.current[e]=$)},children:n})}function Js({isDisabled:e,isSelected:s}){return e?"text-disabled cursor-default":s?"text-primary":"text-muted hover:text-main"}function Xs(){const{tabsRef:e,selectedTab:s}=x.useContext(Ye),[a,n]=x.useState({width:void 0,transform:void 0,className:void 0});return mt(()=>{if(s!=null&&e.current){const r=e.current[s];if(!r)return;n(o=>({width:`${r.offsetWidth}px`,transform:`translateX(${r.offsetLeft}px)`,className:o.width===void 0?"":"transition-all"}))}},[n,s,e]),t.jsx("div",{className:v("absolute bottom-0 left-0 h-2 bg-primary",a.className),role:"presentation",style:{width:a.width,transform:a.transform}})}function nr({children:e,center:s,expand:a,className:n}){const r=x.Children.toArray(e);return t.jsx(Ke,{children:t.jsxs("div",{className:v("flex relative max-w-full overflow-auto border-b max-sm:hidden-scrollbar md:compact-scrollbar",n),role:"tablist","aria-orientation":"horizontal",children:[r.map((o,l)=>x.isValidElement(o)?x.cloneElement(o,{index:l,className:v(o.props.className,a&&"flex-auto",s&&l===0&&"ml-auto",s&&l===r.length-1&&"mr-auto")}):null),t.jsx(Xs,{})]})})}const Ce="filters";function ea(e){if(!e)return[];let s=[];try{s=JSON.parse(atob(decodeURIComponent(e))),s.map(a=>(a.valueKey!=null&&(a.value=a.valueKey),a))}catch{}return s}function ta(e,s){return!e||(e=s?e.filter(a=>a.value!=="").map(a=>sa(a,s)):e,e=e.filter(a=>!a.isInactive),!e.length)?"":encodeURIComponent(btoa(JSON.stringify(e)))}function sa(e,s){var n;const a=s.find(r=>r.key===e.key);if((a==null?void 0:a.control.type)==="select"){const r=(a.control.options||[]).find(o=>o.key===e.value);if(r)return{...e,value:r.value,valueKey:r.key}}return(n=a==null?void 0:a.extraFilters)!=null&&n.length&&(e.extraFilters=a.extraFilters),e}function ze(e,s){const[a]=xt(),n=es(),r=a.get(Ce),o=x.useMemo(()=>{if(!e)return[];const d=ea(r);return(s||[]).forEach(m=>{if(!d.find(h=>h.key===m)){const h=e.find(f=>f.key===m);d.push({key:m,value:h.control.defaultValue,operator:h.defaultOperator,isInactive:!0})}}),d.sort((m,h)=>e.findIndex(f=>f.key===m.key)-e.findIndex(f=>f.key===h.key)),d},[r,s,e]),l=x.useCallback(d=>{const m=[...o];return d.forEach(h=>{const f=typeof h=="object"?h.key:h,g=m.findIndex(j=>j.key===f);g>-1&&m.splice(g,1)}),m},[o]),i=x.useCallback(d=>{const m=ta(d,e);m?a.set(Ce,m):a.delete(Ce),n({search:`?${a}`},{replace:!0})},[e,n,a]),c=x.useCallback(d=>{const h=[...l(d),...d];i(h)},[l,i]),u=x.useCallback(d=>i(l([d])),[l,i]);return{add:c,remove:u,replaceAll:i,decodedFilters:o,encodedFilters:r}}var L=(e=>(e.Select="select",e.DateRangePicker="dateRangePicker",e.SelectModel="selectModel",e.Input="input",e.BooleanToggle="booleanToggle",e.ChipField="chipField",e.Custom="custom",e))(L||{}),Ne=(e=>(e.eq="=",e.ne="!=",e.gt=">",e.gte=">=",e.lt="<",e.lte="<=",e.has="has",e.hasAll="hasAll",e.doesntHave="doesntHave",e.between="between",e))(Ne||{});const Pt=x.forwardRef((e,s)=>{const{isInactive:a,filter:n,...r}=e;return a?t.jsx(aa,{filter:n,...r,ref:s}):t.jsx(na,{filter:n,...r,ref:s})}),aa=x.forwardRef(({filter:e,...s},a)=>t.jsx(M,{variant:"outline",size:"xs",color:"paper",radius:"rounded-md",border:"border",ref:a,endIcon:t.jsx(_e,{}),...s,children:t.jsx(p,{...e.label})})),na=x.forwardRef(({filter:e,children:s,...a},n)=>{const r=e.control.type===L.BooleanToggle;return t.jsxs(M,{variant:"outline",size:"xs",color:"primary",radius:"rounded-r-md",border:"border-y border-r",endIcon:!r&&t.jsx(_e,{}),ref:n,...a,children:[t.jsx("span",{className:v(!r&&"border-r border-r-primary-light mr-8 pr-8"),children:t.jsx(p,{...e.label})}),s]})});function Rt({filter:e}){const{trans:s}=Y();return t.jsx(ft,{size:"sm",name:`${e.key}.value`,selectionMode:"single",showSearchField:e.control.showSearchField,placeholder:e.control.placeholder?s(e.control.placeholder):void 0,searchPlaceholder:e.control.searchPlaceholder?s(e.control.searchPlaceholder):void 0,children:e.control.options.map(a=>t.jsx(Ie,{value:a.key,children:t.jsx(p,{...a.label})},a.key))})}function ke(e){const{onValueChange:s,isInactive:a,filter:n,label:r}=e;return t.jsxs(Q,{offset:10,type:"popover",onClose:o=>{o!==void 0&&s(o)},children:[t.jsx(Pt,{isInactive:a,filter:n,children:r}),t.jsx(ra,{...e})]})}function ra({filter:e,panel:s,value:a,operator:n}){const r=ge({defaultValues:{[e.key]:{value:a,operator:n}}}),{close:o,formId:l}=_();return t.jsxs(J,{size:"xs",children:[t.jsx(le,{children:t.jsx(p,{...e.label})}),t.jsx(X,{padding:"px-14 pt-14 pb-4 max-h-288",children:t.jsxs(Pe,{form:r,id:l,onSubmit:i=>{o(i[e.key])},children:[e.description&&t.jsx("div",{className:"text-muted text-xs mb-14",children:t.jsx(p,{...e.description})}),s]})}),t.jsx(ie,{children:t.jsx(M,{form:l,type:"submit",variant:"flat",color:"primary",size:"xs",children:t.jsx(p,{message:"Apply"})})})]})}function oa(e,s,a){return be({queryKey:[e,s],queryFn:()=>la(e,s),placeholderData:ht,...a})}async function la(e,s){return K.get(e,{params:s}).then(a=>a.data)}function $t(e,s,a){return be({queryKey:[e,s],queryFn:()=>ia(e,s),...a})}async function ia(e,s){return K.get(e,{params:s}).then(a=>a.data)}function ca({label:e,className:s,background:a,value:n,defaultValue:r="",placeholder:o=k("Select item..."),searchPlaceholder:l=k("Find an item..."),onChange:i,description:c,errorMessage:u,invalid:d,autoFocus:m,queryParams:h,endpoint:f,disabled:g,required:j}){var w;const R=x.useRef(null),[I,P]=x.useState(""),[C,D]=re(n,r,i),$=oa(f,{query:I,...h}),{trans:F}=Y(),b=Re({size:"md"});return C?t.jsxs("div",{className:s,children:[t.jsx("div",{className:b.label,children:e}),t.jsx("div",{className:v("rounded-input border p-8",a,d&&"border-danger"),children:t.jsx(me,{initial:!1,mode:"wait",children:t.jsx(da,{disabled:g,endpoint:f,modelId:C,queryParams:h,onEditClick:()=>{D(""),P(""),requestAnimationFrame(()=>{var S,V;(S=R.current)==null||S.focus(),(V=R.current)==null||V.click()})}})})}),c&&!u&&t.jsx("div",{className:b.description,children:c}),u&&t.jsx("div",{className:b.error,children:u})]}):t.jsx(ss,{className:s,showSearchField:!0,invalid:d,errorMessage:u,description:c,color:"white",isAsync:!0,background:a,placeholder:F(o),searchPlaceholder:F(l),label:e,isLoading:$.isFetching,items:(w=$.data)==null?void 0:w.results,inputValue:I,onInputValueChange:P,selectionMode:"single",selectedValue:C,onSelectionChange:D,ref:R,autoFocus:m,disabled:g,required:j,children:S=>t.jsx(Ie,{value:S.id,description:S.description,startIcon:t.jsx(we,{src:S.image}),children:S.name},S.id)})}function da({modelId:e,onEditClick:s,endpoint:a,disabled:n,queryParams:r}){const{data:o,isLoading:l}=$t(`${a}/${e}`,r);return l||!(o!=null&&o.model)?t.jsx(ua,{},"skeleton"):t.jsxs(ae.div,{className:v("flex items-center gap-10",n&&"pointer-events-none cursor-not-allowed text-disabled"),...$e,children:[o.model.image&&t.jsx(we,{src:o.model.image}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm leading-4",children:o.model.name}),t.jsx("div",{className:"text-xs text-muted",children:o.model.description})]}),t.jsx(Oe,{label:t.jsx(p,{message:"Change item"}),children:t.jsx(Z,{className:"ml-auto text-muted",size:"sm",onClick:s,disabled:n,children:t.jsx(It,{})})})]},"preview")}function ua(){return t.jsxs(ae.div,{className:"flex items-center gap-10",...$e,children:[t.jsx(W,{variant:"rect",size:"w-32 h-32"}),t.jsxs("div",{className:"max-h-[36px] flex-auto",children:[t.jsx(W,{className:"text-xs"}),t.jsx(W,{className:"max-h-8 text-xs"})]}),t.jsx(W,{variant:"icon",size:"w-24 h-24"})]})}function ma({name:e,...s}){const{clearErrors:a}=ts(),{field:{onChange:n,value:r=""},fieldState:{invalid:o,error:l}}=je({name:e});return t.jsx(ca,{value:r,onChange:i=>{n(i),a(e)},invalid:o,errorMessage:l==null?void 0:l.message,...s})}function Ft({filter:e}){return t.jsx(ma,{name:`${e.key}.value`,endpoint:`normalized-models/${e.control.model}`})}const Vt=se(t.jsx("path",{d:"M7 11h2v2H7v-2zm14-5v14c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2l.01-14c0-1.1.88-2 1.99-2h1V2h2v2h8V2h2v2h1c1.1 0 2 .9 2 2zM5 8h14V6H5v2zm14 12V10H5v10h14zm-4-7h2v-2h-2v2zm-4 0h2v-2h-2v2z"}),"DateRangeOutlined"),zt=E.forwardRef((e,s)=>{const{children:a,inputProps:n,wrapperProps:r,className:o,autoFocus:l,style:i,onClick:c}=e;return t.jsx("div",{...r,onClick:c,children:t.jsx("div",{...n,role:"group",className:v(o,"flex items-center focus-within:ring focus-within:ring-primary/focus focus-within:border-primary/60"),ref:s,style:i,children:t.jsx(Ke,{autoFocus:l,children:a})})})}),Je=E.forwardRef(({inputRef:e,wrapperProps:s,children:a,onBlur:n,...r},o)=>{const l=Re(r),i=Ue(o),{fieldProps:c,inputProps:u}=pt({...r,focusRef:i,labelElementType:"span"});return l.wrapper=v(l.wrapper,r.disabled&&"pointer-events-none"),t.jsx(bt,{wrapperProps:ne(s,{onBlur:d=>{i.current.contains(d.relatedTarget)||n==null||n(d)},onClick:()=>{const d=as(i);d==null||d.focusFirst()}}),fieldClassNames:l,ref:i,...c,children:t.jsx(zt,{inputProps:u,className:v(l.input,"gap-10"),ref:e,children:a})})});function xa(e){return e instanceof ns?"day":"minute"}function Be(e,s,a){return s!=null&&e.compare(s)<0||a!=null&&e.compare(a)>0}function At(e,s){const a=gt(),[n,r]=x.useState(!1),o=s.closeDialogOnSelection??!0,l=s.granularity||xa(e),i=s.min?ee(s.min,a):void 0,c=s.max?ee(s.max,a):void 0;return{timezone:a,granularity:l,min:i,max:c,calendarIsOpen:n,setCalendarIsOpen:r,closeDialogOnSelection:o}}function Tt(e){return e.set({hour:0,minute:0,second:0,millisecond:0})}function q(e){return e.set({hour:24-1,minute:60-1,second:60-1,millisecond:1e3-1})}function fa(e){var U,H;const s=Ge(),[a,n]=x.useState({start:(!e.value||!e.value.start)&&!((U=e.defaultValue)!=null&&U.start),end:(!e.value||!e.value.end)&&!((H=e.defaultValue)!=null&&H.end)}),r=e.onChange,[o,l]=re(e.value?Me(e.value,s):void 0,e.value?void 0:Me(e.defaultValue,s),y=>{n({start:!1,end:!1}),r==null||r(y)}),{min:i,max:c,granularity:u,timezone:d,calendarIsOpen:m,setCalendarIsOpen:h,closeDialogOnSelection:f}=At(o.start,e),g=x.useCallback(()=>{n({start:!0,end:!0}),l(Me(null,s)),r==null||r(null),h(!1)},[s,l,r,h]),[j,R]=x.useState(null),[I,P]=x.useState(!1),[C,D]=x.useState(o),[$,F]=x.useState(()=>at(o,c)),b=x.useCallback(y=>{let N=y.start,z=y.end;i&&(N=Ae(N,i));const B=c?Te(c,z):z;N=Te(N,B);const de=i?Ae(i,N):N;return z=Ae(z,de),c&&(z=Te(z,c)),{start:ee(N,d),end:ee(z,d)}},[i,c,d]),w=x.useCallback(y=>{const N={...b(y),preset:y.preset};l(N),D(N),F(at(N,c)),n({start:!1,end:!1})},[l,b,c]),S=x.useCallback(y=>!a.start&&ue(y,C.start)||!a.end&&ue(y,C.end),[C,a]),V=x.useCallback(y=>(I||!a.start&&!a.end)&&y.compare(C.start)>=0&&y.compare(C.end)<=0,[C,a,I]),T=x.useCallback(y=>ue(y,C.start),[C]),O=x.useCallback(y=>ue(y,C.end),[C]),G=x.useCallback((y,N)=>({onPointerEnter:()=>{I&&N&&D(Le({start:j,end:y,timezone:d}))},onClick:()=>{if(!I)P(!0),R(y),D(Le({start:y,end:y,timezone:d}));else{const z=Le({start:j,end:y,timezone:d});z.start=Tt(z.start),z.end=q(z.end),P(!1),R(null),w==null||w(z),f&&(h==null||h(!1))}}}),[j,I,w,h,f,d]);return{selectedValue:o,setSelectedValue:w,calendarIsOpen:m,setCalendarIsOpen:h,dayIsActive:S,dayIsHighlighted:V,dayIsRangeStart:T,dayIsRangeEnd:O,getCellProps:G,calendarDates:$,setIsPlaceholder:n,isPlaceholder:a,clear:g,setCalendarDates:F,min:i,max:c,granularity:u,timezone:d,closeDialogOnSelection:f}}function at(e,s){let a=xe(fe(e.start)),n=xe(he(e.end));return jt(a,n)&&(n=he(n.add({months:1}))),s&&n.compare(s)>0&&(n=a,a=fe(a.subtract({months:1}))),[a,n]}function Le(e){const s=ee(e.start,e.timezone),a=ee(e.end,e.timezone);return s.compare(a)>0?{start:a,end:s}:{start:s,end:a}}function Me(e,s){return e!=null&&e.start&&(e!=null&&e.end)?e:!(e!=null&&e.start)&&(e!=null&&e.end)?(e.start=e.end.subtract({months:1}),e):!(e!=null&&e.end)&&(e!=null&&e.start)?(e.end=e.start.add({months:1}),e):{start:s,end:s.add({months:1})}}const Lt=se(t.jsx("path",{d:"M16.01 11H4v2h12.01v3L20 12l-3.99-4v3z"}),"ArrowRightAltOutlined");function ha(e,s,a,n){switch(s){case"era":case"year":case"month":case"day":return e.cycle(s,a,{round:s==="year"})}if("hour"in e)switch(s){case"dayPeriod":{const r=e.hour,o=r>=12;return e.set({hour:o?r-12:r+12})}case"hour":case"minute":case"second":return e.cycle(s,a,{round:s!=="hour",hourCycle:n.hour12?12:24})}return e}function pa(e,s,a,n){switch(s){case"day":case"month":case"year":return e.set({[s]:a})}if("hour"in e)switch(s){case"dayPeriod":{const r=e.hour,o=r>=12;return a>=12===o?e:e.set({hour:o?r-12:r+12})}case"hour":if(n.hour12){const o=e.hour>=12;!o&&a===12&&(a=0),o&&a<12&&(a+=12)}case"minute":case"second":return e.set({[s]:a})}return e}const nt={year:5,month:2,day:7,hour:2,minute:15,second:15,dayPeriod:1};function ba({segment:e,domProps:s,value:a,onChange:n,isPlaceholder:r,state:{timezone:o,calendarIsOpen:l,setCalendarIsOpen:i}}){const c=ce(),u=x.useRef(""),{localeCode:d}=Fe(),m=oe(),h=te({timeZone:o}),f=x.useMemo(()=>new rs(d,{maximumFractionDigits:0}),[d]),g=b=>{n(pa(a,e.type,b,h.resolvedOptions()))},j=b=>{n(ha(a,e.type,b,h.resolvedOptions()))},R=()=>{if(f.isValidPartialNumber(e.text)){const b=e.text.slice(0,-1),w=f.parse(b);if(b.length===0||w===0){const S=os(o);e.type in S&&g(S[e.type])}else g(w);u.current=b}else e.type==="dayPeriod"&&j(-1)},I=b=>{var w;if(!(b.ctrlKey||b.metaKey||b.shiftKey||b.altKey)){switch(b.key){case"ArrowLeft":b.preventDefault(),b.stopPropagation(),m==null||m.focusPrevious();break;case"ArrowRight":b.preventDefault(),b.stopPropagation(),m==null||m.focusNext();break;case"Enter":(w=b.target.closest("form"))==null||w.requestSubmit(),i(!l);break;case"Tab":break;case"Backspace":case"Delete":{b.preventDefault(),b.stopPropagation(),R();break}case"ArrowUp":b.preventDefault(),u.current="",j(1);break;case"ArrowDown":b.preventDefault(),u.current="",j(-1);break;case"PageUp":b.preventDefault(),u.current="",j(nt[e.type]||1);break;case"PageDown":b.preventDefault(),u.current="",j(-(nt[e.type]||1));break;case"Home":b.preventDefault(),u.current="",g(e.maxValue);break;case"End":b.preventDefault(),u.current="",g(e.minValue);break}$(b.key)}},P=te({hour:"numeric",hour12:!0}),C=x.useMemo(()=>{const b=new Date;return b.setHours(0),P.formatToParts(b).find(w=>w.type==="dayPeriod").value},[P]),D=x.useMemo(()=>{const b=new Date;return b.setHours(12),P.formatToParts(b).find(w=>w.type==="dayPeriod").value},[P]),$=b=>{const w=u.current+b;switch(e.type){case"dayPeriod":if(C.toLowerCase().startsWith(b))g(0);else if(D.toLowerCase().startsWith(b))g(12);else break;m==null||m.focusNext();break;case"day":case"hour":case"minute":case"second":case"month":case"year":{if(!f.isValidPartialNumber(w))return;let S=f.parse(w),V=S,T=e.minValue===0;if(e.type==="hour"&&h.resolvedOptions().hour12){switch(h.resolvedOptions().hourCycle){case"h11":S>11&&(V=f.parse(b));break;case"h12":T=!1,S>12&&(V=f.parse(b));break}e.value>=12&&S>1&&(S+=12)}else S>e.maxValue&&(V=f.parse(b));if(Number.isNaN(S))return;const O=V!==0||T;O&&g(V),+`${S}0`>e.maxValue||w.length>=String(e.maxValue).length?(u.current="",O&&(m==null||m.focusNext())):u.current=w;break}}},F=c?{}:{"aria-label":e.type,"aria-valuetext":r?void 0:`${e.value}`,"aria-valuemin":e.minValue,"aria-valuemax":e.maxValue,"aria-valuenow":r?void 0:e.value,tabIndex:0,onKeyDown:I};return t.jsx("div",{...ne(s,{...F,onFocus:b=>{u.current="",b.target.scrollIntoView({block:"nearest"})},onClick:b=>{b.preventDefault(),b.stopPropagation()}}),className:"box-content cursor-default select-none whitespace-nowrap rounded p-2 text-center tabular-nums caret-transparent outline-none focus:bg-primary focus:text-on-primary",children:e.text.padStart(e.minLength,"0")})}function ga({segment:e,domProps:s}){const a=oe();return t.jsx("div",{...s,onPointerDown:n=>{n.pointerType==="mouse"&&(n.preventDefault(),a!=null&&a.focusNext({from:n.target})||a==null||a.focusPrevious({from:n.target}))},"aria-hidden":!0,className:"min-w-4 cursor-default select-none",children:e.text})}function ja(e,s,a){switch(s){case"year":return{value:e.year,placeholder:"yyyy",minValue:1,maxValue:e.calendar.getYearsInEra(e)};case"month":return{value:e.month,placeholder:"mm",minValue:is(e),maxValue:e.calendar.getMonthsInYear(e)};case"day":return{value:e.day,minValue:ls(e),maxValue:e.calendar.getDaysInMonth(e),placeholder:"dd"}}if("hour"in e)switch(s){case"dayPeriod":return{value:e.hour>=12?12:0,minValue:0,maxValue:12,placeholder:"--"};case"hour":if(a.hour12){const n=e.hour>=12;return{value:e.hour,minValue:n?12:0,maxValue:n?23:11,placeholder:"--"}}return{value:e.hour,minValue:0,maxValue:23,placeholder:"--"};case"minute":return{value:e.minute,minValue:0,maxValue:59,placeholder:"--"}}return{}}function pe({segmentProps:e,state:s,value:a,onChange:n,isPlaceholder:r}){const{granularity:o}=s,l=x.useMemo(()=>{const d={year:"numeric",month:"numeric",day:"numeric"};return o==="minute"&&(d.hour="numeric",d.minute="numeric"),d},[o]),i=te(l),c=x.useMemo(()=>a.toDate(),[a]),u=x.useMemo(()=>i.formatToParts(c).map(d=>{const m=ja(a,d.type,i.resolvedOptions()),h=r&&d.type!=="literal"?m.placeholder:d.value;return{type:d.type,text:d.value===", "?" ":h,...m,minLength:d.type!=="literal"?String(m.maxValue).length:1}}),[c,i,r,a]);return t.jsx("div",{className:"flex items-center",children:u.map((d,m)=>d.type==="literal"?t.jsx(ga,{domProps:e,segment:d},m):t.jsx(ba,{isPlaceholder:r,domProps:e,state:s,value:a,onChange:n,segment:d},m))})}function ya({date:e,currentMonth:s,state:{dayIsActive:a,dayIsHighlighted:n,dayIsRangeStart:r,dayIsRangeEnd:o,getCellProps:l,timezone:i,min:c,max:u}}){const{localeCode:d}=Fe(),m=cs(e,d),h=a(e),f=n(e),g=r(e),j=o(e),R=ds(e,i),I=jt(e,s),P=Be(e,c,u);return t.jsxs("div",{role:"button","aria-disabled":P,className:v("w-40 h-40 text-sm relative isolate flex-shrink-0",P&&"text-disabled pointer-events-none",!I&&"invisible pointer-events-none"),...l(e,I),children:[t.jsx("span",{className:v("absolute inset-0 flex items-center justify-center rounded-full w-full h-full select-none z-10 cursor-pointer",!h&&!R&&"hover:bg-hover",h&&"bg-primary text-on-primary font-semibold",R&&!h&&"bg-chip"),children:e.day}),f&&I&&t.jsx("span",{className:v("absolute w-full h-full inset-0 bg-primary/focus",(g||m===0||e.day===1)&&"rounded-l-full",(j||m===6||e.day===s.calendar.getDaysInMonth(s))&&"rounded-r-full")})]})}function va({startDate:e,state:s,isFirst:a,isLast:n}){const{localeCode:r}=Fe(),o=us(e,r),l=De(e,r);return t.jsxs("div",{className:"w-280 flex-shrink-0",children:[t.jsx(wa,{isFirst:a,isLast:n,state:s,currentMonth:e}),t.jsxs("div",{className:"block",role:"grid",children:[t.jsx(ka,{state:s,startDate:e}),[...new Array(o).keys()].map(i=>t.jsx(ae.div,{className:"flex mb-6",children:[...new Array(7).keys()].map(c=>t.jsx(ya,{date:l.add({weeks:i,days:c}),currentMonth:e,state:s},c))},i))]})]})}function wa({currentMonth:e,isFirst:s,isLast:a,state:{calendarDates:n,setCalendarDates:r,timezone:o,min:l,max:i}}){const c=h=>{const f=n.length;let g;h==="forward"?g=n.map(j=>he(j.add({months:f}))):g=n.map(j=>he(j.subtract({months:f}))),r(g)},u=te({month:"long",year:"numeric",era:e.calendar.identifier!=="gregory"?"long":void 0,calendar:e.calendar.identifier}),d=Be(e.subtract({days:1}),l,i),m=Be(fe(e.add({months:1})),l,i);return t.jsxs("div",{className:"flex items-center justify-between gap-10",children:[t.jsx(Z,{size:"md",className:v("text-muted",!s&&"invisible"),disabled:!s||d,"aria-hidden":!s,onClick:()=>{c("backward")},children:t.jsx(ms,{})}),t.jsx("div",{className:"text-sm font-semibold select-none",children:u.format(e.toDate(o))}),t.jsx(Z,{size:"md",className:v("text-muted",!a&&"invisible"),disabled:!a||m,"aria-hidden":!a,onClick:()=>{c("forward")},children:t.jsx(xs,{})})]})}function ka({state:{timezone:e},startDate:s}){const{localeCode:a}=Fe(),n=te({weekday:"short"}),r=De(s,a);return t.jsx("div",{className:"flex",children:[...new Array(7).keys()].map(o=>{const i=r.add({days:o}).toDate(e),c=n.format(i);return t.jsx("div",{className:"w-40 h-40 text-sm font-semibold relative flex-shrink-0",children:t.jsx("div",{className:"absolute flex items-center justify-center w-full h-full select-none",children:c})},o)})})}function Mt({state:e,visibleMonths:s=1}){return ce()&&(s=1),t.jsx(x.Fragment,{children:[...new Array(s).keys()].map(n=>{const r=xe(fe(e.calendarDates[n])),o=n===0,l=n===s-1;return t.jsx(va,{state:e,startDate:r,isFirst:o,isLast:l},n)})})}const Et=x.memo(({start:e,end:s,options:a,preset:n})=>{const{dates:r}=fs(),o=gt(),l=te(a||hs[n||(r==null?void 0:r.format)]);if(!e||!s)return null;let i;try{i=l.formatRange(rt(e,o),rt(s,o))}catch{i=""}return t.jsx(x.Fragment,{children:i})},yt);function rt(e,s){return typeof e=="string"?ps(e,s).toDate():"toDate"in e?e.toDate(s):e}function Ca(){var a,n,r;const e=(a=He())==null?void 0:a.settings.dates.default_timezone,s=((r=(n=He())==null?void 0:n.user)==null?void 0:r.timezone)||e||"auto";return!s||s==="auto"?bs():s}const A=Tt(gs(Ca()));var ct,dt;const Ee=((dt=(ct=He())==null?void 0:ct.i18n)==null?void 0:dt.language)||"en",Xe=[{key:0,label:k("Today"),getRangeValue:()=>({preset:0,start:A,end:q(A)})},{key:1,label:k("Yesterday"),getRangeValue:()=>({preset:1,start:A.subtract({days:1}),end:q(A).subtract({days:1})})},{key:2,label:k("This week"),getRangeValue:()=>({preset:2,start:De(A,Ee),end:js(q(A),Ee)})},{key:3,label:k("Last week"),getRangeValue:()=>{const e=De(A,Ee).subtract({days:7});return{preset:3,start:e,end:e.add({days:6})}}},{key:4,label:k("Last 7 days"),getRangeValue:()=>({preset:4,start:A.subtract({days:7}),end:q(A)})},{key:6,label:k("Last 30 days"),getRangeValue:()=>({preset:6,start:A.subtract({days:30}),end:q(A)})},{key:7,label:k("Last 3 months"),getRangeValue:()=>({preset:7,start:A.subtract({months:3}),end:q(A)})},{key:8,label:k("Last 12 months"),getRangeValue:()=>({preset:8,start:A.subtract({months:12}),end:q(A)})},{key:9,label:k("This month"),getRangeValue:()=>({preset:9,start:fe(A),end:he(q(A))})},{key:10,label:k("This year"),getRangeValue:()=>({preset:10,start:et(A),end:tt(q(A))})},{key:11,label:k("Last year"),getRangeValue:()=>({preset:11,start:et(A).subtract({years:1}),end:tt(q(A)).subtract({years:1})})}];function Da({onPresetSelected:e,selectedValue:s}){return t.jsx(vt,{children:Xe.map(a=>t.jsx(wt,{borderRadius:"rounded-none",capitalizeFirst:!0,isSelected:(s==null?void 0:s.preset)===a.key,onSelected:()=>{const n=a.getRangeValue();e(n)},children:t.jsx(p,{...a.label})},a.key))})}function Sa(e){return ys("(max-width: 1024px)",e)}const Ot=E.forwardRef((e,s)=>{const{children:a,size:n="sm",description:r,className:o,invalid:l,autoFocus:i,errorMessage:c,iconRight:u,...d}=e,m=Ue(s);vs({autoFocus:i},m);const h=Na(n),f=Re(e),g=x.useId();return t.jsxs("div",{className:v(o,"isolate"),children:[t.jsxs("label",{className:"flex select-none items-center",children:[t.jsx("input",{...d,type:"checkbox",role:"switch","aria-invalid":l||void 0,"aria-describedby":r?g:void 0,ref:m,"aria-checked":d.checked,className:v(h,!l&&"checked:border-primary checked:bg-primary dark:checked:border-primary-dark dark:checked:bg-primary-dark",l&&"checked:border-danger checked:bg-danger","relative flex flex-shrink-0 cursor-pointer appearance-none items-center overflow-hidden rounded-3xl border border-chip bg-chip p-0 outline-none transition-colors checked:border-primary checked:bg-primary","before:z-10 before:block before:translate-x-2 before:rounded-3xl before:border before:bg-white before:transition-transform","checked:before:border-white","focus-visible:ring",e.disabled&&"cursor-not-allowed opacity-80")}),a&&t.jsx("span",{className:v(f.size.font,"ml-12",l&&"text-danger",e.disabled&&"text-disabled"),children:a}),u]}),r&&!c&&t.jsx("div",{id:g,className:f.description,children:r}),c&&t.jsx("div",{id:g,className:f.error,children:c})]})});function Ht(e){const{field:{onChange:s,onBlur:a,value:n=!1,ref:r},fieldState:{invalid:o,error:l}}=je({name:e.name}),i={onChange:c=>{c.target.value&&c.target.value!=="on"?s(c.target.checked?c.target.value:!1):s(c)},onBlur:a,checked:!!n,invalid:o,errorMessage:l==null?void 0:l.message,name:e.name};return t.jsx(Ot,{ref:r,...ne(e,i)})}function Na(e){switch(e){case"xl":return"w-68 h-36 before:w-28 before:h-28 checked:before:translate-x-36";case"lg":return"w-56 h-30 before:w-22 before:h-22 checked:before:translate-x-30";case"md":return"w-46 h-24 before:w-18 before:h-18 checked:before:translate-x-24";case"xs":return"w-30 h-18 before:w-12 before:h-12 checked:before:translate-x-14";default:return"w-38 h-20 before:w-14 before:h-14 checked:before:translate-x-20"}}const Ia=[{key:0,label:k("Preceding period"),getRangeValue:e=>{const s=e.start,r=(e.end.toDate().getTime()-s.toDate().getTime())/(1e3*60);return{preset:0,start:s.subtract({minutes:r}),end:s}}},{key:1,label:k("Same period last year"),getRangeValue:e=>({start:e.start.subtract({years:1}),end:e.end.subtract({years:1}),preset:1})},{key:2,label:k("Custom"),getRangeValue:e=>({start:e.start.subtract({weeks:1}),end:e.end.subtract({weeks:1}),preset:2})}];function Pa({originalRangeValue:e,onPresetSelected:s,selectedValue:a}){return t.jsx(vt,{children:Ia.map(n=>t.jsx(wt,{borderRadius:"rounded-none",capitalizeFirst:!0,isSelected:(a==null?void 0:a.preset)===n.key,onSelected:()=>{const r=n.getRangeValue(e);s(r)},children:t.jsx(p,{...n.label})},n.key))})}function Ra({state:e,compareState:s,showInlineDatePickerField:a=!1,compareVisibleDefault:n=!1}){const r=Sa(),{close:o}=_(),l=x.useRef(e),i=e.isPlaceholder.start||e.isPlaceholder.end,[c,u]=x.useState(n),d=t.jsxs(ie,{dividerTop:!0,startAction:!i&&!r?t.jsx("div",{className:"text-xs",children:t.jsx(Et,{start:e.selectedValue.start.toDate(),end:e.selectedValue.end.toDate(),options:{dateStyle:"medium"}})}):void 0,children:[t.jsx(M,{variant:"text",size:"xs",onClick:()=>{e.setSelectedValue(l.current.selectedValue),e.setIsPlaceholder(l.current.isPlaceholder),o()},children:t.jsx(p,{message:"Cancel"})}),t.jsx(M,{variant:"flat",color:"primary",size:"xs",onClick:()=>{const m=e.selectedValue;s&&c&&(m.compareStart=s.selectedValue.start,m.compareEnd=s.selectedValue.end),o(m)},children:t.jsx(p,{message:"Select"})})]});return t.jsxs(J,{size:"auto",children:[t.jsxs(X,{className:"flex",padding:"p-0",children:[!r&&t.jsxs("div",{className:"min-w-192 py-14",children:[t.jsx(Da,{selectedValue:e.selectedValue,onPresetSelected:m=>{e.setSelectedValue(m),e.closeDialogOnSelection&&o(m)}}),!!s&&t.jsxs(x.Fragment,{children:[t.jsx(Ot,{className:"mx-20 mb-10 mt-14",checked:c,onChange:m=>u(m.target.checked),children:t.jsx(p,{message:"Compare"})}),c&&t.jsx(Pa,{originalRangeValue:e.selectedValue,selectedValue:s.selectedValue,onPresetSelected:m=>{s.setSelectedValue(m)}})]})]}),t.jsx(me,{initial:!1,children:t.jsx($a,{state:e,compareState:s,showInlineDatePickerField:a,compareVisible:c})})]}),!e.closeDialogOnSelection&&d]})}function $a({state:e,compareState:s,showInlineDatePickerField:a,compareVisible:n}){return t.jsxs(ae.div,{initial:{width:0,overflow:"hidden"},animate:{width:"auto"},exit:{width:0,overflow:"hidden"},transition:{type:"tween",duration:.125},className:"border-l px-20 pb-20 pt-10",children:[a&&t.jsxs("div",{children:[t.jsx(ot,{state:e}),!!s&&n&&t.jsx(ot,{state:s,label:t.jsx(p,{message:"Compare"})})]}),t.jsx("div",{className:"flex items-start gap-36",children:t.jsx(Mt,{state:e,visibleMonths:2})})]})}function ot({state:e,label:s}){const{selectedValue:a,setSelectedValue:n}=e;return t.jsxs(Je,{className:"mb-20 mt-10",label:s,children:[t.jsx(pe,{state:e,value:a.start,onChange:r=>{n({...a,start:r})}}),t.jsx(Lt,{className:"block flex-shrink-0 text-muted",size:"md"}),t.jsx(pe,{state:e,value:a.end,onChange:r=>{n({...a,end:r})}})]})}function Fa(e){var h,f;const{granularity:s,closeDialogOnSelection:a,...n}=e,r=fa(e),o=x.useRef(null),i=ce()&&s!=="day",c=t.jsx(Q,{offset:8,placement:"bottom-start",isOpen:r.calendarIsOpen,onOpenChange:r.setCalendarIsOpen,type:"popover",triggerRef:o,returnFocusToTrigger:!1,moveFocusToDialog:!1,children:t.jsx(Ra,{state:r})}),u={onClick:g=>{g.stopPropagation(),g.preventDefault(),Va(g)?r.setCalendarIsOpen(!1):r.setCalendarIsOpen(!0)}},d=r.selectedValue,m=r.setSelectedValue;return t.jsxs(x.Fragment,{children:[t.jsxs(Je,{ref:o,wrapperProps:u,endAdornment:i?void 0:t.jsx(Vt,{}),...n,children:[t.jsx(pe,{isPlaceholder:(h=r.isPlaceholder)==null?void 0:h.start,state:r,segmentProps:u,value:d.start,onChange:g=>{m({start:g,end:d.end})}}),t.jsx(Lt,{className:"block flex-shrink-0 text-muted",size:"md"}),t.jsx(pe,{isPlaceholder:(f=r.isPlaceholder)==null?void 0:f.end,state:r,segmentProps:u,value:d.end,onChange:g=>{m({start:d.start,end:g})}})]}),c]})}function Va(e){return["hour","minute","dayPeriod"].includes(e.currentTarget.ariaLabel||"")}function za(e){const{field:{onChange:s,onBlur:a,value:n,ref:r},fieldState:{invalid:o,error:l}}=je({name:e.name}),i={onChange:c=>{s(c?Bt(c):null)},onBlur:a,value:Aa(n),invalid:o,errorMessage:l==null?void 0:l.message,inputRef:r};return t.jsx(Fa,{...ne(i,e)})}function Aa(e){const{start:s,end:a,preset:n}=e||{},r={preset:n};try{s&&(r.start=typeof s=="string"?Se(s):s),a&&(r.end=typeof a=="string"?Se(a):a)}catch{}return r}function Bt({start:e,end:s,preset:a}={}){const n={preset:a};return e&&(n.start=e.toAbsoluteString()),s&&(n.end=s.toAbsoluteString()),n}function qt({filter:e}){return t.jsx(za,{min:e.control.min,max:e.control.max,size:"sm",name:`${e.key}.value`,granularity:"day",closeDialogOnSelection:!0})}const Kt={"=":k("is"),"!=":k("is not"),">":k("is greater than"),">=":k("is greater than or equal to"),"<":k("is less than"),"<=":k("is less than or equal to"),has:k("Include"),doesntHave:k("Do not include"),between:k("Is between"),hasAll:k("Include all")};function _t({filter:e}){var a;const s=e.control;return t.jsxs(x.Fragment,{children:[t.jsx(ft,{selectionMode:"single",name:`${e.key}.operator`,className:"mb-14",size:"sm",required:!0,children:(a=e.operators)==null?void 0:a.map(n=>t.jsx(Ie,{value:n,children:t.jsx(p,{...Kt[n]})},n))}),t.jsx(We,{size:"sm",name:`${e.key}.value`,type:e.control.inputType,min:"minValue"in s?s.minValue:void 0,max:"maxValue"in s?s.maxValue:void 0,minLength:"minLength"in s?s.minLength:void 0,maxLength:"maxLength"in s?s.maxLength:void 0,required:!0})]})}function qe(e){return{id:e,name:`${e}`,description:`${e}`}}function Ta(e,s){const a=x.useRef(null),n=Ue(s),{displayWith:r=B=>B.name,validateWith:o,children:l,suggestions:i,isLoading:c,inputValue:u,onInputValueChange:d,onItemSelected:m,placeholder:h,onOpenChange:f,chipSize:g="sm",openMenuOnFocus:j=!0,showEmptyMessage:R,value:I,defaultValue:P,onChange:C,valueKey:D,isAsync:$,allowCustomValue:F=!0,showDropdownArrow:b,onChipClick:w,...S}=e,V=Re({...e,flexibleHeight:!0}),[T,O]=Ea(e),[G,U]=x.useState(!1),H=t.jsx(Ss,{isIndeterminate:!0,size:"sm","aria-label":"loading..."}),y=b?t.jsx(_e,{}):null,{fieldProps:N,inputProps:z}=pt({...S,focusRef:n,endAdornment:c&&G?H:y});return t.jsx(bt,{fieldClassNames:V,...N,children:t.jsxs(zt,{ref:a,className:v("flex flex-wrap items-center",V.input),onClick:()=>{var B;(B=n.current)==null||B.focus()},children:[t.jsx(La,{displayChipUsing:r,onChipClick:w,items:T,setItems:O,chipSize:g}),t.jsx(Ma,{size:e.size,showEmptyMessage:R,inputProps:z,inputValue:u,onInputValueChange:d,fieldRef:a,inputRef:n,chips:T,setChips:O,validateWith:o,isLoading:c,suggestions:i,placeholder:h,openMenuOnFocus:j,listboxIsOpen:G,setListboxIsOpen:U,allowCustomValue:F,children:l})]})})}function La({items:e,setItems:s,displayChipUsing:a,chipSize:n,onChipClick:r}){const o=oe(),l=x.useCallback(i=>{const c=e.findIndex(d=>d.id===i),u=[...e];return c>-1&&(u.splice(c,1),s(u)),u},[e,s]);return t.jsx(qs,{className:v("max-w-full flex-shrink-0 flex-wrap",n==="xs"?"my-6":"my-8"),size:n,selectable:!0,children:e.map(i=>t.jsx(ws,{errorMessage:i.errorMessage,adornment:i.image?t.jsx(we,{circle:!0,src:i.image}):null,onClick:()=>r==null?void 0:r(i),onRemove:()=>{l(i.id).length?o==null||o.focusPrevious({tabbable:!0}):o==null||o.focusLast()},children:a(i)},i.id))})}function Ma(e){const{inputRef:s,fieldRef:a,validateWith:n,setChips:r,chips:o,suggestions:l,inputProps:i,placeholder:c,openMenuOnFocus:u,listboxIsOpen:d,setListboxIsOpen:m,allowCustomValue:h,isLoading:f,size:g}=e,j=oe(),R=x.useCallback(y=>{y=(y||[]).filter(N=>{const z=!N||!N.id||!N.name;return!(o.findIndex(de=>de.id===(N==null?void 0:N.id))>-1)&&!z}),y.length&&(n&&(y=y.map(N=>n(N))),r([...o,...y]))},[o,r,n]),I=ks({...e,clearInputOnItemSelection:!0,isOpen:d,onOpenChange:m,items:l,selectionMode:"none",role:"listbox",virtualFocus:!0,onItemSelected:y=>{O(y)}}),{state:{activeIndex:P,setActiveIndex:C,isOpen:D,setIsOpen:$,inputValue:F,setInputValue:b},refs:w,listboxId:S,collection:V,onInputChange:T}=I,O=y=>{const N=V.size&&P!=null?[...V.values()][P]:null;N!=null&&N.item?R([N.item]):h&&R([qe(N?N.value:y)]),b(""),C(null),$(!1)};mt(()=>{a.current&&w.reference.current!==a.current&&I.reference(a.current)},[a,I,w]);const{handleTriggerKeyDown:G,handleListboxKeyboardNavigation:U}=Ns(I),H=Is(()=>{u&&!D&&$(!0)});return t.jsx(Cs,{listbox:I,mobileOverlay:Ds,isLoading:f,onPointerDown:y=>{y.preventDefault()},children:t.jsx("input",{type:"text",className:v("mx-8 my-4 min-w-30 flex-[1_1_60px] bg-transparent text-sm outline-none",g==="xs"?"h-20":"h-30"),placeholder:c,...ne(i,{ref:s,value:F,onChange:T,onPaste:y=>{const z=y.clipboardData.getData("text").match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);if(z){y.preventDefault();const B=window.getSelection();B!=null&&B.rangeCount&&(B.deleteFromDocument(),R(z.map(de=>qe(de))))}},"aria-autocomplete":"list","aria-controls":D?S:void 0,autoComplete:"off",autoCorrect:"off",spellCheck:"false",onKeyDown:y=>{const N=y.target;if(y.key==="Enter"){y.preventDefault(),O(N.value);return}if(y.key==="Escape"&&D&&($(!1),b("")),y.key==="ArrowUp"&&D&&(P===0||P==null)){C(null);return}if(P!=null&&(y.key==="ArrowLeft"||y.key==="ArrowRight")){y.preventDefault();return}if((y.key==="ArrowLeft"||y.key==="Backspace"||y.key==="Delete")&&N.selectionStart===0&&P==null&&o.length){j==null||j.focusPrevious({tabbable:!0});return}G(y)||U(y)},onFocus:H,onClick:H})})})}function Ea({onChange:e,value:s,defaultValue:a,valueKey:n}){const r=x.useMemo(()=>lt(s),[s]),o=x.useMemo(()=>lt(a),[a]),l=x.useCallback(i=>{const c=n?i.map(u=>u[n]):i;e==null||e(c)},[e,n]);return re(r||void 0,o||[],l)}function lt(e){if(e!=null)return e.map(s=>typeof s!="object"?qe(s):s)}const Oa=E.forwardRef(Ta);function Ha({children:e,...s}){const{field:{onChange:a,onBlur:n,value:r=[],ref:o},fieldState:{invalid:l,error:i}}=je({name:s.name}),c={onChange:a,onBlur:n,value:r,invalid:l,errorMessage:i==null?void 0:i.message};return t.jsx(Oa,{ref:o,...ne(c,s),children:e})}function Ut({filter:e}){const{trans:s}=Y();return t.jsx(Ha,{size:"sm",name:`${e.key}.value`,valueKey:"id",allowCustomValue:!1,showDropdownArrow:!0,placeholder:e.control.placeholder?s(e.control.placeholder):void 0,displayWith:a=>{var n;return(n=e.control.options.find(r=>r.key===a.id))==null?void 0:n.label.message},suggestions:e.control.options.map(a=>({id:a.key,name:a.label.message})),children:a=>t.jsx(Ie,{value:a.id,children:t.jsx(p,{message:a.name})},a.id)})}const Ba=x.memo(({value:e,...s})=>{const a=Ps(s);return isNaN(e)&&(e=0),t.jsx(x.Fragment,{children:a.format(e)})},yt);function qa(e){switch(e.filter.control.type){case L.DateRangePicker:return t.jsx(Ka,{...e});case L.BooleanToggle:return t.jsx(_a,{...e});case L.Select:return t.jsx(Ua,{...e});case L.ChipField:return t.jsx(Wa,{...e});case L.Input:return t.jsx(Za,{...e});case L.SelectModel:return t.jsx(Ga,{...e});case L.Custom:const s=e.filter.control.listItem;return t.jsx(s,{...e});default:return null}}function Ka(e){const{value:s,filter:a}=e;let n;return s.preset!==void 0?n=t.jsx(p,{...Xe[s.preset].label}):n=t.jsx(Et,{start:new Date(s.start),end:new Date(s.end),options:{dateStyle:"medium"}}),t.jsx(ke,{...e,label:n,panel:t.jsx(qt,{filter:a})})}function _a({filter:e,isInactive:s,onValueChange:a}){return t.jsx(Pt,{onClick:()=>{a({value:e.control.defaultValue})},filter:e,isInactive:s})}function Ua(e){const{filter:s,value:a}=e,n=s.control.options.find(r=>r.key===a);return t.jsx(ke,{...e,label:n?t.jsx(p,{...n.label}):null,panel:t.jsx(Rt,{filter:s})})}function Wa(e){return t.jsx(ke,{...e,label:t.jsx(Qa,{...e}),panel:t.jsx(Ut,{filter:e.filter})})}function Qa(e){const{trans:s}=Y(),{filter:a,value:n}=e,r=n.map(c=>a.control.options.find(u=>u.key===c)),o=3,l=n.length-o,i=t.jsx(x.Fragment,{children:r.filter(Boolean).slice(0,o).map((c,u)=>{let d="";return u!==0&&(d+=", "),d+=s(c.label),d})});return l>0?t.jsx(p,{message:":names + :count more",values:{names:i,count:l}}):i}function Za(e){const{filter:s,value:a,operator:n}=e,r=n?t.jsx(p,{...Kt[n]}):null,o=s.control.inputType==="number"?t.jsx(Ba,{value:a}):a;return t.jsx(ke,{...e,label:t.jsxs(x.Fragment,{children:[r," ",o]}),panel:t.jsx(_t,{filter:s})})}function Ga(e){const{value:s,filter:a}=e,{isLoading:n,data:r}=$t(`normalized-models/${a.control.model}/${s}`,void 0,{enabled:!!s}),o=t.jsxs(x.Fragment,{children:[t.jsx(W,{variant:"avatar",size:"w-18 h-18 mr-6"}),t.jsx(W,{variant:"rect",size:"w-50"})]}),l=t.jsxs(x.Fragment,{children:[t.jsx(we,{size:"xs",src:r==null?void 0:r.model.image,className:"mr-6"}),r==null?void 0:r.model.name]}),i=n||!r?o:l;return t.jsx(ke,{...e,label:i,panel:t.jsx(Ft,{filter:a})})}function Ya({filters:e,pinnedFilters:s,className:a}){const{decodedFilters:n,remove:r,replaceAll:o}=ze(e,s);return n.length?t.jsx("div",{className:v("flex items-center gap-6 overflow-x-auto",a),children:n.map((l,i)=>{const c=e.find(d=>d.key===l.key);if(!c)return null;const u=d=>{const m=[...n];m.splice(i,1,{key:c.key,value:d.value,isInactive:!1,operator:d.operator||c.defaultOperator}),o(m)};return t.jsxs("div",{children:[!l.isInactive&&t.jsx(Z,{variant:"outline",color:"primary",size:"xs",radius:"rounded-l-md",onClick:()=>{r(l.key)},children:t.jsx(Qe,{})}),t.jsx(qa,{filter:c,isInactive:l.isInactive,value:l.valueKey!=null?l.valueKey:l.value,operator:l.operator,onValueChange:u})]},l.key)})}):null}const Ja=se(t.jsx("path",{d:"M7 6h10l-5.01 6.3L7 6zm-2.75-.39C6.27 8.2 10 13 10 13v6c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-6s3.72-4.8 5.74-7.39c.51-.66.04-1.61-.79-1.61H5.04c-.83 0-1.3.95-.79 1.61z"}),"FilterAltOutlined"),Xa=E.forwardRef(({variant:e="default",mode:s="single",children:a,className:n,isLazy:r,...o},l)=>{const[i,c]=re(o.expandedValues,o.defaultExpandedValues||[],o.onExpandedChange),u=E.Children.count(a);return t.jsx("div",{className:v(e==="outline"&&"space-y-10",n),ref:l,role:"presentation",children:t.jsx(me,{children:t.jsx(Ke,{children:E.Children.map(a,(d,m)=>x.isValidElement(d)?x.cloneElement(d,{key:d.key||m,value:d.props.value||m,isFirst:m===0,isLast:m===u-1,mode:s,variant:e,expandedValues:i,setExpandedValues:c,isLazy:r}):null)})})})});function en(e){const{children:s,label:a,disabled:n,bodyClassName:r,labelClassName:o,buttonPadding:l="py-10 pl-14 pr-10",startIcon:i,description:c,endAppend:u,chevronPosition:d="right",isFirst:m,mode:h,isLazy:f,variant:g,footerContent:j,onHeaderMouseEnter:R,onHeaderMouseLeave:I}=e,P=e.expandedValues||[],C=e.value||0,D=e.setExpandedValues||(()=>{}),$=x.useRef(null),F=!n&&P.includes(C),b=x.useRef(!1);F&&(b.current=!0);const w=oe(),S=x.useId(),V=`${S}-button`,T=`${S}-panel`,O=H=>{switch(H.key){case"ArrowDown":w==null||w.focusNext();break;case"ArrowUp":w==null||w.focusPrevious();break;case"Home":w==null||w.focusFirst();break;case"End":w==null||w.focusLast();break}},G=()=>{const H=P.indexOf(C);if(H>-1){const y=[...P];y.splice(H,1),D(y)}else D(h==="single"?[C]:[...P,C])},U=t.jsx("div",{className:v(g==="minimal"&&""),children:t.jsx(Rs,{"aria-hidden":"true",size:"md",className:v(n?"text-disabled":"text-muted",F&&"rotate-180 transition-transform")})});return t.jsxs("div",{className:v(g==="default"&&"border-b",g==="outline"&&"rounded-panel border",n&&"text-disabled"),children:[t.jsxs("h3",{className:v("flex w-full items-center justify-between text-sm",n&&"pointer-events-none",m&&g==="default"&&"border-t",F&&g!=="minimal"?"border-b":"border-b border-b-transparent",g==="outline"?F?"rounded-panel-t":"rounded-panel":void 0),onMouseEnter:R,onMouseLeave:I,children:[t.jsxs("button",{disabled:n,"aria-expanded":F,id:V,"aria-controls":T,type:"button",ref:$,onKeyDown:O,onClick:()=>{n||G()},className:v("flex flex-auto items-center gap-10 text-left outline-none hover:bg-hover focus-visible:bg-primary/focus",l),children:[d==="left"&&U,i&&x.cloneElement(i,{size:"md",className:v(i.props.className,n?"text-disabled":"text-muted")}),t.jsxs("div",{className:"flex-auto overflow-hidden overflow-ellipsis",children:[t.jsx("div",{className:o,"data-testid":"accordion-label",children:a}),c&&t.jsx("div",{className:"text-xs text-muted",children:c})]}),d==="right"&&U]}),u&&t.jsx("div",{className:"flex-shrink-0 px-4 text-sm text-muted",children:u})]}),t.jsxs(ae.div,{"aria-labelledby":S,role:"region",variants:st.variants,transition:st.transition,initial:!1,animate:F?"open":"closed",children:[t.jsx("div",{className:v("p-16",r),children:!f||b?s:null}),j]})]})}function tn({filter:e}){return null}function sn({filters:e}){const{decodedFilters:s}=ze(e),{formId:a}=_(),[n,r]=x.useState(()=>s.map(i=>i.key)),o=t.jsx(M,{size:"xs",variant:"outline",className:"mr-auto",onClick:()=>{r([])},children:t.jsx(p,{message:"Clear"})}),l=t.jsx(M,{size:"xs",variant:"flat",color:"primary",className:"ml-auto",type:"submit",form:a,children:t.jsx(p,{message:"Apply"})});return t.jsxs(J,{className:"min-w-[300px]",maxWidth:"max-w-400",size:"auto",children:[t.jsx(le,{padding:"px-14 py-10",leftAdornment:o,rightAdornment:l,children:t.jsx(p,{message:"Filter"})}),t.jsx(X,{padding:"p-0",children:t.jsx(an,{filters:e,expandedFilters:n,setExpandedFilters:r})})]})}function an({filters:e,expandedFilters:s,setExpandedFilters:a}){const{decodedFilters:n,replaceAll:r}=ze(e),o={};e.forEach(u=>{const d=n.find(m=>m.key===u.key);o[u.key]=(d==null?void 0:d.value)!==void 0?d:{value:u.control.defaultValue,operator:u.defaultOperator}});const l=ge({defaultValues:o}),{formId:i,close:c}=_();return t.jsx(Pe,{form:l,id:i,onSubmit:u=>{const d=Object.entries(u).filter(([m,h])=>s.includes(m)&&h!==void 0).map(([m,h])=>({key:m,...h}));r(d),c()},children:t.jsx(Xa,{mode:"multiple",expandedValues:s,onExpandedChange:a,children:e.map(u=>t.jsxs(en,{startIcon:t.jsx($s,{checked:s.includes(u.key)}),value:u.key,label:t.jsx(p,{...u.label}),bodyClassName:"max-h-288 overflow-y-auto compact-scrollbar",children:[u.description&&t.jsx("div",{className:v("text-xs text-muted",u.control.type!==L.BooleanToggle&&"mb-14"),children:t.jsx(p,{...u.description})}),t.jsx(nn,{filter:u})]},u.key))})})}function nn({filter:e}){switch(e.control.type){case L.Select:return t.jsx(Rt,{filter:e});case L.ChipField:return t.jsx(Ut,{filter:e});case L.DateRangePicker:return t.jsx(qt,{filter:e});case L.SelectModel:return t.jsx(Ft,{filter:e});case L.Input:return t.jsx(_t,{filter:e});case L.BooleanToggle:return t.jsx(tn,{filter:e});case"custom":const s=e.control.panel;return t.jsx(s,{filter:e});default:return null}}function rn({filters:e,icon:s=t.jsx(Ja,{}),color:a="primary",variant:n="outline",size:r="sm",disabled:o,className:l}){const i=ce(),c=t.jsx(M,{variant:n,color:a,startIcon:s,disabled:o,size:r,className:l,children:t.jsx(p,{message:"Filter"})}),u=t.jsx(Z,{color:a,size:"sm",variant:n,disabled:o,className:l,children:s});return t.jsxs(Q,{type:"popover",children:[i?u:c,t.jsx(sn,{filters:e})]})}function Wt(e){var s;return{...e,defaultOperator:Ne.between,control:{type:L.DateRangePicker,defaultValue:((s=e.control)==null?void 0:s.defaultValue)||Bt(Xe[3].getRangeValue())}}}function on(e){return Wt({key:"created_at",label:k("Date created"),...e})}function ln(e){return Wt({key:"updated_at",label:k("Last updated"),...e})}const cn="user";function Qt({image:e,label:s,description:a,labelClassName:n,avatarSize:r="md"}){return t.jsxs("div",{className:"flex items-center gap-12",children:[e&&t.jsx(we,{size:r,className:"flex-shrink-0",src:e}),t.jsxs("div",{className:"min-w-0 overflow-hidden",children:[t.jsx("div",{className:v(n,"overflow-hidden overflow-ellipsis"),children:s}),a&&t.jsx("div",{className:"overflow-hidden overflow-ellipsis text-xs text-muted",children:a})]})]})}const rr=se(t.jsx("path",{d:"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreVertOutlined");function or({children:e,color:s,variant:a,radius:n="rounded-button",size:r,className:o,value:l,onChange:i,multiple:c,disabled:u}){const d=f=>l===void 0?!1:c?l.includes(f):f===l,m=f=>{const g=[...l],j=l.indexOf(f);return j>-1?g.splice(j,1):g.push(f),g},h=E.Children.map(e,(f,g)=>{if(E.isValidElement(f)){const j=d(f.props.value),R=j?"primary":s;return E.cloneElement(f,{color:j?"primary":s,variant:a,size:r,radius:null,disabled:f.props.disabled||u,...f.props,onClick:I=>{f.props.onClick&&f.props.onClick(I),i&&(c?i==null||i(m(f.props.value)):i==null||i(f.props.value))},className:v(f.props.className,j?"z-20":"z-10",dn(g,e,n,R))})}});return t.jsx("div",{className:v(n,"isolate inline-flex",o),children:h})}function dn(e,s,a,n){return e===0?v(a,"rounded-tr-none rounded-br-none",!n&&"border-r-transparent disabled:border-r-transparent"):e===s.length-1?v(a,"rounded-tl-none rounded-bl-none -ml-1"):v("rounded-none -ml-1",!n&&"border-r-transparent disabled:border-r-transparent")}function un(e){return ye({mutationFn:s=>mn(s),onSuccess:async()=>{await ve.invalidateQueries({queryKey:["canned-replies"]}),Ve(k("Saved reply created"))},onError:s=>Ze(s,e)})}function mn(e){return K.post("canned-replies",e).then(s=>s.data)}function Zt({onSubmit:e,form:s,reply:a}){var u;const{formId:n}=_(),r=x.useRef(null),[o,l]=x.useState((a==null?void 0:a.attachments)||[]),i=(u=s.formState.errors.body)==null?void 0:u.message,c=()=>{e({...s.getValues(),body:_s(r),attachments:o.map(d=>d.id)})};return t.jsx(Pe,{id:n,form:s,onSubmit:c,onBeforeSubmit:()=>s.clearErrors(),children:t.jsx(x.Fragment,{children:t.jsxs(Fs,{children:[t.jsx(We,{autoFocus:!0,className:"mb-24",label:t.jsx(p,{message:"Name"}),name:"name"}),t.jsx(Ht,{className:"mb-24",name:"shared",description:t.jsx(p,{message:"Shared replies will be visible to all agents, not just you."}),children:t.jsx(p,{message:"Shared"})}),t.jsx(Ks,{initialContent:(a==null?void 0:a.body)||"",minHeight:"min-h-[300px]",isLoading:!1,editorRef:r,attachments:o,onAttachmentsChange:d=>l(d),onSubmit:c}),i&&t.jsx("div",{className:"pt-10 text-xs text-danger",children:i})]})})})}function xn(){const{close:e,formId:s}=_(),a=ge({defaultValues:{shared:!1}}),n=un(a),r=o=>{n.mutate(o,{onSuccess:()=>e()})};return t.jsxs(J,{size:"lg",children:[t.jsx(le,{children:t.jsx(p,{message:"New saved reply"})}),t.jsx(X,{children:t.jsx(Zt,{form:a,onSubmit:r})}),t.jsxs(ie,{children:[t.jsx(M,{onClick:()=>e(),children:t.jsx(p,{message:"Cancel"})}),t.jsx(M,{type:"submit",form:s,variant:"flat",color:"primary",disabled:n.isPending,children:t.jsx(p,{message:"Save"})})]})]})}const Gt=(e,s)=>{const a=e.split("/");return s&&a.push(s),a};function fn(e,s,a,n){return be({queryKey:Gt(e,s),queryFn:({signal:r})=>hn(e,s,n,r),placeholderData:ht,...a})}async function hn(e,s,a,n){s.query&&await new Promise(o=>setTimeout(o,300));const r=await K.get(e,{params:s,signal:s.query?n:void 0}).then(o=>o.data);return a==null||a(r),r}const Yt=E.createContext(null);function Jt(){return x.useContext(Yt)}function pn({actions:e,filters:s,filtersLoading:a,searchPlaceholder:n=k("Type to search..."),searchValue:r="",onSearchChange:o}){const{trans:l}=Y();return t.jsxs(Xt,{children:[t.jsx(Vs,{size:"sm",className:"mr-auto min-w-180 max-w-440 flex-auto",inputWrapperClassName:"mr-24 md:mr-0",placeholder:l(n),startAdornment:t.jsx(zs,{size:"sm"}),value:r,onChange:i=>{o(i.target.value)}}),s&&t.jsx(rn,{filters:s,disabled:a}),e]})}function Xt({children:e,...s}){return t.jsx("div",{className:"hidden-scrollbar relative mb-24 flex h-42 items-center gap-8 overflow-x-auto text-muted md:gap-12",...s,children:e})}function bn({actions:e,selectedItemsCount:s}){return t.jsxs(Xt,{"data-testid":"datatable-selected-header",children:[t.jsx("div",{className:"mr-auto",children:t.jsx(p,{message:"[one 1 item|other :count items] selected",values:{count:s}})}),e]})}function gn(){return t.jsxs(ae.div,{className:"flex items-center gap-6 h-30",...$e,children:[t.jsx(W,{variant:"rect",size:"h-full w-144",radius:"rounded-md"}),t.jsx(W,{variant:"rect",size:"h-full w-112",radius:"rounded-md"}),t.jsx(W,{variant:"rect",size:"h-full w-172",radius:"rounded-md"})]},"filter-list-skeleton")}function jn({filters:e,filtersLoading:s,columns:a,searchPlaceholder:n,queryParams:r,endpoint:o,actions:l,selectedActions:i,emptyStateMessage:c,tableDomProps:u,onRowAction:d,enableSelection:m=!0,selectionStyle:h="checkbox",children:f,cellHeight:g,collapseTableOnMobile:j=!0}){var V;const R=ce(),{trans:I}=Y(),{encodedFilters:P}=ze(e),[C,D]=x.useState({perPage:15}),[$,F]=x.useState([]),b=fn(o,{...C,...r,[Ce]:P},void 0,()=>F([])),w=!!(C.query||C.filters||P),S=(V=b.data)==null?void 0:V.pagination;return t.jsxs(Yt.Provider,{value:{selectedRows:$,setSelectedRows:F,endpoint:o,params:C,setParams:D,query:b},children:[f,t.jsx(me,{initial:!1,mode:"wait",children:$.length?t.jsx(bn,{selectedItemsCount:$.length,actions:i},"selected"):t.jsx(pn,{searchPlaceholder:n,searchValue:C.query,onSearchChange:T=>D({...C,query:T}),actions:l,filters:e,filtersLoading:s},"default")}),e&&t.jsx("div",{className:"mb-14",children:t.jsx(me,{initial:!1,mode:"wait",children:s&&P?t.jsx(gn,{}):t.jsx(ae.div,{...$e,children:t.jsx(Ya,{filters:e})},"filter-list")})}),t.jsxs("div",{className:v("relative rounded-panel",(!R||!j)&&"border"),children:[b.isFetching&&t.jsx(ut,{isIndeterminate:!0,className:"absolute left-0 top-0 z-10 w-full","aria-label":I({message:"Loading"}),size:"xs"}),t.jsx("div",{className:"relative overflow-x-auto md:overflow-hidden",children:t.jsx(St,{...u,columns:a,data:(S==null?void 0:S.data)||[],sortDescriptor:C,onSortChange:T=>{D({...C,...T})},selectedRows:$,enableSelection:m,selectionStyle:h,onSelectionChange:F,onAction:d,collapseOnMobile:j,cellHeight:g})}),(b.isFetched||b.isPlaceholderData)&&!(S!=null&&S.data.length)?t.jsx("div",{className:"pt-50",children:x.cloneElement(c,{isFiltering:w})}):void 0,t.jsx(Nt,{query:b,onPageChange:T=>D({...C,page:T}),onPerPageChange:T=>D({...C,perPage:T})})]})]})}function yn({title:e,headerContent:s,headerItemsAlign:a="items-end",className:n,padding:r,...o}){const l=x.useId();return t.jsxs("div",{className:v(r??"p-12 md:p-24",n),children:[e&&t.jsxs("div",{className:v("mb-16",s&&`flex ${a} gap-4`),children:[t.jsx(As,{children:e}),t.jsx("h1",{className:"text-3xl font-light first:capitalize",id:l,children:e}),s]}),t.jsx(jn,{...o,tableDomProps:{"aria-labelledby":e?l:void 0}})]})}const it=se(t.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"AddOutlined"),vn=E.forwardRef(({children:e,to:s,elementType:a,onClick:n,href:r,download:o,icon:l,disabled:i},c)=>ce()?t.jsx(Z,{ref:c,variant:"flat",color:"primary",className:"flex-shrink-0",size:"sm",to:s,href:r,download:o,elementType:a,onClick:n,disabled:i,children:l||t.jsx(it,{})}):t.jsx(M,{ref:c,startIcon:l||t.jsx(it,{}),variant:"flat",color:"primary",size:"sm",to:s,href:r,download:o,elementType:a,onClick:n,disabled:i,children:e}));function wn(){const{endpoint:e,selectedRows:s,setSelectedRows:a}=Jt();return ye({mutationFn:()=>kn(e,s),onSuccess:async()=>{await ve.invalidateQueries({queryKey:Gt(e)}),Ve(k("Deleted [one 1 record|other :count records]",{values:{count:s.length}})),a([])},onError:n=>kt(n,k("Could not delete records"))})}function kn(e,s){return K.delete(`${e}/${s.join(",")}`).then(a=>a.data)}function Cn(){return t.jsxs(Q,{type:"modal",children:[t.jsx(M,{variant:"flat",color:"danger",className:"ml-auto",children:t.jsx(p,{message:"Delete"})}),t.jsx(Dn,{})]})}function Dn(){const e=wn(),{selectedRows:s}=Jt(),{close:a}=_();return t.jsx(Ct,{isLoading:e.isPending,title:t.jsx(p,{message:"Delete [one 1 item|other :count items]?",values:{count:s.length}}),body:t.jsx(p,{message:"This will permanently remove the items and cannot be undone."}),confirm:t.jsx(p,{message:"Delete"}),isDanger:!0,onConfirm:()=>{e.mutate(void 0,{onSuccess:()=>a()})}})}const Sn=""+new URL("online-articles-1ec8936a.svg",import.meta.url).href,Nn=[{key:"shared",label:k("Shared"),description:k("Whether reply is marked as shared"),defaultOperator:Ne.eq,control:{type:L.BooleanToggle,defaultValue:!0}},{key:"user_id",label:k("Owner"),description:k("User this reply was created by"),defaultOperator:Ne.eq,control:{type:L.SelectModel,model:cn}},on({description:k("Date reply was created")}),ln({description:k("Date reply was last updated")})];function In(){return ye({mutationFn:e=>Pn(e),onSuccess:async()=>{await ve.invalidateQueries({queryKey:["canned-replies"]})},onError:e=>kt(e)})}function Pn(e){return K.delete(`canned-replies/${e.ids.join(",")}`).then(s=>s.data)}function Rn(e,s){return ye({mutationFn:a=>$n(s,a),onSuccess:async()=>{await ve.invalidateQueries({queryKey:["canned-replies"]}),Ve(k("Reply updated"))},onError:a=>Ze(a,e)})}function $n(e,s){return K.put(`canned-replies/${e}`,s).then(a=>a.data)}function Fn({reply:e}){var l;const{close:s,formId:a}=_(),n=ge({defaultValues:{name:e.name,body:e.body,shared:e.shared,attachments:(l=e.attachments)==null?void 0:l.map(i=>i.id)}}),r=Rn(n,e.id),o=i=>{r.mutate(i,{onSuccess:()=>s()})};return t.jsxs(J,{size:"lg",children:[t.jsx(le,{children:t.jsx(p,{message:"Update saved reply"})}),t.jsx(X,{children:t.jsx(Zt,{form:n,onSubmit:o,reply:e})}),t.jsxs(ie,{children:[t.jsx(M,{onClick:()=>s(),children:t.jsx(p,{message:"Cancel"})}),t.jsx(M,{type:"submit",form:a,variant:"flat",color:"primary",disabled:r.isPending,children:t.jsx(p,{message:"Save"})})]})]})}function Vn(e,s,a="..."){return s==null||s>=e.length?e:e.slice(0,Math.max(0,s-a.length))+a}function zn(e){return e.replace(/<\/?[^>]+(>|$)/g,"")}const An=[{key:"name",width:"flex-3 min-w-200",visibleInMode:"all",header:()=>t.jsx(p,{message:"Saved reply"}),body:e=>t.jsx(Tn,{reply:e})},{key:"user_id",allowsSorting:!0,width:"min-w-200",visibleInMode:"all",header:()=>t.jsx(p,{message:"Owner"}),body:e=>e.user?t.jsx(Qt,{image:e.user.avatar,label:e.user.display_name,description:e.user.email}):null},{key:"shared",allowsSorting:!0,width:"w-60 flex-shrink-0",header:()=>t.jsx(p,{message:"Shared"}),body:e=>e.shared?t.jsx(Dt,{size:"md",className:"text-positive"}):t.jsx(Qe,{size:"md",className:"text-danger"})},{key:"updatedAt",allowsSorting:!0,width:"w-96",header:()=>t.jsx(p,{message:"Last updated"}),body:e=>t.jsx("time",{children:t.jsx(Ts,{date:e.updated_at})})},{key:"actions",header:()=>t.jsx(p,{message:"Actions"}),width:"w-84 flex-shrink-0",hideHeader:!0,align:"end",visibleInMode:"all",body:e=>t.jsxs("div",{className:"text-muted",children:[t.jsxs(Q,{type:"modal",children:[t.jsx(Oe,{label:t.jsx(p,{message:"Edit reply"}),children:t.jsx(Z,{size:"md",children:t.jsx(It,{})})}),t.jsx(Fn,{reply:e})]}),t.jsxs(Q,{type:"modal",children:[t.jsx(Oe,{label:t.jsx(p,{message:"Delete reply"}),children:t.jsx(Z,{children:t.jsx(Ys,{})})}),t.jsx(Ln,{reply:e})]})]})}];function Tn({reply:e}){const{isCollapsedMode:s}=x.useContext(Us);return t.jsxs("div",{className:"min-w-0",children:[t.jsx("div",{className:v(s?"whitespace-normal":"overflow-hidden overflow-ellipsis whitespace-nowrap font-medium"),children:e.name}),!s&&t.jsx("p",{className:"mt-4 max-w-680 whitespace-normal text-xs text-muted",children:Vn(zn(e.body),230)})]})}function Ln({reply:e}){const s=In(),{close:a}=_();return t.jsx(Ct,{isDanger:!0,isLoading:s.isPending,title:t.jsx(p,{message:"Delete saved reply"}),body:t.jsx(p,{message:"Are you sure you want to delete this saved reply?"}),confirm:t.jsx(p,{message:"Delete"}),onConfirm:()=>{s.mutate({ids:[e.id]},{onSuccess:()=>a()})}})}function lr({userId:e}){const{columns:s,filters:a}=x.useMemo(()=>({columns:An.filter(n=>n.key!=="user_id"||!e),filters:Nn.filter(n=>n.key!=="user_id"||!e)}),[e]);return t.jsx(yn,{endpoint:"canned-replies",title:t.jsx(p,{message:"Saved replies"}),columns:s,filters:a,queryParams:{shared:"true",with:e?void 0:"user",user_id:e},actions:t.jsx(Mn,{}),selectedActions:t.jsx(Cn,{}),enableSelection:!1,cellHeight:"h-76",emptyStateMessage:t.jsx(Ws,{image:Sn,title:t.jsx(p,{message:"No saved replies have been created yet"}),filteringTitle:t.jsx(p,{message:"No matching replies"})})})}function Mn(){return t.jsxs(Q,{type:"modal",children:[t.jsx(vn,{children:t.jsx(p,{message:"Add reply"})}),t.jsx(xn,{})]})}const En=se(t.jsx("path",{d:"M9 8a1 1 0 0 0-1-1H5.5a1 1 0 1 0 0 2H7v4a1 1 0 0 0 2 0zM4 0h8a4 4 0 0 1 4 4v8a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4zm4 5.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"}),"InfoDialogTrigger");function On({title:e,body:s,dialogSize:a="sm",className:n}){return t.jsxs(Q,{type:"popover",triggerOnHover:!0,children:[t.jsx(Z,{className:v("ml-4 text-muted opacity-70",n),iconSize:"xs",size:"2xs",children:t.jsx(En,{viewBox:"0 0 16 16"})}),t.jsxs(J,{size:a,children:[e&&t.jsx(le,{padding:"px-18 pt-12",size:"md",hideDismissButton:!0,children:e}),t.jsx(X,{children:s})]})]})}function Hn(e,s){return ye({mutationFn:a=>Bn(s,a),onSuccess:async()=>{Ve(k("User suspended")),await ve.invalidateQueries({queryKey:["users"]})},onError:a=>Ze(a,e)})}function Bn(e,s){return K.post(`users/${e}/ban`,s).then(a=>a.data)}function qn(e){const s=Ge(),[a,n]=x.useState(!e.value&&!e.defaultValue),r=e.onChange,[o,l]=re(e.value||s,e.defaultValue||s,D=>{n(!1),r==null||r(D)}),{min:i,max:c,granularity:u,timezone:d,calendarIsOpen:m,setCalendarIsOpen:h,closeDialogOnSelection:f}=At(o,e),g=x.useCallback(()=>{n(!0),l(s),r==null||r(null),h(!1)},[s,l,r,h]),[j,R]=x.useState(()=>[xe(o)]),I=x.useCallback(D=>{i&&D.compare(i)<0?D=i:c&&D.compare(c)>0&&(D=c);const $=o?o.set(D):ee(D,d);l($),R([xe($)]),n(!1)},[l,i,c,o,d]),P=x.useCallback(D=>!a&&ue(o,D),[o,a]),C=x.useCallback(D=>({onClick:()=>{I==null||I(D),f&&(h==null||h(!1))}}),[I,h,f]);return{selectedValue:o,setSelectedValue:l,calendarIsOpen:m,setCalendarIsOpen:h,dayIsActive:P,dayIsHighlighted:()=>!1,dayIsRangeStart:()=>!1,dayIsRangeEnd:()=>!1,getCellProps:C,calendarDates:j,setCalendarDates:R,isPlaceholder:a,clear:g,setIsPlaceholder:n,min:i,max:c,granularity:u,timezone:d,closeDialogOnSelection:f}}function Kn({showCalendarFooter:e,...s}){const a=qn(s),n=x.useRef(null),r=Ge(),o=e&&t.jsx(ie,{padding:"px-14 pb-14",startAction:t.jsx(M,{disabled:a.isPlaceholder,variant:"text",color:"primary",onClick:()=>{a.clear()},children:t.jsx(p,{message:"Clear"})}),children:t.jsx(M,{variant:"text",color:"primary",onClick:()=>{a.setSelectedValue(r),a.setCalendarIsOpen(!1)},children:t.jsx(p,{message:"Today"})})}),l=t.jsx(Q,{offset:8,placement:"bottom-start",isOpen:a.calendarIsOpen,onOpenChange:a.setCalendarIsOpen,type:"popover",triggerRef:n,returnFocusToTrigger:!1,moveFocusToDialog:!1,children:t.jsxs(J,{size:"auto",children:[t.jsx(X,{className:"flex items-start gap-40",padding:e?"px-24 pt-20 pb-10":null,children:t.jsx(Mt,{state:a,visibleMonths:1})}),o]})}),i={onClick:c=>{c.stopPropagation(),c.preventDefault(),Un(c)?a.setCalendarIsOpen(!1):a.setCalendarIsOpen(!0)}};return t.jsxs(x.Fragment,{children:[t.jsx(Je,{ref:n,wrapperProps:i,endAdornment:t.jsx(Vt,{className:v(s.disabled&&"text-disabled")}),...s,children:t.jsx(pe,{segmentProps:i,state:a,value:a.selectedValue,onChange:a.setSelectedValue,isPlaceholder:a.isPlaceholder})}),l]})}function _n(e){const{min:s,max:a}=e,{trans:n}=Y(),{format:r}=te(),{field:{onChange:o,onBlur:l,value:i=null,ref:c},fieldState:{invalid:u,error:d}}=je({name:e.name,rules:{validate:f=>{if(!f)return;const g=Se(f);if(s&&g.compare(s)<0)return n({message:"Enter a date after :date",values:{date:r(f)}});if(a&&g.compare(a)>0)return n({message:"Enter a date before :date",values:{date:r(f)}})}}}),m=i?Se(i):null,h={onChange:f=>{o(f&&f.toAbsoluteString())},onBlur:l,value:m,invalid:u,errorMessage:d==null?void 0:d.message,inputRef:c};return t.jsx(Kn,{...ne(h,e)})}function Un(e){return["hour","minute","dayPeriod"].includes(e.currentTarget.ariaLabel||"")}function ir({user:e}){const{trans:s}=Y(),{close:a,formId:n}=_(),r=ge({defaultValues:{permanent:!0}}),o=r.watch("permanent"),l=Hn(r,e.id);return t.jsxs(J,{children:[t.jsx(le,{children:t.jsx(p,{message:"Suspend “:name“",values:{name:e.display_name}})}),t.jsx(X,{children:t.jsxs(Pe,{id:n,form:r,onSubmit:i=>l.mutate(i,{onSuccess:()=>a()}),children:[t.jsx(_n,{name:"ban_until",label:t.jsx(p,{message:"Suspend until"}),disabled:o}),t.jsx(Ht,{name:"permanent",className:"mt-12",children:t.jsx(p,{message:"Permanent"})}),t.jsx(We,{className:"mt-24",name:"comment",inputElementType:"textarea",maxLength:250,label:t.jsx(p,{message:"Reason"}),placeholder:s(k("Optional"))})]})}),t.jsxs(ie,{children:[t.jsx(M,{onClick:()=>a(),children:t.jsx(p,{message:"Cancel"})}),t.jsx(M,{form:n,variant:"flat",color:"primary",type:"submit",disabled:l.isPending,children:t.jsx(p,{message:"Suspend"})})]})]})}function Wn({skipCtr:e,description:s}){return[{key:"normalized_term",header:()=>t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{children:t.jsx(p,{message:"Term"})}),!!s&&t.jsx(On,{body:s})]}),visibleInMode:"all",body:n=>t.jsx(Ls,{to:`/hc/search/${n.term}`,className:Ms,target:"_blank",children:n.term})},{key:"count",header:()=>t.jsx(p,{message:"Count"}),width:"w-144",body:n=>t.jsx("span",{children:n.count||1})},e?null:{key:"ctr",header:()=>t.jsx(p,{message:"CTR"}),width:"w-144",body:n=>t.jsxs("span",{children:[n.ctr,"%"]})},{key:"resulted_in_ticket",header:()=>t.jsx(p,{message:"Resulted in ticket"}),width:"w-144",body:n=>t.jsx("span",{className:"text-muted",children:n.resulted_in_ticket?t.jsx(Dt,{}):t.jsx(Qe,{})})},{key:"last_seen",header:()=>t.jsx(p,{message:"Last seen"}),visibleInMode:"all",width:"w-144",body:n=>t.jsx(Es,{date:n.last_seen})},{key:"category",header:()=>t.jsx(p,{message:"Category"}),visibleInMode:"all",body:n=>n.category?t.jsx(Qt,{image:n.category.image,label:t.jsx(Os,{category:n.category,target:"_blank"}),description:n.category.description}):null}].filter(Boolean)}function Qn(e){var a,n;const s={...e};return s.dateRange&&(s.startDate=s.dateRange.start.toAbsoluteString(),s.endDate=s.dateRange.end.toAbsoluteString(),s.compareStartDate=(a=s.dateRange.compareStart)==null?void 0:a.toAbsoluteString(),s.compareEndDate=(n=s.dateRange.compareEnd)==null?void 0:n.toAbsoluteString(),s.timezone=s.dateRange.start.timeZone,delete s.dateRange),s}function Zn(e){return be({queryKey:["reports","search",e],queryFn:()=>Gn(e)})}function Gn(e){return K.get("reports/search",{params:Qn(e)}).then(s=>s.data)}function cr({userId:e,dateRange:s,failedSearches:a,description:n}){const[r,o]=xt(),l=Zn({dateRange:s,userId:e,failedSearches:a,page:r.get("page")||1,perPage:r.get("perPage")||15}),{data:i,fetchStatus:c,isLoading:u,isPlaceholderData:d}=l,m=(i==null?void 0:i.pagination.data)||[],h=c==="idle"&&m.length===0||!u&&!d&&m.length===0,f=x.useMemo(()=>Wn({skipCtr:a,description:n}),[n,a]);return t.jsxs("div",{className:"relative max-md:overflow-x-auto",children:[t.jsx(Zs,{query:l}),t.jsx(St,{columns:f,data:m,enableSelection:!1,collapseOnMobile:!1,className:"max-md:w-min"}),h&&t.jsx(Hs,{className:"mt-48",image:t.jsx(Bs,{src:Qs}),title:t.jsx(p,{message:"There are no searches to display"})}),t.jsx(Nt,{query:l,onPageChange:g=>o(j=>(j.set("page",g.toString()),j)),onPerPageChange:g=>o(j=>(j.set("perPage",g.toString()),j))})]})}export{rn as A,or as B,xn as C,Ys as D,_n as E,Ne as F,Zs as G,Qn as H,On as I,Ba as J,Vt as K,Et as L,rr as M,Qt as N,fa as O,Ia as P,Ra as Q,Xe as R,cr as S,sr as T,cn as U,Vn as V,zn as W,Sn as X,Lt as Y,Ja as Z,L as a,ln as b,on as c,Ya as d,nr as e,ar as f,ma as g,lr as h,Ha as i,it as j,ir as k,yn as l,Cn as m,vn as n,Ht as o,Xa as p,en as q,Ot as r,Oa as s,Wt as t,tr as u,Ye as v,Gt as w,oa as x,jn as y,Jt as z};
//# sourceMappingURL=search-report-table-f0bbbc10.js.map
